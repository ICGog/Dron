SessionStart SESSION_ID="ubuntu_201205252249" TIME="1337986163345"
QueryStart QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337986181654"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986181676"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337986181679"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986181737"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:49:59,272 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986199272"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986199273"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:50:59,551 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986259552"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986259553"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:51:59,870 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986319871"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986319872"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:53:00,140 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986380141"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986380142"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:54:00,543 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986440544"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986440545"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:55:00,808 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8403" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986500809"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986500810"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:01,090 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:25,Job Counters .Data-local map tasks:19,Job Counters .SLOTS_MILLIS_REDUCES:8403,Map-Reduce Framework.Spilled Records:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986561091"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986561092"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:18,171 Stage-1 map = 1%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:28,Job Counters .Launched map tasks:84,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,Map-Reduce Framework.Spilled Records:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986578172"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"1"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986578173"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:20,188 Stage-1 map = 2%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:36437,Job Counters .Rack-local map tasks:30,Job Counters .Launched map tasks:86,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056641,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:413421568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9930,Map-Reduce Framework.Total committed heap usage (bytes):351338496,Map-Reduce Framework.Virtual memory (bytes) snapshot:1321295872,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986580189"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"2"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986580190"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:21,195 Stage-1 map = 3%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:36437,Job Counters .Rack-local map tasks:30,Job Counters .Launched map tasks:86,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056641,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:413421568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9930,Map-Reduce Framework.Total committed heap usage (bytes):351338496,Map-Reduce Framework.Virtual memory (bytes) snapshot:1321295872,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986581201"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"3"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986581203"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:24,217 Stage-1 map = 5%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:36437,Job Counters .Rack-local map tasks:31,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056641,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:413421568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9930,Map-Reduce Framework.Total committed heap usage (bytes):351338496,Map-Reduce Framework.Virtual memory (bytes) snapshot:1321295872,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986584218"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"5"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986584219"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:26,229 Stage-1 map = 7%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:36437,Job Counters .Rack-local map tasks:31,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056641,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:413421568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9930,Map-Reduce Framework.Total committed heap usage (bytes):351338496,Map-Reduce Framework.Virtual memory (bytes) snapshot:1321295872,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986586229"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"7"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986586230"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:27,235 Stage-1 map = 9%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:63065,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:88,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:201339453,FileSystemCounters.FILE_BYTES_WRITTEN:4596259,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1543882,Map-Reduce Framework.Physical memory (bytes) snapshot:621678592,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4252466,Map-Reduce Framework.CPU time spent (ms):17780,Map-Reduce Framework.Total committed heap usage (bytes):528023552,Map-Reduce Framework.Virtual memory (bytes) snapshot:1942773760,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:49015,Map-Reduce Framework.SPLIT_RAW_BYTES:570" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986587236"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"9"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986587237"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:28,242 Stage-1 map = 11%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:63065,Job Counters .Rack-local map tasks:33,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:231720897,FileSystemCounters.FILE_BYTES_WRITTEN:4922709,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1787399,Map-Reduce Framework.Physical memory (bytes) snapshot:1463816192,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4921700,Map-Reduce Framework.CPU time spent (ms):32260,Map-Reduce Framework.Total committed heap usage (bytes):1232666624,Map-Reduce Framework.Virtual memory (bytes) snapshot:4574769152,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:56685,Map-Reduce Framework.SPLIT_RAW_BYTES:1978" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986588242"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"11"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986588243"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:29,248 Stage-1 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:63065,Job Counters .Rack-local map tasks:33,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:231720897,FileSystemCounters.FILE_BYTES_WRITTEN:4922709,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1787399,Map-Reduce Framework.Physical memory (bytes) snapshot:1463816192,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4921700,Map-Reduce Framework.CPU time spent (ms):32260,Map-Reduce Framework.Total committed heap usage (bytes):1232666624,Map-Reduce Framework.Virtual memory (bytes) snapshot:4574769152,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:56685,Map-Reduce Framework.SPLIT_RAW_BYTES:1978" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986589249"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"13"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986589250"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:30,255 Stage-1 map = 14%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:63065,Job Counters .Rack-local map tasks:33,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:231720897,FileSystemCounters.FILE_BYTES_WRITTEN:4922709,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1787399,Map-Reduce Framework.Physical memory (bytes) snapshot:1463816192,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4921700,Map-Reduce Framework.CPU time spent (ms):32260,Map-Reduce Framework.Total committed heap usage (bytes):1232666624,Map-Reduce Framework.Virtual memory (bytes) snapshot:4574769152,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:56685,Map-Reduce Framework.SPLIT_RAW_BYTES:1978" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986590255"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"14"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986590257"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:31,262 Stage-1 map = 16%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:90491,Job Counters .Rack-local map tasks:34,Job Counters .Launched map tasks:91,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:228066,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:3488835,FileSystemCounters.HDFS_BYTES_READ:595307848,FileSystemCounters.FILE_BYTES_WRITTEN:11024252,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:4582184,Map-Reduce Framework.Physical memory (bytes) snapshot:2320257024,Map-Reduce Framework.Spilled Records:114033,Map-Reduce Framework.Map output bytes:12572191,Map-Reduce Framework.CPU time spent (ms):56000,Map-Reduce Framework.Total committed heap usage (bytes):1967194112,Map-Reduce Framework.Virtual memory (bytes) snapshot:7210504192,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:144799,Map-Reduce Framework.SPLIT_RAW_BYTES:3386" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986591262"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"16"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986591264"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:32,269 Stage-1 map = 18%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:122074,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:92,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:326230,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:4983562,FileSystemCounters.HDFS_BYTES_READ:796647029,FileSystemCounters.FILE_BYTES_WRITTEN:15478999,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6125993,Map-Reduce Framework.Physical memory (bytes) snapshot:2530242560,Map-Reduce Framework.Spilled Records:163115,Map-Reduce Framework.Map output bytes:16846852,Map-Reduce Framework.CPU time spent (ms):64590,Map-Reduce Framework.Total committed heap usage (bytes):2143879168,Map-Reduce Framework.Virtual memory (bytes) snapshot:7826358272,Map-Reduce Framework.Map input bytes:335544320,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:193881,Map-Reduce Framework.SPLIT_RAW_BYTES:3684" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986592269"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"18"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986592271"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:33,276 Stage-1 map = 22%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:122074,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:92,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:326230,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:4983562,FileSystemCounters.HDFS_BYTES_READ:796647029,FileSystemCounters.FILE_BYTES_WRITTEN:15478999,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6125993,Map-Reduce Framework.Physical memory (bytes) snapshot:2530242560,Map-Reduce Framework.Spilled Records:163115,Map-Reduce Framework.Map output bytes:16846852,Map-Reduce Framework.CPU time spent (ms):64590,Map-Reduce Framework.Total committed heap usage (bytes):2143879168,Map-Reduce Framework.Virtual memory (bytes) snapshot:7826358272,Map-Reduce Framework.Map input bytes:335544320,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:193881,Map-Reduce Framework.SPLIT_RAW_BYTES:3684" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986593276"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"22"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986593277"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:34,283 Stage-1 map = 24%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:156105,Job Counters .Rack-local map tasks:36,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:455982,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:6978059,FileSystemCounters.HDFS_BYTES_READ:1065099225,FileSystemCounters.FILE_BYTES_WRITTEN:21331843,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:8185366,Map-Reduce Framework.Physical memory (bytes) snapshot:2744905728,Map-Reduce Framework.Spilled Records:227991,Map-Reduce Framework.Map output bytes:22488023,Map-Reduce Framework.CPU time spent (ms):75890,Map-Reduce Framework.Total committed heap usage (bytes):2320564224,Map-Reduce Framework.Virtual memory (bytes) snapshot:8528093184,Map-Reduce Framework.Map input bytes:536870912,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:258757,Map-Reduce Framework.SPLIT_RAW_BYTES:4036" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986594283"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"24"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986594284"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:35,292 Stage-1 map = 28%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:249382,Job Counters .Rack-local map tasks:37,Job Counters .Launched map tasks:96,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:780770,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:11963076,FileSystemCounters.HDFS_BYTES_READ:1736229783,FileSystemCounters.FILE_BYTES_WRITTEN:36028019,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:13332777,Map-Reduce Framework.Physical memory (bytes) snapshot:3362230272,Map-Reduce Framework.Spilled Records:390385,Map-Reduce Framework.Map output bytes:36613646,Map-Reduce Framework.CPU time spent (ms):102600,Map-Reduce Framework.Total committed heap usage (bytes):2850619392,Map-Reduce Framework.Virtual memory (bytes) snapshot:10447851520,Map-Reduce Framework.Map input bytes:1006632960,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:421151,Map-Reduce Framework.SPLIT_RAW_BYTES:4984" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986595292"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"28"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986595293"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:36,299 Stage-1 map = 29%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:284723,Job Counters .Rack-local map tasks:38,Job Counters .Launched map tasks:97,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:910348,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:13957136,FileSystemCounters.HDFS_BYTES_READ:2004681979,FileSystemCounters.FILE_BYTES_WRITTEN:41868343,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:15391626,Map-Reduce Framework.Physical memory (bytes) snapshot:3578884096,Map-Reduce Framework.Spilled Records:455174,Map-Reduce Framework.Map output bytes:42242470,Map-Reduce Framework.CPU time spent (ms):114160,Map-Reduce Framework.Total committed heap usage (bytes):3027304448,Map-Reduce Framework.Virtual memory (bytes) snapshot:11082997760,Map-Reduce Framework.Map input bytes:1207959552,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:485940,Map-Reduce Framework.SPLIT_RAW_BYTES:5336" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986596299"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"29"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986596300"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:37,308 Stage-1 map = 33%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:319969,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1041116,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:15951222,FileSystemCounters.HDFS_BYTES_READ:2273134175,FileSystemCounters.FILE_BYTES_WRITTEN:47768174,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:17451096,Map-Reduce Framework.Physical memory (bytes) snapshot:3798614016,Map-Reduce Framework.Spilled Records:520558,Map-Reduce Framework.Map output bytes:47929613,Map-Reduce Framework.CPU time spent (ms):124100,Map-Reduce Framework.Total committed heap usage (bytes):3201957888,Map-Reduce Framework.Virtual memory (bytes) snapshot:11724738560,Map-Reduce Framework.Map input bytes:1409286144,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:551324,Map-Reduce Framework.SPLIT_RAW_BYTES:5688" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986597309"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"33"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986597316"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:38,321 Stage-1 map = 36%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:319969,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1041116,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:15951222,FileSystemCounters.HDFS_BYTES_READ:2273134175,FileSystemCounters.FILE_BYTES_WRITTEN:47768174,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:17451096,Map-Reduce Framework.Physical memory (bytes) snapshot:3798614016,Map-Reduce Framework.Spilled Records:520558,Map-Reduce Framework.Map output bytes:47929613,Map-Reduce Framework.CPU time spent (ms):124100,Map-Reduce Framework.Total committed heap usage (bytes):3201957888,Map-Reduce Framework.Virtual memory (bytes) snapshot:11724738560,Map-Reduce Framework.Map input bytes:1409286144,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:551324,Map-Reduce Framework.SPLIT_RAW_BYTES:5688" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986598322"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"36"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986598334"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:39,339 Stage-1 map = 40%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:353658,Job Counters .Rack-local map tasks:40,Job Counters .Launched map tasks:99,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1171098,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:17945815,FileSystemCounters.HDFS_BYTES_READ:2541586371,FileSystemCounters.FILE_BYTES_WRITTEN:53632865,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:19510680,Map-Reduce Framework.Physical memory (bytes) snapshot:4017700864,Map-Reduce Framework.Spilled Records:585549,Map-Reduce Framework.Map output bytes:53582401,Map-Reduce Framework.CPU time spent (ms):133730,Map-Reduce Framework.Total committed heap usage (bytes):3376611328,Map-Reduce Framework.Virtual memory (bytes) snapshot:12364443648,Map-Reduce Framework.Map input bytes:1610612736,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:616315,Map-Reduce Framework.SPLIT_RAW_BYTES:6040" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986599340"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"40"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986599341"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:40,363 Stage-1 map = 44%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:426997,Job Counters .Rack-local map tasks:42,Job Counters .Launched map tasks:101,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1431812,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:21933385,FileSystemCounters.HDFS_BYTES_READ:3386663167,FileSystemCounters.FILE_BYTES_WRITTEN:65806044,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:26018020,Map-Reduce Framework.Physical memory (bytes) snapshot:5535916032,Map-Reduce Framework.Spilled Records:715906,Map-Reduce Framework.Map output bytes:72356550,Map-Reduce Framework.CPU time spent (ms):185660,Map-Reduce Framework.Total committed heap usage (bytes):4641193984,Map-Reduce Framework.Virtual memory (bytes) snapshot:16720175104,Map-Reduce Framework.Map input bytes:2214592512,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:835302,Map-Reduce Framework.SPLIT_RAW_BYTES:8388" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986600363"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"44"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986600364"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:41,372 Stage-1 map = 45%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:461821,Job Counters .Rack-local map tasks:42,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:60,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1561382,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:23927696,FileSystemCounters.HDFS_BYTES_READ:3655115363,FileSystemCounters.FILE_BYTES_WRITTEN:71650542,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:28077116,Map-Reduce Framework.Physical memory (bytes) snapshot:5739761664,Map-Reduce Framework.Spilled Records:780691,Map-Reduce Framework.Map output bytes:77989556,Map-Reduce Framework.CPU time spent (ms):196020,Map-Reduce Framework.Total committed heap usage (bytes):4815912960,Map-Reduce Framework.Virtual memory (bytes) snapshot:17345380352,Map-Reduce Framework.Map input bytes:2415919104,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:900087,Map-Reduce Framework.SPLIT_RAW_BYTES:8740" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986601372"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"45"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986601373"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:42,379 Stage-1 map = 49%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:661177,Job Counters .Rack-local map tasks:45,Job Counters .Launched map tasks:108,Job Counters .Data-local map tasks:63,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2081892,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:31903632,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:5340216887,FileSystemCounters.FILE_BYTES_WRITTEN:247661056,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:41604765,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3258340,Map-Reduce Framework.Map output bytes:185908268,Map-Reduce Framework.CPU time spent (ms):285860,Map-Reduce Framework.Total committed heap usage (bytes):6459555840,Map-Reduce Framework.Map input bytes:3556769792,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:11742,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7714480128,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:23015010304,Map-Reduce Framework.Map output records:2400771" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986602379"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"49"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986602380"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:43,386 Stage-1 map = 54%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:746357,Job Counters .Rack-local map tasks:46,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2342070,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:35891640,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:6498056171,FileSystemCounters.FILE_BYTES_WRITTEN:259787374,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:50499743,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3388429,Map-Reduce Framework.Map output bytes:210256126,Map-Reduce Framework.CPU time spent (ms):348110,Map-Reduce Framework.Total committed heap usage (bytes):7696351232,Map-Reduce Framework.Map input bytes:4429185024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:14206,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9230467072,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:27522519040,Map-Reduce Framework.Map output records:2681014" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986603386"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"54"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986603387"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:44,393 Stage-1 map = 57%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:873263,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:114,Job Counters .Data-local map tasks:65,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2667220,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:40876452,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:7169186865,FileSystemCounters.FILE_BYTES_WRITTEN:274541073,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:55647130,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3551004,Map-Reduce Framework.Map output bytes:224356988,Map-Reduce Framework.CPU time spent (ms):385290,Map-Reduce Framework.Total committed heap usage (bytes):8400994304,Map-Reduce Framework.Map input bytes:4831838208,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:15290,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10091347968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:30106066944,Map-Reduce Framework.Map output records:2843589" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986604393"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"57"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986604394"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:45,402 Stage-1 map = 60%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:917856,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:115,Job Counters .Data-local map tasks:66,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2796730,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:42871120,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:7437639060,FileSystemCounters.FILE_BYTES_WRITTEN:280382043,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:57706553,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3615759,Map-Reduce Framework.Map output bytes:229986526,Map-Reduce Framework.CPU time spent (ms):397650,Map-Reduce Framework.Total committed heap usage (bytes):8577679360,Map-Reduce Framework.Map input bytes:5033164800,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:15642,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10310152192,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:30723162112,Map-Reduce Framework.Map output records:2908344" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986605403"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"60"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986605404"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:46,409 Stage-1 map = 64%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1183852,Job Counters .Rack-local map tasks:54,Job Counters .Launched map tasks:121,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3574472,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:54837157,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:9028740235,FileSystemCounters.FILE_BYTES_WRITTEN:315373706,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:69906467,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4004630,Map-Reduce Framework.Map output bytes:263360312,Map-Reduce Framework.CPU time spent (ms):463850,Map-Reduce Framework.Total committed heap usage (bytes):9461170176,Map-Reduce Framework.Map input bytes:6241124352,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17402,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11408543744,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:33884876800,Map-Reduce Framework.Map output records:3292297" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986606410"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"64"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986606411"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:47,416 Stage-1 map = 66%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1266602,Job Counters .Rack-local map tasks:56,Job Counters .Launched map tasks:123,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3834492,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:58825547,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:9351001583,FileSystemCounters.FILE_BYTES_WRITTEN:327017361,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:72378684,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4134640,Map-Reduce Framework.Map output bytes:270143394,Map-Reduce Framework.CPU time spent (ms):476250,Map-Reduce Framework.Total committed heap usage (bytes):9637855232,Map-Reduce Framework.Map input bytes:6442450944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17754,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11624308736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:34511720448,Map-Reduce Framework.Map output records:3370390" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986607416"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"66"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986607417"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:48,423 Stage-1 map = 69%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1458342,Job Counters .Rack-local map tasks:58,Job Counters .Launched map tasks:125,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4420616,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:67797793,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:10512747284,FileSystemCounters.FILE_BYTES_WRITTEN:353382903,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:81289022,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4427702,Map-Reduce Framework.Map output bytes:294632035,Map-Reduce Framework.CPU time spent (ms):526190,Map-Reduce Framework.Total committed heap usage (bytes):10344595456,Map-Reduce Framework.Map input bytes:7314866176,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19054,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12503244800,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:37055123456,Map-Reduce Framework.Map output records:3652366" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986608423"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"69"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986608424"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:49,431 Stage-1 map = 71%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1596278,Job Counters .Rack-local map tasks:61,Job Counters .Launched map tasks:128,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4810052,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:73780115,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:11162336733,FileSystemCounters.FILE_BYTES_WRITTEN:370857608,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:86259568,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4622420,Map-Reduce Framework.Map output bytes:308251437,Map-Reduce Framework.CPU time spent (ms):547500,Map-Reduce Framework.Total committed heap usage (bytes):10697965568,Map-Reduce Framework.Map input bytes:7784628224,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19758,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12939857920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:38299549696,Map-Reduce Framework.Map output records:3809089" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986609432"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"71"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986609433"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:50,439 Stage-1 map = 75%,  reduce = 6%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1751697,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5231678,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:80261596,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:11989893479,FileSystemCounters.FILE_BYTES_WRITTEN:389849803,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:92603724,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4833233,Map-Reduce Framework.Map output bytes:325620214,Map-Reduce Framework.CPU time spent (ms):585290,Map-Reduce Framework.Total committed heap usage (bytes):11281629184,Map-Reduce Framework.Map input bytes:8388608000,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20652,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13661892608,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:40193695744,Map-Reduce Framework.Map output records:4008911" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986610439"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"6","CNTR_NAME_Stage-1_MAP_PROGRESS":"75"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986610440"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:51,446 Stage-1 map = 76%,  reduce = 9%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1845347,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5492914,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:84248799,FileSystemCounters.FILE_BYTES_READ:81729350,FileSystemCounters.HDFS_BYTES_READ:12593911018,FileSystemCounters.FILE_BYTES_WRITTEN:483427954,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:97830880,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6073186,Map-Reduce Framework.Map output bytes:410839122,Map-Reduce Framework.CPU time spent (ms):620220,Map-Reduce Framework.Total committed heap usage (bytes):11932663808,Map-Reduce Framework.Map input bytes:8791261184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21542,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14400589824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42740273152,Map-Reduce Framework.Map output records:5248864" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986611446"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"9","CNTR_NAME_Stage-1_MAP_PROGRESS":"76"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986611447"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:52,460 Stage-1 map = 80%,  reduce = 9%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1995125,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5755708,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:88294119,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:13221914759,FileSystemCounters.FILE_BYTES_WRITTEN:565959440,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:102648446,Map-Reduce Framework.Reduce shuffle bytes:28981291,Map-Reduce Framework.Spilled Records:7313918,Map-Reduce Framework.Map output bytes:424060784,Map-Reduce Framework.CPU time spent (ms):651480,Map-Reduce Framework.Total committed heap usage (bytes):12581666816,Map-Reduce Framework.Map input bytes:9261023232,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22436,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15162351616,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:45399281664,Map-Reduce Framework.Map output records:5400945" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986612461"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"9","CNTR_NAME_Stage-1_MAP_PROGRESS":"80"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986612462"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:53,467 Stage-1 map = 81%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2190271,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6275842,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:96269418,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:14413848089,FileSystemCounters.FILE_BYTES_WRITTEN:589418483,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:111792777,Map-Reduce Framework.Reduce shuffle bytes:28981291,Map-Reduce Framework.Spilled Records:7573985,Map-Reduce Framework.Map output bytes:449128147,Map-Reduce Framework.CPU time spent (ms):701930,Map-Reduce Framework.Total committed heap usage (bytes):13316194304,Map-Reduce Framework.Map input bytes:10200547328,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23844,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16041402368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:47960244224,Map-Reduce Framework.Map output records:5689230" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986613468"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"81"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986613468"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:54,505 Stage-1 map = 84%,  reduce = 14%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2372316,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6794904,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:104245706,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:16297703030,FileSystemCounters.FILE_BYTES_WRITTEN:613054321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:126239479,Map-Reduce Framework.Reduce shuffle bytes:56306893,Map-Reduce Framework.Spilled Records:7833516,Map-Reduce Framework.Map output bytes:488815884,Map-Reduce Framework.CPU time spent (ms):788270,Map-Reduce Framework.Total committed heap usage (bytes):14493220864,Map-Reduce Framework.Map input bytes:11744051200,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25956,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17500413952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:52420825088,Map-Reduce Framework.Map output records:6146113" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986614505"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"14","CNTR_NAME_Stage-1_MAP_PROGRESS":"84"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986614506"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:55,514 Stage-1 map = 86%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2591448,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7444680,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:114215316,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:16721143957,FileSystemCounters.FILE_BYTES_WRITTEN:701078656,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:130065068,Map-Reduce Framework.Reduce shuffle bytes:56306893,Map-Reduce Framework.Spilled Records:9023435,Map-Reduce Framework.Map output bytes:570121022,Map-Reduce Framework.CPU time spent (ms):818810,Map-Reduce Framework.Total committed heap usage (bytes):14846590976,Map-Reduce Framework.Map input bytes:11945377792,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:26494,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17949204480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53684162560,Map-Reduce Framework.Map output records:7341424" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986615514"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"86"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986615515"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:56,521 Stage-1 map = 87%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2728490,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7833782,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:120197973,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:17272723612,FileSystemCounters.FILE_BYTES_WRITTEN:718370456,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:134289118,Map-Reduce Framework.Reduce shuffle bytes:56306893,Map-Reduce Framework.Spilled Records:9217986,Map-Reduce Framework.Map output bytes:581642025,Map-Reduce Framework.CPU time spent (ms):834500,Map-Reduce Framework.Total committed heap usage (bytes):14846590976,Map-Reduce Framework.Map input bytes:12415139840,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:26494,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17959309312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53684162560,Map-Reduce Framework.Map output records:7474112" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986616521"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"87"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986616522"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:57,528 Stage-1 map = 89%,  reduce = 16%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2830412,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8092784,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:124186644,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:18069597148,FileSystemCounters.FILE_BYTES_WRITTEN:730129246,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:140401879,Map-Reduce Framework.Reduce shuffle bytes:94051089,Map-Reduce Framework.Spilled Records:9347487,Map-Reduce Framework.Map output bytes:597469374,Map-Reduce Framework.CPU time spent (ms):871030,Map-Reduce Framework.Total committed heap usage (bytes):15316877312,Map-Reduce Framework.Map input bytes:13086228480,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27314,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18556137472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:55700054016,Map-Reduce Framework.Map output records:7653040" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986617528"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"16","CNTR_NAME_Stage-1_MAP_PROGRESS":"89"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986617529"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:58,595 Stage-1 map = 90%,  reduce = 17%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2884496,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8223202,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:126180743,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:18338044895,FileSystemCounters.FILE_BYTES_WRITTEN:735927246,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:142461187,Map-Reduce Framework.Reduce shuffle bytes:94051089,Map-Reduce Framework.Spilled Records:9412696,Map-Reduce Framework.Map output bytes:603136648,Map-Reduce Framework.CPU time spent (ms):882020,Map-Reduce Framework.Total committed heap usage (bytes):15316877312,Map-Reduce Framework.Map input bytes:13287555072,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27314,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18570829824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:55696027648,Map-Reduce Framework.Map output records:7718249" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986618595"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"17","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986618596"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:56:59,602 Stage-1 map = 91%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3050505,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8612410,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:132163228,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:18887003462,FileSystemCounters.FILE_BYTES_WRITTEN:753310170,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:146664965,Map-Reduce Framework.Reduce shuffle bytes:94051089,Map-Reduce Framework.Spilled Records:9607300,Map-Reduce Framework.Map output bytes:614651156,Map-Reduce Framework.CPU time spent (ms):906640,Map-Reduce Framework.Total committed heap usage (bytes):15521349632,Map-Reduce Framework.Map input bytes:13690208256,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27666,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18816782336,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56324816896,Map-Reduce Framework.Map output records:7850774" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986619602"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986619603"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:00,610 Stage-1 map = 92%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3151672,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8872648,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136151294,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:19217722934,FileSystemCounters.FILE_BYTES_WRITTEN:836979964,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:149913610,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:10785992,Map-Reduce Framework.Map output bytes:708983411,Map-Reduce Framework.CPU time spent (ms):934460,Map-Reduce Framework.Total committed heap usage (bytes):15846801408,Map-Reduce Framework.Map input bytes:13891534848,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27902,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19253760000,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57729294336,Map-Reduce Framework.Map output records:9248702" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986620610"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"92"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986620611"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:01,617 Stage-1 map = 93%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3181346,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8872648,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136151294,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:19217722934,FileSystemCounters.FILE_BYTES_WRITTEN:836979964,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:149913610,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:10785992,Map-Reduce Framework.Map output bytes:708983411,Map-Reduce Framework.CPU time spent (ms):934460,Map-Reduce Framework.Total committed heap usage (bytes):15846801408,Map-Reduce Framework.Map input bytes:13891534848,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27902,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19253760000,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57729294336,Map-Reduce Framework.Map output records:9248702" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986621618"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986621619"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:03,629 Stage-1 map = 94%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3379532,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9261932,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142133178,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:19610623546,FileSystemCounters.FILE_BYTES_WRITTEN:854275119,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152918768,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:10980634,Map-Reduce Framework.Map output bytes:717216471,Map-Reduce Framework.CPU time spent (ms):949290,Map-Reduce Framework.Total committed heap usage (bytes):15846801408,Map-Reduce Framework.Map input bytes:14159970304,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27902,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19264172032,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57729294336,Map-Reduce Framework.Map output records:9343571" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986623630"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986623631"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:04,636 Stage-1 map = 94%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3454819,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9392126,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126550,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:19708190267,FileSystemCounters.FILE_BYTES_WRITTEN:860064869,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:153666874,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:11045731,Map-Reduce Framework.Map output bytes:719250838,Map-Reduce Framework.CPU time spent (ms):952650,Map-Reduce Framework.Total committed heap usage (bytes):15846801408,Map-Reduce Framework.Map input bytes:14227079168,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27902,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19264335872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57729294336,Map-Reduce Framework.Map output records:9366984" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986624636"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986624637"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:05,644 Stage-1 map = 94%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3461818,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9392126,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126550,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:19708190267,FileSystemCounters.FILE_BYTES_WRITTEN:860064869,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:153666874,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:11045731,Map-Reduce Framework.Map output bytes:719250838,Map-Reduce Framework.CPU time spent (ms):952650,Map-Reduce Framework.Total committed heap usage (bytes):15846801408,Map-Reduce Framework.Map input bytes:14227079168,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27902,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19264335872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57729294336,Map-Reduce Framework.Map output records:9366984" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986625644"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986625645"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:06,653 Stage-1 map = 96%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3632815,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9651588,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148114772,FileSystemCounters.FILE_BYTES_READ:228473153,FileSystemCounters.HDFS_BYTES_READ:20241158050,FileSystemCounters.FILE_BYTES_WRITTEN:964840569,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:157752136,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:12529489,Map-Reduce Framework.Map output bytes:730435453,Map-Reduce Framework.CPU time spent (ms):980580,Map-Reduce Framework.Total committed heap usage (bytes):16021454848,Map-Reduce Framework.Map input bytes:14629732352,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28254,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19497574400,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58358771712,Map-Reduce Framework.Map output records:9495696" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986626653"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"27","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986626654"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:07,659 Stage-1 map = 96%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3695053,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9651588,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148114772,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20308267101,FileSystemCounters.FILE_BYTES_WRITTEN:1117070893,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:158861719,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:14748655,Map-Reduce Framework.Map output bytes:804290338,Map-Reduce Framework.CPU time spent (ms):994670,Map-Reduce Framework.Total committed heap usage (bytes):16198139904,Map-Reduce Framework.Map input bytes:14629732352,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28440,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19714498560,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:59060666368,Map-Reduce Framework.Map output records:10605279" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986627659"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986627660"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:09,671 Stage-1 map = 97%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3800042,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20557652064,FileSystemCounters.FILE_BYTES_WRITTEN:1122830902,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:160774878,Map-Reduce Framework.Reduce shuffle bytes:137762900,Map-Reduce Framework.Spilled Records:14813356,Map-Reduce Framework.Map output bytes:809520956,Map-Reduce Framework.CPU time spent (ms):1003380,Map-Reduce Framework.Total committed heap usage (bytes):16198139904,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28440,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19727929344,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:59063771136,Map-Reduce Framework.Map output records:10665372" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986629671"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986629672"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:12,690 Stage-1 map = 98%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3845840,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20557652064,FileSystemCounters.FILE_BYTES_WRITTEN:1122993969,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:160774878,Map-Reduce Framework.Reduce shuffle bytes:247124305,Map-Reduce Framework.Spilled Records:14813356,Map-Reduce Framework.Map output bytes:809520956,Map-Reduce Framework.CPU time spent (ms):1006590,Map-Reduce Framework.Total committed heap usage (bytes):16440098816,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28440,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20011573248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60315422720,Map-Reduce Framework.Map output records:10665372" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986632690"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986632702"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:14,714 Stage-1 map = 98%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3953801,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:456963960,FileSystemCounters.HDFS_BYTES_READ:20691878358,FileSystemCounters.FILE_BYTES_WRITTEN:1427425510,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162992261,Map-Reduce Framework.Reduce shuffle bytes:247124305,Map-Reduce Framework.Spilled Records:19248122,Map-Reduce Framework.Map output bytes:957219739,Map-Reduce Framework.CPU time spent (ms):1035770,Map-Reduce Framework.Total committed heap usage (bytes):16793468928,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28812,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20448780288,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:61563174912,Map-Reduce Framework.Map output records:12882755" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986634714"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986634715"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:16,728 Stage-1 map = 98%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4012000,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20884755376,FileSystemCounters.FILE_BYTES_WRITTEN:1705644366,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:166179251,Map-Reduce Framework.Reduce shuffle bytes:321063554,Map-Reduce Framework.Spilled Records:23299911,Map-Reduce Framework.Map output bytes:1169460863,Map-Reduce Framework.CPU time spent (ms):1072410,Map-Reduce Framework.Total committed heap usage (bytes):17351311360,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21080887296,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:63581102080,Map-Reduce Framework.Map output records:16069744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986636728"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986636729"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:22,759 Stage-1 map = 98%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4053800,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20884755376,FileSystemCounters.FILE_BYTES_WRITTEN:1705644366,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:166179251,Map-Reduce Framework.Reduce shuffle bytes:321063554,Map-Reduce Framework.Spilled Records:23299911,Map-Reduce Framework.Map output bytes:1169460863,Map-Reduce Framework.CPU time spent (ms):1072410,Map-Reduce Framework.Total committed heap usage (bytes):17351311360,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21080887296,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:63581102080,Map-Reduce Framework.Map output records:16069744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986642760"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986642762"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:27,788 Stage-1 map = 99%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4074955,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20884755376,FileSystemCounters.FILE_BYTES_WRITTEN:1705644366,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:166179251,Map-Reduce Framework.Reduce shuffle bytes:321063554,Map-Reduce Framework.Spilled Records:23299911,Map-Reduce Framework.Map output bytes:1169460863,Map-Reduce Framework.CPU time spent (ms):1072410,Map-Reduce Framework.Total committed heap usage (bytes):17351311360,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21080887296,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:63581102080,Map-Reduce Framework.Map output records:16069744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986647788"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"99"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986647789"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:37,878 Stage-1 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4087257,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20884755376,FileSystemCounters.FILE_BYTES_WRITTEN:1787199660,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:166179251,Map-Reduce Framework.Reduce shuffle bytes:417712504,Map-Reduce Framework.Spilled Records:23299911,Map-Reduce Framework.Map output bytes:1169460863,Map-Reduce Framework.CPU time spent (ms):1078640,Map-Reduce Framework.Total committed heap usage (bytes):17547001856,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21264928768,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64209055744,Map-Reduce Framework.Map output records:16069744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986657878"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986657879"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:57:58,017 Stage-1 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4375389,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:21196720360,FileSystemCounters.FILE_BYTES_WRITTEN:3020604725,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:171329193,Map-Reduce Framework.Reduce shuffle bytes:868143985,Map-Reduce Framework.Spilled Records:35226690,Map-Reduce Framework.Map output bytes:1512377352,Map-Reduce Framework.CPU time spent (ms):1166190,Map-Reduce Framework.Total committed heap usage (bytes):18296209408,Map-Reduce Framework.Map input bytes:15032385536,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22270009344,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:21219687" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986678017"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986678018"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:24,161 Stage-1 map = 100%,  reduce = 40%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756894445,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1206183715,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1200740,Map-Reduce Framework.Total committed heap usage (bytes):18467520512,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22624608256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986704162"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"40","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986704163"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:26,204 Stage-1 map = 100%,  reduce = 47%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756894445,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1206183715,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1200740,Map-Reduce Framework.Total committed heap usage (bytes):18467520512,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22624608256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986706205"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"47","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986706205"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:27,215 Stage-1 map = 100%,  reduce = 57%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756894445,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1206183715,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1200740,Map-Reduce Framework.Total committed heap usage (bytes):18467520512,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22624608256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986707215"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"57","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986707216"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:28,222 Stage-1 map = 100%,  reduce = 60%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756894445,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1206183715,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1200740,Map-Reduce Framework.Total committed heap usage (bytes):18467520512,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22624608256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986708222"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"60","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986708223"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:29,229 Stage-1 map = 100%,  reduce = 67%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756894445,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1206183715,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1200740,Map-Reduce Framework.Total committed heap usage (bytes):18467520512,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22624608256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986709230"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"67","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986709231"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:32,247 Stage-1 map = 100%,  reduce = 68%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1279539586,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3839345027,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1273459654,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1205540,Map-Reduce Framework.Total committed heap usage (bytes):18458279936,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8136,Map-Reduce Framework.Reduce input groups:8136,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22697693184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986712247"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"68","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986712248"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:35,338 Stage-1 map = 100%,  reduce = 70%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1279539586,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3839345027,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1273459654,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1205540,Map-Reduce Framework.Total committed heap usage (bytes):18458279936,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8136,Map-Reduce Framework.Reduce input groups:8136,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22697693184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986715338"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"70","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986715339"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:37,351 Stage-1 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1279539586,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3839345027,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1273459654,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1205540,Map-Reduce Framework.Total committed heap usage (bytes):18458279936,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8136,Map-Reduce Framework.Reduce input groups:8136,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22697693184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986717351"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"71","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986717352"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:38,358 Stage-1 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1279539586,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3839345027,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1273459654,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1205540,Map-Reduce Framework.Total committed heap usage (bytes):18458279936,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8136,Map-Reduce Framework.Reduce input groups:8136,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22697693184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986718358"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"72","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986718359"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:41,375 Stage-1 map = 100%,  reduce = 73%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1279539586,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3839345027,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1273459654,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1205540,Map-Reduce Framework.Total committed heap usage (bytes):18458279936,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8136,Map-Reduce Framework.Reduce input groups:8136,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22697693184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986721376"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"73","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986721377"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:43,387 Stage-1 map = 100%,  reduce = 74%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1313110402,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914206917,FileSystemCounters.HDFS_BYTES_WRITTEN:5136895,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1340725251,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1214300,Map-Reduce Framework.Total committed heap usage (bytes):18451660800,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:468413,Map-Reduce Framework.Reduce input groups:468413,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22761951232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986723388"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"74","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986723389"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:45,401 Stage-1 map = 100%,  reduce = 75%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1313110402,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914206917,FileSystemCounters.HDFS_BYTES_WRITTEN:5136895,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1340725251,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1214300,Map-Reduce Framework.Total committed heap usage (bytes):18451660800,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:468413,Map-Reduce Framework.Reduce input groups:468413,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22761951232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986725402"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"75","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986725403"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:47,413 Stage-1 map = 100%,  reduce = 76%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1313110402,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914206917,FileSystemCounters.HDFS_BYTES_WRITTEN:5136895,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1340725251,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1214300,Map-Reduce Framework.Total committed heap usage (bytes):18451660800,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:468413,Map-Reduce Framework.Reduce input groups:468413,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22761951232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986727413"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"76","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986727414"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:48,420 Stage-1 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1313110402,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914206917,FileSystemCounters.HDFS_BYTES_WRITTEN:5136895,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1340725251,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1214300,Map-Reduce Framework.Total committed heap usage (bytes):18451660800,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:468413,Map-Reduce Framework.Reduce input groups:468413,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22761951232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986728420"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"77","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986728421"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:49,430 Stage-1 map = 100%,  reduce = 78%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1313110402,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914206917,FileSystemCounters.HDFS_BYTES_WRITTEN:5136895,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1340725251,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1214300,Map-Reduce Framework.Total committed heap usage (bytes):18451660800,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:468413,Map-Reduce Framework.Reduce input groups:468413,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22761951232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986729430"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"78","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986729431"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:51,444 Stage-1 map = 100%,  reduce = 79%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1368234370,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996898492,FileSystemCounters.HDFS_BYTES_WRITTEN:13741459,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1408214537,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1223390,Map-Reduce Framework.Total committed heap usage (bytes):18420334592,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:1224942,Map-Reduce Framework.Reduce input groups:1224908,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22773411840,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986731444"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"79","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986731445"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:52,450 Stage-1 map = 100%,  reduce = 80%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1445972354,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079390853,FileSystemCounters.HDFS_BYTES_WRITTEN:25928286,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1460232027,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232710,Map-Reduce Framework.Total committed heap usage (bytes):18422824960,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2291094,Map-Reduce Framework.Reduce input groups:2291061,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22821924864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986732451"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"80","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986732452"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:54,465 Stage-1 map = 100%,  reduce = 81%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1445972354,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079390853,FileSystemCounters.HDFS_BYTES_WRITTEN:25928286,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1460232027,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232710,Map-Reduce Framework.Total committed heap usage (bytes):18422824960,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2291094,Map-Reduce Framework.Reduce input groups:2291061,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22821924864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66100682752,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986734466"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"81","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986734467"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:55,473 Stage-1 map = 100%,  reduce = 82%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1513879938,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161890819,FileSystemCounters.HDFS_BYTES_WRITTEN:36586043,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1512311957,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1245430,Map-Reduce Framework.Total committed heap usage (bytes):18422824960,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3236717,Map-Reduce Framework.Reduce input groups:3236685,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22860218368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986735473"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"82","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986735474"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:56,479 Stage-1 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1513879938,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161890819,FileSystemCounters.HDFS_BYTES_WRITTEN:36586043,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1512311957,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1245430,Map-Reduce Framework.Total committed heap usage (bytes):18422824960,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3236717,Map-Reduce Framework.Reduce input groups:3236685,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22860218368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986736479"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"83","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986736488"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:57,497 Stage-1 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1513879938,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161890819,FileSystemCounters.HDFS_BYTES_WRITTEN:36586043,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1512311957,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1245430,Map-Reduce Framework.Total committed heap usage (bytes):18422824960,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3236717,Map-Reduce Framework.Reduce input groups:3236685,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22860218368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986737498"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"84","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986737499"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:58:59,509 Stage-1 map = 100%,  reduce = 86%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1594898818,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4244524779,FileSystemCounters.HDFS_BYTES_WRITTEN:49304688,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549262618,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1258440,Map-Reduce Framework.Total committed heap usage (bytes):18427543552,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:4347034,Map-Reduce Framework.Reduce input groups:4347003,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22869417984,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986739510"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"86","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986739511"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:00,516 Stage-1 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1675958658,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4319310578,FileSystemCounters.HDFS_BYTES_WRITTEN:62078270,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1571967555,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1271660,Map-Reduce Framework.Total committed heap usage (bytes):18445959168,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5457389,Map-Reduce Framework.Reduce input groups:5457359,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22871261184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986740516"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"87","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986740517"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:02,528 Stage-1 map = 100%,  reduce = 88%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1675958658,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4319310578,FileSystemCounters.HDFS_BYTES_WRITTEN:62078270,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1571967555,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1271660,Map-Reduce Framework.Total committed heap usage (bytes):18445959168,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5457389,Map-Reduce Framework.Reduce input groups:5457359,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22871261184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986742528"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"88","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986742529"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:03,534 Stage-1 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1675958658,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4319310578,FileSystemCounters.HDFS_BYTES_WRITTEN:62078270,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1571967555,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1271660,Map-Reduce Framework.Total committed heap usage (bytes):18445959168,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5457389,Map-Reduce Framework.Reduce input groups:5457359,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22871261184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986743534"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"90","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986743535"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:05,545 Stage-1 map = 100%,  reduce = 91%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:8403,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1675958658,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4319310578,FileSystemCounters.HDFS_BYTES_WRITTEN:62078270,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1571967555,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1271660,Map-Reduce Framework.Total committed heap usage (bytes):18445959168,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5457389,Map-Reduce Framework.Reduce input groups:5457359,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22871261184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986745546"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"91","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986745547"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:06,554 Stage-1 map = 100%,  reduce = 93%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:317016,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2004321312,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4484404371,FileSystemCounters.HDFS_BYTES_WRITTEN:113900490,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617663722,Map-Reduce Framework.Spilled Records:45592474,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1304100,Map-Reduce Framework.Total committed heap usage (bytes):18422759424,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:9954073,Map-Reduce Framework.Reduce input groups:9954043,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22849957888,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986746554"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"93","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986746555"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:08,566 Stage-1 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:317016,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2004321312,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4484404371,FileSystemCounters.HDFS_BYTES_WRITTEN:113900490,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617663722,Map-Reduce Framework.Spilled Records:45592474,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1304100,Map-Reduce Framework.Total committed heap usage (bytes):18422759424,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:9954073,Map-Reduce Framework.Reduce input groups:9954043,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22849957888,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986748566"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"94","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986748567"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:10,619 Stage-1 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:474308,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2113402020,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4484404371,FileSystemCounters.HDFS_BYTES_WRITTEN:131211073,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617663722,Map-Reduce Framework.Spilled Records:47841435,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1310140,Map-Reduce Framework.Total committed heap usage (bytes):18420727808,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:11446505,Map-Reduce Framework.Reduce input groups:11446509,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22817456128,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986750619"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"95","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986750620"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:12,630 Stage-1 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:792416,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2363638136,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:170731774,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:52333712,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1330450,Map-Reduce Framework.Total committed heap usage (bytes):18388025344,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:14872630,Map-Reduce Framework.Reduce input groups:14872633,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22786334720,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986752630"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"96","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986752631"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:14,646 Stage-1 map = 100%,  reduce = 97%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:954073,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2493990895,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:191406820,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:54578882,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1339400,Map-Reduce Framework.Total committed heap usage (bytes):18385666048,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:16657523,Map-Reduce Framework.Reduce input groups:16657526,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22773329920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986754646"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"97","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986754647"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:16,661 Stage-1 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:954073,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2493990895,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:191406820,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:54578882,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1339400,Map-Reduce Framework.Total committed heap usage (bytes):18385666048,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:16657523,Map-Reduce Framework.Reduce input groups:16657526,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22773329920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986756662"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"98","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986756663"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:20,710 Stage-1 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:1118738,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2577060498,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:204560923,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56826529,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1345210,Map-Reduce Framework.Total committed heap usage (bytes):18368102400,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17794853,Map-Reduce Framework.Reduce input groups:17794855,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22752628736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986760710"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"99","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986760711"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:25,738 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:1291597,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2740427785,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:230418892,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:59071000,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1359720,Map-Reduce Framework.Total committed heap usage (bytes):18380750848,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20031188,Map-Reduce Framework.Reduce input groups:20031190,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22751535104,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986765739"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986765740"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986777814"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986777866"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 22:59:25,738 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4526827,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:67,Job Counters .SLOTS_MILLIS_REDUCES:1291597,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2740427785,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989187,FileSystemCounters.HDFS_BYTES_WRITTEN:230418892,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:59071000,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1359720,Map-Reduce Framework.Total committed heap usage (bytes):18380750848,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20031188,Map-Reduce Framework.Reduce input groups:20031190,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22751535104,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66105331712,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0075" TIME="1337986777866"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337986777866"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986777869"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:59:47,703 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:5051" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986787703"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986787704"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:00:48,291 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:5051" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986848292"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986848292"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:31,666 Stage-2 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:8,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.HDFS_BYTES_READ:17415183,FileSystemCounters.FILE_BYTES_WRITTEN:11834142,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:327796,Map-Reduce Framework.Physical memory (bytes) snapshot:211410944,Map-Reduce Framework.Spilled Records:262144,Map-Reduce Framework.Map output bytes:15283668,Map-Reduce Framework.CPU time spent (ms):10530,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:686755840,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:327804,Map-Reduce Framework.SPLIT_RAW_BYTES:346" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986891666"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"13","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986891667"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:32,672 Stage-2 map = 19%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:13702,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:8,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:23675501,FileSystemCounters.HDFS_BYTES_READ:43253761,FileSystemCounters.FILE_BYTES_WRITTEN:59197160,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:813989,Map-Reduce Framework.Physical memory (bytes) snapshot:427479040,Map-Reduce Framework.Spilled Records:1234530,Map-Reduce Framework.Map output bytes:37951779,Map-Reduce Framework.CPU time spent (ms):22810,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1365401600,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:813997,Map-Reduce Framework.SPLIT_RAW_BYTES:591" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986892672"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"19","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986892673"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:34,683 Stage-2 map = 31%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:13702,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:8,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:23675501,FileSystemCounters.HDFS_BYTES_READ:43253761,FileSystemCounters.FILE_BYTES_WRITTEN:59197160,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:813989,Map-Reduce Framework.Physical memory (bytes) snapshot:427479040,Map-Reduce Framework.Spilled Records:1234530,Map-Reduce Framework.Map output bytes:37951779,Map-Reduce Framework.CPU time spent (ms):22810,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1365401600,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:813997,Map-Reduce Framework.SPLIT_RAW_BYTES:591" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986894683"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"31","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986894684"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:36,694 Stage-2 map = 44%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:32087,Job Counters .Rack-local map tasks:10,Job Counters .Launched map tasks:11,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:47369407,FileSystemCounters.HDFS_BYTES_READ:69112163,FileSystemCounters.FILE_BYTES_WRITTEN:106596433,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1300551,Map-Reduce Framework.Physical memory (bytes) snapshot:639221760,Map-Reduce Framework.Spilled Records:2207654,Map-Reduce Framework.Map output bytes:60637280,Map-Reduce Framework.CPU time spent (ms):36480,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Virtual memory (bytes) snapshot:1987858432,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1300559,Map-Reduce Framework.SPLIT_RAW_BYTES:836" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986896695"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"44","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986896695"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:37,700 Stage-2 map = 56%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:50880,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:71057621,FileSystemCounters.HDFS_BYTES_READ:94967762,FileSystemCounters.FILE_BYTES_WRITTEN:153990508,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1787057,Map-Reduce Framework.Physical memory (bytes) snapshot:850354176,Map-Reduce Framework.Spilled Records:3180666,Map-Reduce Framework.Map output bytes:83320294,Map-Reduce Framework.CPU time spent (ms):48760,Map-Reduce Framework.Total committed heap usage (bytes):706740224,Map-Reduce Framework.Virtual memory (bytes) snapshot:2612641792,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1787065,Map-Reduce Framework.SPLIT_RAW_BYTES:1081" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986897700"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"56","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986897701"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:38,706 Stage-2 map = 62%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:50880,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:71057621,FileSystemCounters.HDFS_BYTES_READ:94967762,FileSystemCounters.FILE_BYTES_WRITTEN:153990508,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1787057,Map-Reduce Framework.Physical memory (bytes) snapshot:850354176,Map-Reduce Framework.Spilled Records:3180666,Map-Reduce Framework.Map output bytes:83320294,Map-Reduce Framework.CPU time spent (ms):48760,Map-Reduce Framework.Total committed heap usage (bytes):706740224,Map-Reduce Framework.Virtual memory (bytes) snapshot:2612641792,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1787065,Map-Reduce Framework.SPLIT_RAW_BYTES:1081" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986898706"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"62","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986898707"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:40,775 Stage-2 map = 87%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:71753,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:94812877,FileSystemCounters.HDFS_BYTES_READ:120880575,FileSystemCounters.FILE_BYTES_WRITTEN:201489339,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2274632,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4155816,Map-Reduce Framework.Map output bytes:106053548,Map-Reduce Framework.CPU time spent (ms):61260,Map-Reduce Framework.Total committed heap usage (bytes):881262592,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1326,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1064849408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3240685568,Map-Reduce Framework.Map output records:2274640" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986900775"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"87","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"5"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986900776"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:41,783 Stage-2 map = 94%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:118685,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:142217838,FileSystemCounters.HDFS_BYTES_READ:172623572,FileSystemCounters.FILE_BYTES_WRITTEN:296335815,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3248233,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6103018,Map-Reduce Framework.Map output bytes:151447561,Map-Reduce Framework.CPU time spent (ms):87290,Map-Reduce Framework.Total committed heap usage (bytes):1232404480,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1491861504,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4487045120,Map-Reduce Framework.Map output records:3248241" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986901783"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"94","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"8"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986901784"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:42,789 Stage-2 map = 94%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:150298,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:189770880,FileSystemCounters.HDFS_BYTES_READ:207091030,FileSystemCounters.FILE_BYTES_WRITTEN:379522047,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896670,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:7793340,Map-Reduce Framework.Map output bytes:181680542,Map-Reduce Framework.CPU time spent (ms):98070,Map-Reduce Framework.Total committed heap usage (bytes):1232404480,Map-Reduce Framework.Map input bytes:25967054,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1495269376,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4487045120,Map-Reduce Framework.Map output records:3896670" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986902789"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"94","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"10"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986902790"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:43,795 Stage-2 map = 94%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:150298,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:189770880,FileSystemCounters.HDFS_BYTES_READ:207091030,FileSystemCounters.FILE_BYTES_WRITTEN:379603563,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896670,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:7793340,Map-Reduce Framework.Map output bytes:181680542,Map-Reduce Framework.CPU time spent (ms):98920,Map-Reduce Framework.Total committed heap usage (bytes):1353383936,Map-Reduce Framework.Map input bytes:25967054,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1589018624,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5117833216,Map-Reduce Framework.Map output records:3896670" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986903795"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"94","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"12"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986903796"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:44,800 Stage-2 map = 100%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:152682,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:189770880,FileSystemCounters.HDFS_BYTES_READ:207091030,FileSystemCounters.FILE_BYTES_WRITTEN:379603563,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896670,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:7793340,Map-Reduce Framework.Map output bytes:181680542,Map-Reduce Framework.CPU time spent (ms):98920,Map-Reduce Framework.Total committed heap usage (bytes):1353383936,Map-Reduce Framework.Map input bytes:25967054,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1589018624,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5117833216,Map-Reduce Framework.Map output records:3896670" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986904801"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"12"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986904801"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:45,806 Stage-2 map = 100%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:152682,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:189770880,FileSystemCounters.HDFS_BYTES_READ:207091030,FileSystemCounters.FILE_BYTES_WRITTEN:379603563,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896670,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:7793340,Map-Reduce Framework.Map output bytes:181680542,Map-Reduce Framework.CPU time spent (ms):98920,Map-Reduce Framework.Total committed heap usage (bytes):1353383936,Map-Reduce Framework.Map input bytes:25967054,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1589018624,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5117833216,Map-Reduce Framework.Map output records:3896670" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986905806"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"13"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986905807"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:46,812 Stage-2 map = 100%,  reduce = 19%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:152682,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:189770880,FileSystemCounters.HDFS_BYTES_READ:207091030,FileSystemCounters.FILE_BYTES_WRITTEN:379603563,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896670,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:7793340,Map-Reduce Framework.Map output bytes:181680542,Map-Reduce Framework.CPU time spent (ms):98920,Map-Reduce Framework.Total committed heap usage (bytes):1353383936,Map-Reduce Framework.Map input bytes:25967054,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1589018624,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5117833216,Map-Reduce Framework.Map output records:3896670" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986906812"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"19"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986906813"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:48,855 Stage-2 map = 100%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:186155,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:237172469,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:474340706,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):116500,Map-Reduce Framework.Total committed heap usage (bytes):1530068992,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1804365824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5750689792,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986908855"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"21"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986908856"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:49,861 Stage-2 map = 100%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:192341,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:237172469,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:474340706,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):116500,Map-Reduce Framework.Total committed heap usage (bytes):1530068992,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1804365824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5750689792,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986909861"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"28"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986909862"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:50,867 Stage-2 map = 100%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:192341,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:237172469,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:474340706,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:9513461,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):116500,Map-Reduce Framework.Total committed heap usage (bytes):1530068992,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1804365824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5750689792,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986910867"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"30"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986910868"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:52,877 Stage-2 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:192341,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:5051,FileSystemCounters.FILE_BYTES_READ:237172469,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:474422223,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:33188996,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):117390,Map-Reduce Framework.Total committed heap usage (bytes):1651048448,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1921937408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:6442356736,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986912877"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"33"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986912878"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:54,887 Stage-2 map = 100%,  reduce = 37%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:27233,FileSystemCounters.FILE_BYTES_READ:260795102,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:498126373,FileSystemCounters.HDFS_BYTES_WRITTEN:9884435,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:56811671,Map-Reduce Framework.Spilled Records:10225809,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):123850,Map-Reduce Framework.Total committed heap usage (bytes):1772027904,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:485821,Map-Reduce Framework.Reduce input groups:209915,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2040967168,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7068110848,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986914888"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"37"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986914888"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:55,894 Stage-2 map = 100%,  reduce = 59%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:74289,FileSystemCounters.FILE_BYTES_READ:308471648,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:569292937,FileSystemCounters.HDFS_BYTES_WRITTEN:29780340,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:104139792,Map-Reduce Framework.Spilled Records:11199395,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):140270,Map-Reduce Framework.Total committed heap usage (bytes):2012676096,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:1466848,Map-Reduce Framework.Reduce input groups:632679,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2295996416,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8446275584,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986915894"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"59"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986915895"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:56,900 Stage-2 map = 100%,  reduce = 69%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:98558,FileSystemCounters.FILE_BYTES_READ:332195890,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:593180212,FileSystemCounters.HDFS_BYTES_WRITTEN:39660869,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:151547142,Map-Reduce Framework.Spilled Records:11687306,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):147780,Map-Reduce Framework.Total committed heap usage (bytes):2254635008,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:1954759,Map-Reduce Framework.Reduce input groups:842514,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2520064000,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9746919424,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986916900"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"69"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986916901"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:57,907 Stage-2 map = 100%,  reduce = 78%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:98558,FileSystemCounters.FILE_BYTES_READ:332195890,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:593180212,FileSystemCounters.HDFS_BYTES_WRITTEN:39660869,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:151547142,Map-Reduce Framework.Spilled Records:11687306,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):147780,Map-Reduce Framework.Total committed heap usage (bytes):2254635008,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:1954759,Map-Reduce Framework.Reduce input groups:842514,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2520064000,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9746919424,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986917908"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"78"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986917908"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:58,916 Stage-2 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:98558,FileSystemCounters.FILE_BYTES_READ:338053170,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:616901199,FileSystemCounters.HDFS_BYTES_WRITTEN:42105384,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:175186654,Map-Reduce Framework.Spilled Records:11687306,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):152930,Map-Reduce Framework.Total committed heap usage (bytes):2403401728,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2080829,Map-Reduce Framework.Reduce input groups:896878,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2640871424,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10365837312,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986918916"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"84"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986918917"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:01:59,922 Stage-2 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:207025,FileSystemCounters.FILE_BYTES_READ:426913036,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:688060391,FileSystemCounters.HDFS_BYTES_WRITTEN:79197390,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:213067929,Map-Reduce Framework.Spilled Records:13635232,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):174460,Map-Reduce Framework.Total committed heap usage (bytes):2524381184,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3902685,Map-Reduce Framework.Reduce input groups:1682140,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2818428928,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10985504768,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986919923"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"95"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986919923"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:02:00,929 Stage-2 map = 100%,  reduce = 97%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:234948,FileSystemCounters.FILE_BYTES_READ:450240020,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:688060391,FileSystemCounters.HDFS_BYTES_WRITTEN:88932637,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:213067929,Map-Reduce Framework.Spilled Records:14121871,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):178560,Map-Reduce Framework.Total committed heap usage (bytes):2522480640,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4381883,Map-Reduce Framework.Reduce input groups:1888644,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2818633728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10985504768,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986920929"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"97"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986920932"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:02:01,937 Stage-2 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:234948,FileSystemCounters.FILE_BYTES_READ:450240020,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:688060391,FileSystemCounters.HDFS_BYTES_WRITTEN:88932637,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:213067929,Map-Reduce Framework.Spilled Records:14121871,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):178560,Map-Reduce Framework.Total committed heap usage (bytes):2522480640,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4381883,Map-Reduce Framework.Reduce input groups:1888644,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2818633728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10985504768,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986921937"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"98"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986921938"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:02:03,950 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:274056,FileSystemCounters.FILE_BYTES_READ:473973911,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:711875799,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:236801862,Map-Reduce Framework.Spilled Records:14609982,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):186600,Map-Reduce Framework.Total committed heap usage (bytes):2671247360,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4869994,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2972049408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11602997248,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986923950"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986923951"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986928980"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986929031"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:02:03,950 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:197413,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:13,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:274056,FileSystemCounters.FILE_BYTES_READ:473973911,FileSystemCounters.HDFS_BYTES_READ:258818840,FileSystemCounters.FILE_BYTES_WRITTEN:711875799,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:236801862,Map-Reduce Framework.Spilled Records:14609982,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):186600,Map-Reduce Framework.Total committed heap usage (bytes):2671247360,Map-Reduce Framework.Map input bytes:51778995,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4869994,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2972049408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11602997248,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0079" TIME="1337986929031"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337986929031"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986929033"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:02:14,960 Stage-3 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2501" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986934960"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986934960"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:03,262 Stage-3 map = 25%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:13353,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.HDFS_BYTES_READ:19780843,FileSystemCounters.FILE_BYTES_WRITTEN:21428892,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:420066,Map-Reduce Framework.Physical memory (bytes) snapshot:391659520,Map-Reduce Framework.Spilled Records:420066,Map-Reduce Framework.Map output bytes:20425497,Map-Reduce Framework.CPU time spent (ms):12560,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1276801024,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:420066,Map-Reduce Framework.SPLIT_RAW_BYTES:490" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986983262"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"25"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986983263"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:05,272 Stage-3 map = 42%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:22619,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.HDFS_BYTES_READ:29656577,FileSystemCounters.FILE_BYTES_WRITTEN:32127520,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:629784,Map-Reduce Framework.Physical memory (bytes) snapshot:596787200,Map-Reduce Framework.Spilled Records:629784,Map-Reduce Framework.Map output bytes:30623058,Map-Reduce Framework.CPU time spent (ms):20960,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Virtual memory (bytes) snapshot:1895419904,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:629784,Map-Reduce Framework.SPLIT_RAW_BYTES:735" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986985272"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"42"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986985273"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:06,302 Stage-3 map = 79%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:39702,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.HDFS_BYTES_READ:49412561,FileSystemCounters.FILE_BYTES_WRITTEN:53529689,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1049324,Map-Reduce Framework.Physical memory (bytes) snapshot:1006116864,Map-Reduce Framework.Spilled Records:1049324,Map-Reduce Framework.Map output bytes:51022884,Map-Reduce Framework.CPU time spent (ms):35620,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3256692736,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1049324,Map-Reduce Framework.SPLIT_RAW_BYTES:1225" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986986302"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"79"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986986303"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:07,370 Stage-3 map = 92%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:59986,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.HDFS_BYTES_READ:69179124,FileSystemCounters.FILE_BYTES_WRITTEN:74943218,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1469084,Map-Reduce Framework.Physical memory (bytes) snapshot:1393401856,Map-Reduce Framework.Spilled Records:1469084,Map-Reduce Framework.Map output bytes:71433629,Map-Reduce Framework.CPU time spent (ms):46940,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4564152320,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1469084,Map-Reduce Framework.SPLIT_RAW_BYTES:1715" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986987370"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"92"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986987371"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:09,380 Stage-3 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:73572,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.FILE_BYTES_READ:31887060,FileSystemCounters.HDFS_BYTES_READ:98839541,FileSystemCounters.FILE_BYTES_WRITTEN:138798950,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1599336448,Map-Reduce Framework.Spilled Records:2728816,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):59890,Map-Reduce Framework.Total committed heap usage (bytes):1413480448,Map-Reduce Framework.Virtual memory (bytes) snapshot:5242208256,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2162" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986989380"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986989381"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:13,400 Stage-3 map = 100%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:73572,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.FILE_BYTES_READ:31887060,FileSystemCounters.HDFS_BYTES_READ:98839541,FileSystemCounters.FILE_BYTES_WRITTEN:138798950,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1599336448,Map-Reduce Framework.Spilled Records:2728816,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):59890,Map-Reduce Framework.Total committed heap usage (bytes):1413480448,Map-Reduce Framework.Virtual memory (bytes) snapshot:5242208256,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2162" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986993400"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"21","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986993401"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:16,416 Stage-3 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:73572,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2501,FileSystemCounters.FILE_BYTES_READ:31887060,FileSystemCounters.HDFS_BYTES_READ:98839541,FileSystemCounters.FILE_BYTES_WRITTEN:138798950,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1599336448,Map-Reduce Framework.Spilled Records:2728816,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):59890,Map-Reduce Framework.Total committed heap usage (bytes):1413480448,Map-Reduce Framework.Virtual memory (bytes) snapshot:5242208256,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2162" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986996416"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"71","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986996417"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:18,427 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:73572,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:17779,FileSystemCounters.FILE_BYTES_READ:138145911,FileSystemCounters.HDFS_BYTES_READ:98839541,FileSystemCounters.FILE_BYTES_WRITTEN:245139316,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258887,Map-Reduce Framework.Spilled Records:4827766,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):67530,Map-Reduce Framework.Total committed heap usage (bytes):1585971200,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1841127424,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5931565056,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337986998427"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337986998428"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987000441"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987000495"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:03:18,427 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:73572,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:17779,FileSystemCounters.FILE_BYTES_READ:138145911,FileSystemCounters.HDFS_BYTES_READ:98839541,FileSystemCounters.FILE_BYTES_WRITTEN:245139316,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258887,Map-Reduce Framework.Spilled Records:4827766,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):67530,Map-Reduce Framework.Total committed heap usage (bytes):1585971200,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1841127424,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5931565056,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0082" TIME="1337987000495"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337987000495"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987000497"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:25,539 Stage-4 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2262,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0084" TIME="1337987005539"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987005540"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:03:28,554 Stage-4 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5351,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:81682,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:195584000,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):990,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:617562112,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0084" TIME="1337987008554"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987008555"
TaskProgress ROWS_INSERTED="rankings_uservisits_join~1" TASK_HADOOP_PROGRESS="2012-05-25 23:03:37,602 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5351,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8862,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163253,FileSystemCounters.HDFS_BYTES_WRITTEN:46,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2140,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:288157696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1300037632,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0084" TIME="1337987017603"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987017605"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987020623"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987020672"
TaskEnd ROWS_INSERTED="rankings_uservisits_join~1" TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:03:37,602 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5351,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8862,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163253,FileSystemCounters.HDFS_BYTES_WRITTEN:46,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2140,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:288157696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1300037632,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TASK_HADOOP_ID="job_201205252023_0084" TIME="1337987020672"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337987020672"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987020676"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987021056"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337987021057"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337987021057"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"}" TIME="1337987021057"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"}" TIME="1337987021417"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" TIME="1337987021417"
QueryEnd ROWS_INSERTED="rankings_uservisits_join~1" QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5" QUERY_RET_CODE="0" QUERY_NUM_TASKS="4" TIME="1337987021418"
Counters plan="{"queryId":"ubuntu_20120525224949_d58cd850-2d67-4e51-9424-0c6f26db8cb5","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"}" TIME="1337987021418"
