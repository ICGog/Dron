SessionStart SESSION_ID="ubuntu_201205252141" TIME="1337982084099"
QueryStart QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982102946"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982103022"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982103025"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982103048"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:42:02,497 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8907" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982122498"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982122499"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:02,791 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:8907" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982182792"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982182793"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:30,924 Stage-1 map = 2%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:43035,Job Counters .Rack-local map tasks:37,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:53,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056642,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:424173568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9980,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1238515712,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982210927"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"2"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982210928"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:32,939 Stage-1 map = 3%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:43035,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056642,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:424173568,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):9980,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1238515712,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982212942"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"3"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982212944"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:34,954 Stage-1 map = 4%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:68014,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:201339453,FileSystemCounters.FILE_BYTES_WRITTEN:4596260,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1543882,Map-Reduce Framework.Physical memory (bytes) snapshot:638517248,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4252466,Map-Reduce Framework.CPU time spent (ms):16730,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Virtual memory (bytes) snapshot:1942876160,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:49015,Map-Reduce Framework.SPLIT_RAW_BYTES:570" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982214955"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"4"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982214956"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:35,963 Stage-1 map = 5%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:68014,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:201339453,FileSystemCounters.FILE_BYTES_WRITTEN:4596260,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1543882,Map-Reduce Framework.Physical memory (bytes) snapshot:638517248,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:4252466,Map-Reduce Framework.CPU time spent (ms):16730,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Virtual memory (bytes) snapshot:1942876160,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:49015,Map-Reduce Framework.SPLIT_RAW_BYTES:570" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982215963"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"5"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982215965"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:37,974 Stage-1 map = 7%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:268452604,FileSystemCounters.FILE_BYTES_WRITTEN:6109138,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2058821,Map-Reduce Framework.Physical memory (bytes) snapshot:850227200,Map-Reduce Framework.Spilled Records:65195,Map-Reduce Framework.Map output bytes:5651062,Map-Reduce Framework.CPU time spent (ms):21620,Map-Reduce Framework.Total committed heap usage (bytes):706740224,Map-Reduce Framework.Virtual memory (bytes) snapshot:2516164608,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:65195,Map-Reduce Framework.SPLIT_RAW_BYTES:760" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982217975"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"7"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982217976"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:40,021 Stage-1 map = 8%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:616859261,FileSystemCounters.FILE_BYTES_WRITTEN:42334767,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:5101236,Map-Reduce Framework.Physical memory (bytes) snapshot:1494097920,Map-Reduce Framework.Spilled Records:589482,Map-Reduce Framework.Map output bytes:56670485,Map-Reduce Framework.CPU time spent (ms):41050,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4424970240,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:808525,Map-Reduce Framework.SPLIT_RAW_BYTES:1650" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982220021"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"8"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982220023"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:41,028 Stage-1 map = 9%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:723848193,FileSystemCounters.FILE_BYTES_WRITTEN:42661222,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:5935546,Map-Reduce Framework.Physical memory (bytes) snapshot:2346954752,Map-Reduce Framework.Spilled Records:589482,Map-Reduce Framework.Map output bytes:58960364,Map-Reduce Framework.CPU time spent (ms):57070,Map-Reduce Framework.Total committed heap usage (bytes):1971322880,Map-Reduce Framework.Virtual memory (bytes) snapshot:6973530112,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:834860,Map-Reduce Framework.SPLIT_RAW_BYTES:3058" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982221028"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"9"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982221030"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:42,035 Stage-1 map = 10%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:1100593444,FileSystemCounters.FILE_BYTES_WRITTEN:43477357,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:8891069,Map-Reduce Framework.Physical memory (bytes) snapshot:4515958784,Map-Reduce Framework.Spilled Records:589482,Map-Reduce Framework.Map output bytes:71148939,Map-Reduce Framework.CPU time spent (ms):110640,Map-Reduce Framework.Total committed heap usage (bytes):3765960704,Map-Reduce Framework.Virtual memory (bytes) snapshot:13354332160,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:989991,Map-Reduce Framework.SPLIT_RAW_BYTES:6412" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982222035"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"10"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982222037"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:43,043 Stage-1 map = 12%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:1276087271,FileSystemCounters.FILE_BYTES_WRITTEN:43640585,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:10245910,Map-Reduce Framework.Physical memory (bytes) snapshot:4944801792,Map-Reduce Framework.Spilled Records:589482,Map-Reduce Framework.Map output bytes:74859919,Map-Reduce Framework.CPU time spent (ms):125380,Map-Reduce Framework.Total committed heap usage (bytes):4117299200,Map-Reduce Framework.Virtual memory (bytes) snapshot:14614355968,Map-Reduce Framework.Map input bytes:335544320,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1032765,Map-Reduce Framework.SPLIT_RAW_BYTES:7116" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982223043"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"12"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982223044"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:44,050 Stage-1 map = 14%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:86721,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:130390,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1993626,FileSystemCounters.HDFS_BYTES_READ:1276087271,FileSystemCounters.FILE_BYTES_WRITTEN:43640585,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:10245910,Map-Reduce Framework.Physical memory (bytes) snapshot:4944801792,Map-Reduce Framework.Spilled Records:589482,Map-Reduce Framework.Map output bytes:74859919,Map-Reduce Framework.CPU time spent (ms):125380,Map-Reduce Framework.Total committed heap usage (bytes):4117299200,Map-Reduce Framework.Virtual memory (bytes) snapshot:14614355968,Map-Reduce Framework.Map input bytes:335544320,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1032765,Map-Reduce Framework.SPLIT_RAW_BYTES:7116" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982224050"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"14"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982224051"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:45,057 Stage-1 map = 17%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:111685,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:134042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2049673,FileSystemCounters.HDFS_BYTES_READ:1587422113,FileSystemCounters.FILE_BYTES_WRITTEN:44292051,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:12655100,Map-Reduce Framework.Physical memory (bytes) snapshot:6247141376,Map-Reduce Framework.Spilled Records:591308,Map-Reduce Framework.Map output bytes:81454921,Map-Reduce Framework.CPU time spent (ms):161260,Map-Reduce Framework.Total committed heap usage (bytes):5232984064,Map-Reduce Framework.Virtual memory (bytes) snapshot:18424274944,Map-Reduce Framework.Map input bytes:402653184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1108696,Map-Reduce Framework.SPLIT_RAW_BYTES:9066" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982225057"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"17"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982225059"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:46,064 Stage-1 map = 19%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:111685,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:134042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2049673,FileSystemCounters.HDFS_BYTES_READ:1731795367,FileSystemCounters.FILE_BYTES_WRITTEN:44700121,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:13815458,Map-Reduce Framework.Physical memory (bytes) snapshot:7307300864,Map-Reduce Framework.Spilled Records:591308,Map-Reduce Framework.Map output bytes:88950270,Map-Reduce Framework.CPU time spent (ms):185040,Map-Reduce Framework.Total committed heap usage (bytes):6116409344,Map-Reduce Framework.Virtual memory (bytes) snapshot:21680873472,Map-Reduce Framework.Map input bytes:469762048,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1210711,Map-Reduce Framework.SPLIT_RAW_BYTES:10602" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982226064"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"19"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982226066"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:47,071 Stage-1 map = 21%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:111685,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:134042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2049673,FileSystemCounters.HDFS_BYTES_READ:1731795367,FileSystemCounters.FILE_BYTES_WRITTEN:44700121,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:13815458,Map-Reduce Framework.Physical memory (bytes) snapshot:7307300864,Map-Reduce Framework.Spilled Records:591308,Map-Reduce Framework.Map output bytes:88950270,Map-Reduce Framework.CPU time spent (ms):185040,Map-Reduce Framework.Total committed heap usage (bytes):6116409344,Map-Reduce Framework.Virtual memory (bytes) snapshot:21680873472,Map-Reduce Framework.Map input bytes:469762048,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1210711,Map-Reduce Framework.SPLIT_RAW_BYTES:10602" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982227072"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"21"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982227073"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:48,079 Stage-1 map = 23%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:111685,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:134042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2049673,FileSystemCounters.HDFS_BYTES_READ:1731795367,FileSystemCounters.FILE_BYTES_WRITTEN:44700121,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:13815458,Map-Reduce Framework.Physical memory (bytes) snapshot:7307300864,Map-Reduce Framework.Spilled Records:591308,Map-Reduce Framework.Map output bytes:88950270,Map-Reduce Framework.CPU time spent (ms):185040,Map-Reduce Framework.Total committed heap usage (bytes):6116409344,Map-Reduce Framework.Virtual memory (bytes) snapshot:21680873472,Map-Reduce Framework.Map input bytes:469762048,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1210711,Map-Reduce Framework.SPLIT_RAW_BYTES:10602" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982228079"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"23"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982228080"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:49,088 Stage-1 map = 26%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:181225,Job Counters .Rack-local map tasks:41,Job Counters .Launched map tasks:95,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:393982,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:6037784,FileSystemCounters.HDFS_BYTES_READ:1960389033,FileSystemCounters.FILE_BYTES_WRITTEN:56243987,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:15559356,Map-Reduce Framework.Physical memory (bytes) snapshot:7312121856,Map-Reduce Framework.Spilled Records:721278,Map-Reduce Framework.Map output bytes:93707611,Map-Reduce Framework.CPU time spent (ms):190310,Map-Reduce Framework.Total committed heap usage (bytes):6116409344,Map-Reduce Framework.Virtual memory (bytes) snapshot:21680873472,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1265583,Map-Reduce Framework.SPLIT_RAW_BYTES:10602" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982229088"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"26"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982229090"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:50,095 Stage-1 map = 30%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:245176,Job Counters .Rack-local map tasks:43,Job Counters .Launched map tasks:97,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:458856,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:7034932,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:2161728346,FileSystemCounters.FILE_BYTES_WRITTEN:211429609,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:17697638,Map-Reduce Framework.Physical memory (bytes) snapshot:7747518464,Map-Reduce Framework.Spilled Records:2971109,Map-Reduce Framework.Map output bytes:170380119,Map-Reduce Framework.CPU time spent (ms):208790,Map-Reduce Framework.Total committed heap usage (bytes):6469779456,Map-Reduce Framework.Virtual memory (bytes) snapshot:22957252608,Map-Reduce Framework.Map input bytes:671088640,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2406717,Map-Reduce Framework.SPLIT_RAW_BYTES:11032" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982230096"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"30"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982230097"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:51,102 Stage-1 map = 33%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:286379,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:589346,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:9028180,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:2430180542,FileSystemCounters.FILE_BYTES_WRITTEN:217321890,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:19756131,Map-Reduce Framework.Physical memory (bytes) snapshot:7968387072,Map-Reduce Framework.Spilled Records:3036354,Map-Reduce Framework.Map output bytes:176059989,Map-Reduce Framework.CPU time spent (ms):219070,Map-Reduce Framework.Total committed heap usage (bytes):6646464512,Map-Reduce Framework.Virtual memory (bytes) snapshot:23597625344,Map-Reduce Framework.Map input bytes:872415232,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2471962,Map-Reduce Framework.SPLIT_RAW_BYTES:11384" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982231102"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"33"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982231104"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:52,109 Stage-1 map = 35%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:286379,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:589346,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:9028180,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:2430180542,FileSystemCounters.FILE_BYTES_WRITTEN:217321890,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:19756131,Map-Reduce Framework.Physical memory (bytes) snapshot:7968387072,Map-Reduce Framework.Spilled Records:3036354,Map-Reduce Framework.Map output bytes:176059989,Map-Reduce Framework.CPU time spent (ms):219070,Map-Reduce Framework.Total committed heap usage (bytes):6646464512,Map-Reduce Framework.Virtual memory (bytes) snapshot:23597625344,Map-Reduce Framework.Map input bytes:872415232,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2471962,Map-Reduce Framework.SPLIT_RAW_BYTES:11384" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982232110"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"35"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982232111"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:53,117 Stage-1 map = 37%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:323586,Job Counters .Rack-local map tasks:45,Job Counters .Launched map tasks:99,Job Counters .Data-local map tasks:54,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:687510,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:10522907,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:2631519723,FileSystemCounters.FILE_BYTES_WRITTEN:221776637,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:21299940,Map-Reduce Framework.Physical memory (bytes) snapshot:8194035712,Map-Reduce Framework.Spilled Records:3085436,Map-Reduce Framework.Map output bytes:180334650,Map-Reduce Framework.CPU time spent (ms):228290,Map-Reduce Framework.Total committed heap usage (bytes):6823149568,Map-Reduce Framework.Virtual memory (bytes) snapshot:24242200576,Map-Reduce Framework.Map input bytes:1006632960,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2521044,Map-Reduce Framework.SPLIT_RAW_BYTES:11682" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982233117"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"37"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982233118"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:54,125 Stage-1 map = 41%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:400742,Job Counters .Rack-local map tasks:46,Job Counters .Launched map tasks:101,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:947074,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:14511183,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:3168424115,FileSystemCounters.FILE_BYTES_WRITTEN:233483270,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:25417998,Map-Reduce Framework.Physical memory (bytes) snapshot:8624738304,Map-Reduce Framework.Spilled Records:3215218,Map-Reduce Framework.Map output bytes:191617876,Map-Reduce Framework.CPU time spent (ms):249490,Map-Reduce Framework.Total committed heap usage (bytes):7176519680,Map-Reduce Framework.Virtual memory (bytes) snapshot:25505509376,Map-Reduce Framework.Map input bytes:1409286144,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2650826,Map-Reduce Framework.SPLIT_RAW_BYTES:12386" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982234125"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"41"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982234126"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:55,132 Stage-1 map = 44%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:446120,Job Counters .Rack-local map tasks:47,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1077842,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:16505269,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:3436876311,FileSystemCounters.FILE_BYTES_WRITTEN:239383101,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:27477468,Map-Reduce Framework.Physical memory (bytes) snapshot:8839548928,Map-Reduce Framework.Spilled Records:3280602,Map-Reduce Framework.Map output bytes:197305019,Map-Reduce Framework.CPU time spent (ms):261860,Map-Reduce Framework.Total committed heap usage (bytes):7353204736,Map-Reduce Framework.Virtual memory (bytes) snapshot:26134622208,Map-Reduce Framework.Map input bytes:1610612736,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2716210,Map-Reduce Framework.SPLIT_RAW_BYTES:12738" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982235132"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"44"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982235133"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:56,138 Stage-1 map = 47%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:446120,Job Counters .Rack-local map tasks:47,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1077842,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:16505269,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:4154951235,FileSystemCounters.FILE_BYTES_WRITTEN:239627940,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:32995644,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3280602,Map-Reduce Framework.Map output bytes:212422797,Map-Reduce Framework.CPU time spent (ms):294650,Map-Reduce Framework.Total committed heap usage (bytes):7881293824,Map-Reduce Framework.Map input bytes:2214592512,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:13794,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9502113792,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:28079308800,Map-Reduce Framework.Map output records:2890321" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982236139"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"47"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982236140"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:57,145 Stage-1 map = 50%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:588595,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:105,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1467744,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:22487030,FileSystemCounters.FILE_BYTES_READ:76154694,FileSystemCounters.HDFS_BYTES_READ:4460771239,FileSystemCounters.FILE_BYTES_WRITTEN:257018171,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:35330532,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3475553,Map-Reduce Framework.Map output bytes:218822936,Map-Reduce Framework.CPU time spent (ms):307230,Map-Reduce Framework.Total committed heap usage (bytes):8057978880,Map-Reduce Framework.Map input bytes:2415919104,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:14146,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9718214656,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:28709818368,Map-Reduce Framework.Map output records:2964070" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982237146"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"50"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982237147"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:58,153 Stage-1 map = 55%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:856985,Job Counters .Rack-local map tasks:55,Job Counters .Launched map tasks:111,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2114764,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:32458572,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:5696912157,FileSystemCounters.FILE_BYTES_WRITTEN:402185158,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:44994744,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:5493446,Map-Reduce Framework.Map output bytes:269295746,Map-Reduce Framework.CPU time spent (ms):348960,Map-Reduce Framework.Total committed heap usage (bytes):8532328448,Map-Reduce Framework.Map input bytes:3355443200,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:15016,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10272661504,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:30578905088,Map-Reduce Framework.Map output records:3633153" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982238153"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"55"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982238154"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:43:59,161 Stage-1 map = 58%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:943919,Job Counters .Rack-local map tasks:57,Job Counters .Launched map tasks:113,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2310124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:35449490,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:6076988546,FileSystemCounters.FILE_BYTES_WRITTEN:410943031,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:47903895,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:5591126,Map-Reduce Framework.Map output bytes:277283502,Map-Reduce Framework.CPU time spent (ms):366050,Map-Reduce Framework.Total committed heap usage (bytes):8709013504,Map-Reduce Framework.Map input bytes:3623878656,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:15368,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10496585728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:31218085888,Map-Reduce Framework.Map output records:3725176" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982239161"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"58"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982239162"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:00,168 Stage-1 map = 61%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1068120,Job Counters .Rack-local map tasks:60,Job Counters .Launched map tasks:116,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2669056,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:40932682,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:6827151242,FileSystemCounters.FILE_BYTES_WRITTEN:427073505,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:53621141,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:5770592,Map-Reduce Framework.Map output bytes:288694049,Map-Reduce Framework.CPU time spent (ms):395590,Map-Reduce Framework.Total committed heap usage (bytes):9062383616,Map-Reduce Framework.Map input bytes:4160749568,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:16134,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10931433472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:32460697600,Map-Reduce Framework.Map output records:3840376" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982240168"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"61"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982240169"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:01,175 Stage-1 map = 63%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1150500,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:118,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2896846,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:44422391,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:7181140153,FileSystemCounters.FILE_BYTES_WRITTEN:437275607,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:56332322,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:5884487,Map-Reduce Framework.Map output bytes:296145088,Map-Reduce Framework.CPU time spent (ms):409260,Map-Reduce Framework.Total committed heap usage (bytes):9239068672,Map-Reduce Framework.Map input bytes:4429185024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:16432,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11149017088,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:33099223040,Map-Reduce Framework.Map output records:3926122" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982241176"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"63"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982241189"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:02,195 Stage-1 map = 65%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1343291,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:122,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3416396,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:52399102,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:8187835624,FileSystemCounters.FILE_BYTES_WRITTEN:460626243,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:64053979,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:6144262,Map-Reduce Framework.Map output bytes:317315166,Map-Reduce Framework.CPU time spent (ms):451080,Map-Reduce Framework.Total committed heap usage (bytes):9794879488,Map-Reduce Framework.Map input bytes:5234491392,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17488,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11839094784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:34976563200,Map-Reduce Framework.Map output records:4169642" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982242196"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"65"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982242197"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:03,203 Stage-1 map = 67%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1390613,Job Counters .Rack-local map tasks:66,Job Counters .Launched map tasks:123,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3545896,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:54393201,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:8371893482,FileSystemCounters.FILE_BYTES_WRITTEN:466399987,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:65461607,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:6209012,Map-Reduce Framework.Map output bytes:321174595,Map-Reduce Framework.CPU time spent (ms):456040,Map-Reduce Framework.Total committed heap usage (bytes):9794879488,Map-Reduce Framework.Map input bytes:5368709120,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17488,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11842019328,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:34976563200,Map-Reduce Framework.Map output records:4213903" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982243203"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"67"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982243204"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:04,232 Stage-1 map = 72%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1644055,Job Counters .Rack-local map tasks:72,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4324866,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:66357844,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:9922915297,FileSystemCounters.FILE_BYTES_WRITTEN:501428805,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:77353317,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:6598497,Map-Reduce Framework.Map output bytes:353744592,Map-Reduce Framework.CPU time spent (ms):517480,Map-Reduce Framework.Total committed heap usage (bytes):10704125952,Map-Reduce Framework.Map input bytes:6576668672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19248,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12955971584,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:38158041088,Map-Reduce Framework.Map output records:4588763" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982244233"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"72"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982244233"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:05,240 Stage-1 map = 74%,  reduce = 7%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1938848,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5103154,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:78323369,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:11327864148,FileSystemCounters.FILE_BYTES_WRITTEN:536096756,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:88109872,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:6987641,Map-Reduce Framework.Map output bytes:383173684,Map-Reduce Framework.CPU time spent (ms):561560,Map-Reduce Framework.Total committed heap usage (bytes):10878779392,Map-Reduce Framework.Map input bytes:7784628224,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19600,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13225295872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:38858055680,Map-Reduce Framework.Map output records:4927584" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982245240"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"7","CNTR_NAME_Stage-1_MAP_PROGRESS":"74"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982245241"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:06,247 Stage-1 map = 76%,  reduce = 7%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1987915,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5233094,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:80317650,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:11596316344,FileSystemCounters.FILE_BYTES_WRITTEN:541951738,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:90169123,Map-Reduce Framework.Reduce shuffle bytes:11790847,Map-Reduce Framework.Spilled Records:7052611,Map-Reduce Framework.Map output bytes:388816804,Map-Reduce Framework.CPU time spent (ms):574190,Map-Reduce Framework.Total committed heap usage (bytes):11053432832,Map-Reduce Framework.Map input bytes:7985954816,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19952,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13456756736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:39503167488,Map-Reduce Framework.Map output records:4992554" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982246247"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"7","CNTR_NAME_Stage-1_MAP_PROGRESS":"76"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982246248"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:07,254 Stage-1 map = 78%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2238217,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5882196,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:90288146,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:12547661508,FileSystemCounters.FILE_BYTES_WRITTEN:570905454,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:97451370,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:7377162,Map-Reduce Framework.Map output bytes:408791247,Map-Reduce Framework.CPU time spent (ms):606310,Map-Reduce Framework.Total committed heap usage (bytes):11174412288,Map-Reduce Framework.Map input bytes:8791261184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19952,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13605658624,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:40147570688,Map-Reduce Framework.Map output records:5222381" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982247254"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"78"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982247255"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:08,275 Stage-1 map = 82%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2475654,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6402836,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:98264045,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:13583069773,FileSystemCounters.FILE_BYTES_WRITTEN:746454037,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:105981642,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:9856648,Map-Reduce Framework.Map output bytes:503047949,Map-Reduce Framework.CPU time spent (ms):657800,Map-Reduce Framework.Total committed heap usage (bytes):11730288640,Map-Reduce Framework.Map input bytes:9596567552,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20842,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14281515008,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42029228032,Map-Reduce Framework.Map output records:6566658" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982248275"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"10","CNTR_NAME_Stage-1_MAP_PROGRESS":"82"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982248276"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:09,282 Stage-1 map = 83%,  reduce = 14%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2523937,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6532818,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:100258638,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:13849911888,FileSystemCounters.FILE_BYTES_WRITTEN:752237115,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:108026381,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:9921639,Map-Reduce Framework.Map output bytes:508658988,Map-Reduce Framework.CPU time spent (ms):669760,Map-Reduce Framework.Total committed heap usage (bytes):11730288640,Map-Reduce Framework.Map input bytes:9797894144,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20842,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14308982784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42029228032,Map-Reduce Framework.Map output records:6631177" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982249282"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"14","CNTR_NAME_Stage-1_MAP_PROGRESS":"83"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982249283"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:10,289 Stage-1 map = 84%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2565907,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6597850,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:101255479,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:13984138054,FileSystemCounters.FILE_BYTES_WRITTEN:755206867,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:109055738,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:9954155,Map-Reduce Framework.Map output bytes:511481787,Map-Reduce Framework.CPU time spent (ms):680410,Map-Reduce Framework.Total committed heap usage (bytes):11934760960,Map-Reduce Framework.Map input bytes:9865003008,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21086,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14525775872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42658148352,Map-Reduce Framework.Map output records:6663693" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982250290"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"84"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982250291"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:11,296 Stage-1 map = 85%,  reduce = 16%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2767627,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7117640,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:109231830,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:14992959349,FileSystemCounters.FILE_BYTES_WRITTEN:778544634,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:116789189,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:10214050,Map-Reduce Framework.Map output bytes:532667250,Map-Reduce Framework.CPU time spent (ms):725870,Map-Reduce Framework.Total committed heap usage (bytes):12492603392,Map-Reduce Framework.Map input bytes:10670309376,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22142,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15201226752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:44577533952,Map-Reduce Framework.Map output records:6907615" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982251296"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"16","CNTR_NAME_Stage-1_MAP_PROGRESS":"85"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982251297"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:12,303 Stage-1 map = 87%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2926410,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7507146,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:115213476,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:15738693855,FileSystemCounters.FILE_BYTES_WRITTEN:795947415,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:122502495,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:10408803,Map-Reduce Framework.Map output bytes:548323660,Map-Reduce Framework.CPU time spent (ms):755160,Map-Reduce Framework.Total committed heap usage (bytes):12665225216,Map-Reduce Framework.Map input bytes:11274289152,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22494,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15452487680,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:45216419840,Map-Reduce Framework.Map output records:7087709" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982252304"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"87"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982252305"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:13,310 Stage-1 map = 88%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2981809,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7637086,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:117207600,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:16007146051,FileSystemCounters.FILE_BYTES_WRITTEN:801805614,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:124561589,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:10473773,Map-Reduce Framework.Map output bytes:553969997,Map-Reduce Framework.CPU time spent (ms):767880,Map-Reduce Framework.Total committed heap usage (bytes):12841910272,Map-Reduce Framework.Map input bytes:11475615744,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22846,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15675383808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:45861416960,Map-Reduce Framework.Map output records:7152679" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982253311"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-1_MAP_PROGRESS":"88"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982253312"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:14,321 Stage-1 map = 89%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3141202,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7962250,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:122192182,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:16678276609,FileSystemCounters.FILE_BYTES_WRITTEN:816506191,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:129708753,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:10636355,Map-Reduce Framework.Map output bytes:568099644,Map-Reduce Framework.CPU time spent (ms):804270,Map-Reduce Framework.Total committed heap usage (bytes):13369933824,Map-Reduce Framework.Map input bytes:11945377792,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23794,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16330113024,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:47760138240,Map-Reduce Framework.Map output records:7315261" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982254321"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-1_MAP_PROGRESS":"89"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982254322"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:15,329 Stage-1 map = 90%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3194180,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8092186,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:124186392,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:16946728805,FileSystemCounters.FILE_BYTES_WRITTEN:822365333,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:131767931,Map-Reduce Framework.Reduce shuffle bytes:42753496,Map-Reduce Framework.Spilled Records:10701323,Map-Reduce Framework.Map output bytes:573746928,Map-Reduce Framework.CPU time spent (ms):818270,Map-Reduce Framework.Total committed heap usage (bytes):13546618880,Map-Reduce Framework.Map input bytes:12146704384,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24146,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16553361408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:48383660032,Map-Reduce Framework.Map output records:7380229" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982255329"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982255330"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:16,336 Stage-1 map = 90%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3253278,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8222674,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:126179993,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:17215181001,FileSystemCounters.FILE_BYTES_WRITTEN:828337763,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:133826776,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:10766567,Map-Reduce Framework.Map output bytes:579425415,Map-Reduce Framework.CPU time spent (ms):832450,Map-Reduce Framework.Total committed heap usage (bytes):13844283392,Map-Reduce Framework.Map input bytes:12348030976,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24498,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16938569728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:49661378560,Map-Reduce Framework.Map output records:7445473" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982256336"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982256337"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:17,343 Stage-1 map = 91%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3335074,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8352442,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:128173793,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:17483629101,FileSystemCounters.FILE_BYTES_WRITTEN:834188087,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:135885460,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:10831451,Map-Reduce Framework.Map output bytes:585064049,Map-Reduce Framework.CPU time spent (ms):845710,Map-Reduce Framework.Total committed heap usage (bytes):14048755712,Map-Reduce Framework.Map input bytes:12549357568,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24850,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17175379968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50304016384,Map-Reduce Framework.Map output records:7510357" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982257343"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982257344"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:18,350 Stage-1 map = 93%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3563491,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8871628,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136150030,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:18530739451,FileSystemCounters.FILE_BYTES_WRITTEN:857431745,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:143913459,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:11091044,Map-Reduce Framework.Map output bytes:607057047,Map-Reduce Framework.CPU time spent (ms):888930,Map-Reduce Framework.Total committed heap usage (bytes):14429913088,Map-Reduce Framework.Map input bytes:13354663936,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25554,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17669312512,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:51563479040,Map-Reduce Framework.Map output records:7763429" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982258351"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982258352"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:19,454 Stage-1 map = 94%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3680487,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9131278,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:140138568,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:19284252967,FileSystemCounters.FILE_BYTES_WRITTEN:869226899,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:149695822,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:11220869,Map-Reduce Framework.Map output bytes:622898265,Map-Reduce Framework.CPU time spent (ms):925870,Map-Reduce Framework.Total committed heap usage (bytes):14957936640,Map-Reduce Framework.Map input bytes:13958643712,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:26610,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18326609920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53478830080,Map-Reduce Framework.Map output records:7945695" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982259454"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982259455"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:20,461 Stage-1 map = 95%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3810884,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9391824,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126701,FileSystemCounters.FILE_BYTES_READ:228487347,FileSystemCounters.HDFS_BYTES_READ:19821157359,FileSystemCounters.FILE_BYTES_WRITTEN:880971118,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:153814228,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:11351142,Map-Reduce Framework.Map output bytes:634218094,Map-Reduce Framework.CPU time spent (ms):953840,Map-Reduce Framework.Total committed heap usage (bytes):15311306752,Map-Reduce Framework.Map input bytes:14361296896,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27314,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18768519168,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:54798430208,Map-Reduce Framework.Map output records:8075968" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982260461"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982260462"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:21,468 Stage-1 map = 95%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3893923,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9391824,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126701,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:19888270506,FileSystemCounters.FILE_BYTES_WRITTEN:1033200756,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:154923757,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:13570200,Map-Reduce Framework.Map output bytes:708072744,Map-Reduce Framework.CPU time spent (ms):971700,Map-Reduce Framework.Total committed heap usage (bytes):15515779072,Map-Reduce Framework.Map input bytes:14361296896,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27500,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19025866752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:55434706944,Map-Reduce Framework.Map output records:9185497" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982261468"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"26","CNTR_NAME_Stage-1_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982261469"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:22,475 Stage-1 map = 97%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3953239,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9521312,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:146120930,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20156722702,FileSystemCounters.FILE_BYTES_WRITTEN:1039039016,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:156982730,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:13634944,Map-Reduce Framework.Map output bytes:713699594,Map-Reduce Framework.CPU time spent (ms):985260,Map-Reduce Framework.Total committed heap usage (bytes):15692464128,Map-Reduce Framework.Map input bytes:14562623488,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27852,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19251802112,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56119984128,Map-Reduce Framework.Map output records:9250241" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982262475"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"26","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982262476"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:23,482 Stage-1 map = 97%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3972122,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9521312,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:146120930,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20156722702,FileSystemCounters.FILE_BYTES_WRITTEN:1039039016,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:156982730,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:13634944,Map-Reduce Framework.Map output bytes:713699594,Map-Reduce Framework.CPU time spent (ms):985260,Map-Reduce Framework.Total committed heap usage (bytes):15692464128,Map-Reduce Framework.Map input bytes:14562623488,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27852,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19251802112,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56119984128,Map-Reduce Framework.Map output records:9250241" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982263483"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"27","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982263484"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:25,497 Stage-1 map = 98%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4096771,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20477017970,FileSystemCounters.FILE_BYTES_WRITTEN:1050649596,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159437144,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:13764783,Map-Reduce Framework.Map output bytes:720417094,Map-Reduce Framework.CPU time spent (ms):1000470,Map-Reduce Framework.Total committed heap usage (bytes):15869149184,Map-Reduce Framework.Map input bytes:14763950080,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28204,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19466936320,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56759795712,Map-Reduce Framework.Map output records:9327639" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982265497"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982265498"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:26,504 Stage-1 map = 98%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4110878,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20569870432,FileSystemCounters.FILE_BYTES_WRITTEN:1140599201,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:160983048,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:15075500,Map-Reduce Framework.Map output bytes:823322802,Map-Reduce Framework.CPU time spent (ms):1018440,Map-Reduce Framework.Total committed heap usage (bytes):16045834240,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28440,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19687899136,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57395118080,Map-Reduce Framework.Map output records:10873543" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982266504"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982266505"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:27,586 Stage-1 map = 98%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4156972,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304647621,FileSystemCounters.HDFS_BYTES_READ:20569870432,FileSystemCounters.FILE_BYTES_WRITTEN:1140599201,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:160983048,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:15075500,Map-Reduce Framework.Map output bytes:823322802,Map-Reduce Framework.CPU time spent (ms):1018440,Map-Reduce Framework.Total committed heap usage (bytes):16045834240,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28440,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19687899136,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57395118080,Map-Reduce Framework.Map output records:10873543" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982267587"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982267587"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:32,715 Stage-1 map = 98%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4347405,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:456967613,FileSystemCounters.HDFS_BYTES_READ:20704096726,FileSystemCounters.FILE_BYTES_WRITTEN:1445024934,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:163200063,Map-Reduce Framework.Reduce shuffle bytes:95407415,Map-Reduce Framework.Spilled Records:19509530,Map-Reduce Framework.Map output bytes:971019417,Map-Reduce Framework.CPU time spent (ms):1054720,Map-Reduce Framework.Total committed heap usage (bytes):16399204352,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28812,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20139601920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58786209792,Map-Reduce Framework.Map output records:13090558" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982272715"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982272716"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:40,866 Stage-1 map = 98%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4447790,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20771209873,FileSystemCounters.FILE_BYTES_WRITTEN:1597323362,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:164308824,Map-Reduce Framework.Reduce shuffle bytes:169346664,Map-Reduce Framework.Spilled Records:21727052,Map-Reduce Framework.Map output bytes:1044869231,Map-Reduce Framework.CPU time spent (ms):1075010,Map-Reduce Framework.Total committed heap usage (bytes):16801988608,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28998,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20565942272,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60104626176,Map-Reduce Framework.Map output records:14199319" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982280866"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982280867"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:46,900 Stage-1 map = 99%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4471985,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:561000402,FileSystemCounters.HDFS_BYTES_READ:21020456045,FileSystemCounters.FILE_BYTES_WRITTEN:2072161223,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:168427359,Map-Reduce Framework.Reduce shuffle bytes:653107530,Map-Reduce Framework.Spilled Records:25739766,Map-Reduce Framework.Map output bytes:1319139749,Map-Reduce Framework.CPU time spent (ms):1142120,Map-Reduce Framework.Total committed heap usage (bytes):18161532928,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21973245952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64483909632,Map-Reduce Framework.Map output records:18317853" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982286901"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"99"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982286901"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:44:48,915 Stage-1 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4471985,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:561000402,FileSystemCounters.HDFS_BYTES_READ:21020456045,FileSystemCounters.FILE_BYTES_WRITTEN:2072161223,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:168427359,Map-Reduce Framework.Reduce shuffle bytes:653107530,Map-Reduce Framework.Spilled Records:25739766,Map-Reduce Framework.Map output bytes:1319139749,Map-Reduce Framework.CPU time spent (ms):1142120,Map-Reduce Framework.Total committed heap usage (bytes):18161532928,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21973245952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64483909632,Map-Reduce Framework.Map output records:18317853" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982288917"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982288929"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:08,104 Stage-1 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4765186,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:21070956489,FileSystemCounters.FILE_BYTES_WRITTEN:2836480712,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169250596,Map-Reduce Framework.Reduce shuffle bytes:915645231,Map-Reduce Framework.Spilled Records:33391687,Map-Reduce Framework.Map output bytes:1373983874,Map-Reduce Framework.CPU time spent (ms):1175600,Map-Reduce Framework.Total committed heap usage (bytes):18518310912,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22442528768,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65113374720,Map-Reduce Framework.Map output records:19141091" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982308104"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982308105"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:49,428 Stage-1 map = 100%,  reduce = 37%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982349428"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"37","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982349429"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:50,434 Stage-1 map = 100%,  reduce = 40%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982350435"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"40","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982350435"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:51,441 Stage-1 map = 100%,  reduce = 47%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982351441"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"47","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982351442"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:52,448 Stage-1 map = 100%,  reduce = 53%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982352448"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"53","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982352449"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:53,455 Stage-1 map = 100%,  reduce = 60%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982353455"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"60","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982353456"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:54,461 Stage-1 map = 100%,  reduce = 63%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982354461"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"63","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982354462"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:55,468 Stage-1 map = 100%,  reduce = 67%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3756814494,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1294044513,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1224310,Map-Reduce Framework.Total committed heap usage (bytes):18709282816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23098302464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982355468"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"67","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982355469"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:57,480 Stage-1 map = 100%,  reduce = 68%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1283631490,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3831692447,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1361310110,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1230990,Map-Reduce Framework.Total committed heap usage (bytes):18705416192,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:64490,Map-Reduce Framework.Reduce input groups:64490,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23106179072,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982357480"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"68","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982357481"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:45:59,590 Stage-1 map = 100%,  reduce = 69%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1301182850,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914308936,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428728991,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1236520,Map-Reduce Framework.Total committed heap usage (bytes):18700435456,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:307260,Map-Reduce Framework.Reduce input groups:307240,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23113986048,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982359591"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"69","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982359592"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:00,609 Stage-1 map = 100%,  reduce = 70%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1301182850,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914308936,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428728991,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1236520,Map-Reduce Framework.Total committed heap usage (bytes):18700435456,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:307260,Map-Reduce Framework.Reduce input groups:307240,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23113986048,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982360610"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"70","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982360611"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:02,684 Stage-1 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1301182850,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914308936,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428728991,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1236520,Map-Reduce Framework.Total committed heap usage (bytes):18700435456,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:307260,Map-Reduce Framework.Reduce input groups:307240,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23113986048,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982362685"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"71","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982362686"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:04,730 Stage-1 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1301182850,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914308936,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428728991,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1236520,Map-Reduce Framework.Total committed heap usage (bytes):18700435456,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:307260,Map-Reduce Framework.Reduce input groups:307240,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23113986048,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982364731"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"72","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982364732"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:05,737 Stage-1 map = 100%,  reduce = 73%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1301182850,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3914308936,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428728991,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1236520,Map-Reduce Framework.Total committed heap usage (bytes):18700435456,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:307260,Map-Reduce Framework.Reduce input groups:307240,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23113986048,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982365737"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"73","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982365738"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:06,745 Stage-1 map = 100%,  reduce = 74%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982366745"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"74","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982366746"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:08,757 Stage-1 map = 100%,  reduce = 75%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982368757"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"75","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982368758"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:09,764 Stage-1 map = 100%,  reduce = 76%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982369764"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"76","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982369765"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:11,776 Stage-1 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982371776"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"77","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982371777"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:12,782 Stage-1 map = 100%,  reduce = 78%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982372783"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"78","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982372784"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:14,794 Stage-1 map = 100%,  reduce = 79%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1327688066,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3996803084,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1480746481,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1244890,Map-Reduce Framework.Total committed heap usage (bytes):18671009792,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:669750,Map-Reduce Framework.Reduce input groups:669730,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23164809216,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982374795"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"79","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982374795"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:17,812 Stage-1 map = 100%,  reduce = 80%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1382050178,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079387900,FileSystemCounters.HDFS_BYTES_WRITTEN:8482316,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1503568499,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1255780,Map-Reduce Framework.Total committed heap usage (bytes):18653249536,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:1416978,Map-Reduce Framework.Reduce input groups:1416958,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23172001792,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982377812"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"80","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982377813"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:18,819 Stage-1 map = 100%,  reduce = 81%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:8907,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1382050178,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079387900,FileSystemCounters.HDFS_BYTES_WRITTEN:8482316,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1503568499,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1255780,Map-Reduce Framework.Total committed heap usage (bytes):18653249536,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:1416978,Map-Reduce Framework.Reduce input groups:1416958,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23172001792,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982378819"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"81","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982378820"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:19,827 Stage-1 map = 100%,  reduce = 82%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:163925,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1528587301,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079387900,FileSystemCounters.HDFS_BYTES_WRITTEN:34355064,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1503568499,Map-Reduce Framework.Spilled Records:43343437,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1265020,Map-Reduce Framework.Total committed heap usage (bytes):18632933376,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3421855,Map-Reduce Framework.Reduce input groups:3421855,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23147556864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982379827"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"82","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982379828"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:21,840 Stage-1 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:163925,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1528587301,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079387900,FileSystemCounters.HDFS_BYTES_WRITTEN:34355064,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1503568499,Map-Reduce Framework.Spilled Records:43343437,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1265020,Map-Reduce Framework.Total committed heap usage (bytes):18632933376,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3421855,Map-Reduce Framework.Reduce input groups:3421855,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23147556864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982381840"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"83","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982381841"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:22,847 Stage-1 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:163925,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1528587301,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4079387900,FileSystemCounters.HDFS_BYTES_WRITTEN:34355064,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1503568499,Map-Reduce Framework.Spilled Records:43343437,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1265020,Map-Reduce Framework.Total committed heap usage (bytes):18632933376,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3421855,Map-Reduce Framework.Reduce input groups:3421855,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23147556864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982382847"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"84","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982382848"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:24,860 Stage-1 map = 100%,  reduce = 85%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:322219,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1692673902,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161887866,FileSystemCounters.HDFS_BYTES_WRITTEN:60267464,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1526409875,Map-Reduce Framework.Spilled Records:45590794,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1278780,Map-Reduce Framework.Total committed heap usage (bytes):18615631872,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5669212,Map-Reduce Framework.Reduce input groups:5669212,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23128100864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982384861"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"85","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982384866"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:25,872 Stage-1 map = 100%,  reduce = 86%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:322219,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1692673902,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161887866,FileSystemCounters.HDFS_BYTES_WRITTEN:60267464,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1526409875,Map-Reduce Framework.Spilled Records:45590794,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1278780,Map-Reduce Framework.Total committed heap usage (bytes):18615631872,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5669212,Map-Reduce Framework.Reduce input groups:5669212,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23128100864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982385873"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"86","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982385873"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:27,885 Stage-1 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:322219,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1692673902,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161887866,FileSystemCounters.HDFS_BYTES_WRITTEN:60267464,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1526409875,Map-Reduce Framework.Spilled Records:45590794,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1278780,Map-Reduce Framework.Total committed heap usage (bytes):18615631872,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5669212,Map-Reduce Framework.Reduce input groups:5669212,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23128100864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982387885"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"87","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982387886"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:28,893 Stage-1 map = 100%,  reduce = 88%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:322219,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1692673902,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4161887866,FileSystemCounters.HDFS_BYTES_WRITTEN:60267464,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1526409875,Map-Reduce Framework.Spilled Records:45590794,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1278780,Map-Reduce Framework.Total committed heap usage (bytes):18615631872,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:5669212,Map-Reduce Framework.Reduce input groups:5669212,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23128100864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982388893"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"88","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982388894"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:30,905 Stage-1 map = 100%,  reduce = 89%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:487319,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1856828912,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4244477870,FileSystemCounters.HDFS_BYTES_WRITTEN:86122610,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549247019,Map-Reduce Framework.Spilled Records:47838095,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1292310,Map-Reduce Framework.Total committed heap usage (bytes):18618843136,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7916513,Map-Reduce Framework.Reduce input groups:7916513,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23118876672,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982390906"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"89","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982390907"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:31,912 Stage-1 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:487319,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1856828912,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4244477870,FileSystemCounters.HDFS_BYTES_WRITTEN:86122610,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549247019,Map-Reduce Framework.Spilled Records:47838095,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1292310,Map-Reduce Framework.Total committed heap usage (bytes):18618843136,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7916513,Map-Reduce Framework.Reduce input groups:7916513,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23118876672,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982391913"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"90","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982391913"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:33,925 Stage-1 map = 100%,  reduce = 92%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:487319,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1856828912,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4244477870,FileSystemCounters.HDFS_BYTES_WRITTEN:86122610,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549247019,Map-Reduce Framework.Spilled Records:47838095,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1292310,Map-Reduce Framework.Total committed heap usage (bytes):18618843136,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7916513,Map-Reduce Framework.Reduce input groups:7916513,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23118876672,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982393925"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"92","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982393926"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:36,943 Stage-1 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:659595,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1994303165,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4244477870,FileSystemCounters.HDFS_BYTES_WRITTEN:111991953,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549247019,Map-Reduce Framework.Spilled Records:50083685,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1304380,Map-Reduce Framework.Total committed heap usage (bytes):18652921856,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:9799613,Map-Reduce Framework.Reduce input groups:9799613,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23118057472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982396943"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"94","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982396944"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:39,963 Stage-1 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:834609,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2158507841,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4327161278,FileSystemCounters.HDFS_BYTES_WRITTEN:137907120,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1572101893,Map-Reduce Framework.Spilled Records:52332646,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1324080,Map-Reduce Framework.Total committed heap usage (bytes):18627100672,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12048574,Map-Reduce Framework.Reduce input groups:12048574,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23107657728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982399963"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"95","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982399964"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:40,971 Stage-1 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1010395,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2268140360,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4327161278,FileSystemCounters.HDFS_BYTES_WRITTEN:155262969,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1572101893,Map-Reduce Framework.Spilled Records:54579333,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1332210,Map-Reduce Framework.Total committed heap usage (bytes):18637783040,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:13548033,Map-Reduce Framework.Reduce input groups:13548033,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23095029760,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982400971"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"96","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982400972"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:42,011 Stage-1 map = 100%,  reduce = 97%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1010395,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2383512392,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4401951616,FileSystemCounters.HDFS_BYTES_WRITTEN:173490315,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1594806830,Map-Reduce Framework.Spilled Records:54579333,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1348160,Map-Reduce Framework.Total committed heap usage (bytes):18657116160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:15132607,Map-Reduce Framework.Reduce input groups:15132605,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23107219456,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982402011"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"97","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982402012"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:47,040 Stage-1 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1192545,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2671549328,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989199,FileSystemCounters.HDFS_BYTES_WRITTEN:218946905,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56825622,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1383290,Map-Reduce Framework.Total committed heap usage (bytes):18634309632,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:19078451,Map-Reduce Framework.Reduce input groups:19078452,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23101943808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982407041"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"98","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982407041"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:48,047 Stage-1 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1192545,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2671549328,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989199,FileSystemCounters.HDFS_BYTES_WRITTEN:218946905,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56825622,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1383290,Map-Reduce Framework.Total committed heap usage (bytes):18634309632,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:19078451,Map-Reduce Framework.Reduce input groups:19078452,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23101943808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982408048"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"99","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982408048"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:46:54,118 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1567197,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2868398974,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989199,FileSystemCounters.HDFS_BYTES_WRITTEN:250715393,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:61315263,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1399670,Map-Reduce Framework.Total committed heap usage (bytes):18587058176,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:21771481,Map-Reduce Framework.Reduce input groups:21771482,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23057240064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982414118"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982414119"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982425181"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982425287"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 21:46:54,118 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4890837,Job Counters .Rack-local map tasks:74,Job Counters .Launched map tasks:131,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:1567197,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2868398974,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989199,FileSystemCounters.HDFS_BYTES_WRITTEN:250715393,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:61315263,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1399670,Map-Reduce Framework.Total committed heap usage (bytes):18587058176,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:21771481,Map-Reduce Framework.Reduce input groups:21771482,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23057240064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65736404992,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0025" TIME="1337982425287"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982425287"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982425289"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:47:15,765 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982435765"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982435769"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:48:16,115 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982496115"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982496115"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:49:16,392 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982556392"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982556393"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:50:16,891 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982616891"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982616892"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:51:17,232 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982677232"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982677233"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:52:17,549 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982737549"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982737550"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:53:17,800 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:6934" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982797800"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982797801"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:15,708 Stage-2 map = 6%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:7,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.HDFS_BYTES_READ:538617,FileSystemCounters.FILE_BYTES_WRITTEN:81596,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:11872,Map-Reduce Framework.Physical memory (bytes) snapshot:198053888,Map-Reduce Framework.Spilled Records:0,Map-Reduce Framework.Map output bytes:553591,Map-Reduce Framework.CPU time spent (ms):2250,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:632594432,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:11871,Map-Reduce Framework.SPLIT_RAW_BYTES:346" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982855708"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"6","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982855709"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:16,714 Stage-2 map = 12%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:7,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.HDFS_BYTES_READ:538617,FileSystemCounters.FILE_BYTES_WRITTEN:81596,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:11872,Map-Reduce Framework.Physical memory (bytes) snapshot:198053888,Map-Reduce Framework.Spilled Records:0,Map-Reduce Framework.Map output bytes:553591,Map-Reduce Framework.CPU time spent (ms):2250,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:632594432,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:11871,Map-Reduce Framework.SPLIT_RAW_BYTES:346" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982856714"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"12","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982856715"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:17,722 Stage-2 map = 25%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:4,Job Counters .SLOTS_MILLIS_MAPS:29407,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:9,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:23697210,FileSystemCounters.HDFS_BYTES_READ:26411798,FileSystemCounters.FILE_BYTES_WRITTEN:47507915,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:498708,Map-Reduce Framework.Physical memory (bytes) snapshot:416534528,Map-Reduce Framework.Spilled Records:973672,Map-Reduce Framework.Map output bytes:23252067,Map-Reduce Framework.CPU time spent (ms):11070,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1264619520,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:498707,Map-Reduce Framework.SPLIT_RAW_BYTES:591" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982857722"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"25","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982857723"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:22,747 Stage-2 map = 50%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:29407,Job Counters .Rack-local map tasks:10,Job Counters .Launched map tasks:11,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:23697210,FileSystemCounters.HDFS_BYTES_READ:40481477,FileSystemCounters.FILE_BYTES_WRITTEN:47589511,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:767499,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:973672,Map-Reduce Framework.Map output bytes:35784219,Map-Reduce Framework.CPU time spent (ms):18580,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:836,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:633176064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1902080000,Map-Reduce Framework.Map output records:767498" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982862747"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"50","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982862748"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:24,758 Stage-2 map = 56%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:29407,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:23697210,FileSystemCounters.HDFS_BYTES_READ:40481477,FileSystemCounters.FILE_BYTES_WRITTEN:47589511,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:767499,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:973672,Map-Reduce Framework.Map output bytes:35784219,Map-Reduce Framework.CPU time spent (ms):18580,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:836,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:633176064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1902080000,Map-Reduce Framework.Map output records:767498" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982864759"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"56","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982864759"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:26,799 Stage-2 map = 69%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:66015,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:47391116,FileSystemCounters.HDFS_BYTES_READ:52270180,FileSystemCounters.FILE_BYTES_WRITTEN:94907189,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:985270,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:1946796,Map-Reduce Framework.Map output bytes:45937568,Map-Reduce Framework.CPU time spent (ms):23140,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:836,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:639209472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1902080000,Map-Reduce Framework.Map output records:985269" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982866799"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"69","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982866800"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:28,869 Stage-2 map = 88%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:147746,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:118589146,FileSystemCounters.HDFS_BYTES_READ:129965477,FileSystemCounters.FILE_BYTES_WRITTEN:237243225,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2447200,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4870656,Map-Reduce Framework.Map output bytes:114099642,Map-Reduce Framework.CPU time spent (ms):48500,Map-Reduce Framework.Total committed heap usage (bytes):881262592,Map-Reduce Framework.Map input bytes:25915167,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1427,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1070866432,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3137024000,Map-Reduce Framework.Map output records:2447199" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982868870"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"88","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982868870"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:30,881 Stage-2 map = 100%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:147746,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:118589146,FileSystemCounters.HDFS_BYTES_READ:129965477,FileSystemCounters.FILE_BYTES_WRITTEN:237243225,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2447200,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4870656,Map-Reduce Framework.Map output bytes:114099642,Map-Reduce Framework.CPU time spent (ms):48500,Map-Reduce Framework.Total committed heap usage (bytes):881262592,Map-Reduce Framework.Map input bytes:25915167,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1427,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1070866432,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3137024000,Map-Reduce Framework.Map output records:2447199" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982870881"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"2"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982870882"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:32,891 Stage-2 map = 100%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:240736,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:189744463,FileSystemCounters.HDFS_BYTES_READ:207064904,FileSystemCounters.FILE_BYTES_WRITTEN:379392791,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896174,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:7792348,Map-Reduce Framework.Map output bytes:181657856,Map-Reduce Framework.CPU time spent (ms):72570,Map-Reduce Framework.Total committed heap usage (bytes):1053753344,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1672,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1298710528,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3750748160,Map-Reduce Framework.Map output records:3896174" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982872891"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"3"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982872892"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:34,901 Stage-2 map = 100%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:330860,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982874902"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"4"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982874902"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:35,907 Stage-2 map = 100%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:330860,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982875907"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"5"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982875908"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:36,913 Stage-2 map = 100%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:330860,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982876913"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"10"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982876914"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:37,919 Stage-2 map = 100%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:330860,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982877920"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"13"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982877921"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:39,930 Stage-2 map = 100%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:330860,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982879930"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"20"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982879932"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:40,937 Stage-2 map = 100%,  reduce = 41%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:339507,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982880937"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"41"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982880938"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:41,942 Stage-2 map = 100%,  reduce = 46%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:346891,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237168373,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:474259099,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):98240,Map-Reduce Framework.Total committed heap usage (bytes):1407123456,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1727332352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4978786304,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982881943"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"46"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982881943"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:42,948 Stage-2 map = 100%,  reduce = 53%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:346891,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:498016109,FileSystemCounters.HDFS_BYTES_WRITTEN:3339,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:23675535,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):100620,Map-Reduce Framework.Total committed heap usage (bytes):1528102912,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:359,Map-Reduce Framework.Reduce input groups:157,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1857908736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5619544064,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982882948"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"53"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982882949"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:44,958 Stage-2 map = 100%,  reduce = 56%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237184757,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:544630782,FileSystemCounters.HDFS_BYTES_WRITTEN:3339,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:94692898,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):108040,Map-Reduce Framework.Total committed heap usage (bytes):1918828544,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:359,Map-Reduce Framework.Reduce input groups:157,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2239541248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7513251840,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982884958"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"56"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982884959"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:45,964 Stage-2 map = 100%,  reduce = 60%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237184757,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:544630782,FileSystemCounters.HDFS_BYTES_WRITTEN:3339,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:94692898,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):108040,Map-Reduce Framework.Total committed heap usage (bytes):1918828544,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:359,Map-Reduce Framework.Reduce input groups:157,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2239541248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7513251840,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982885964"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"60"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982885965"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:46,970 Stage-2 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237344501,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:568395323,FileSystemCounters.HDFS_BYTES_WRITTEN:68847,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:118375964,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):111940,Map-Reduce Framework.Total committed heap usage (bytes):2039808000,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3663,Map-Reduce Framework.Reduce input groups:1588,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2362671104,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8140443648,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982886970"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"71"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982886971"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:47,975 Stage-2 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237344501,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:568395323,FileSystemCounters.HDFS_BYTES_WRITTEN:68847,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:118375964,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):111940,Map-Reduce Framework.Total committed heap usage (bytes):2039808000,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3663,Map-Reduce Framework.Reduce input groups:1588,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2362671104,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8140443648,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982887976"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"72"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982887976"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:49,011 Stage-2 map = 100%,  reduce = 75%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:6934,FileSystemCounters.FILE_BYTES_READ:237344501,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:568395323,FileSystemCounters.HDFS_BYTES_WRITTEN:68847,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:118375964,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):111940,Map-Reduce Framework.Total committed heap usage (bytes):2039808000,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3663,Map-Reduce Framework.Reduce input groups:1588,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2362671104,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8140443648,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982889011"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"75"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982889012"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:50,017 Stage-2 map = 100%,  reduce = 79%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:38605,FileSystemCounters.FILE_BYTES_READ:261007706,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:568395323,FileSystemCounters.HDFS_BYTES_WRITTEN:9946770,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:118375964,Map-Reduce Framework.Spilled Records:10226882,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):115330,Map-Reduce Framework.Total committed heap usage (bytes):2039808000,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:490200,Map-Reduce Framework.Reduce input groups:211276,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2364592128,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8140443648,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982890017"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"79"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982890018"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:51,022 Stage-2 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:69024,FileSystemCounters.FILE_BYTES_READ:284672887,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:592142020,FileSystemCounters.HDFS_BYTES_WRITTEN:19822071,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:142041187,Map-Reduce Framework.Spilled Records:10713572,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):123180,Map-Reduce Framework.Total committed heap usage (bytes):2188574720,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:976890,Map-Reduce Framework.Reduce input groups:420994,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2523348992,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8775352320,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982891023"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"83"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982891023"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:52,028 Stage-2 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:135192,FileSystemCounters.FILE_BYTES_READ:332036599,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:639668765,FileSystemCounters.HDFS_BYTES_WRITTEN:39578469,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:189404983,Map-Reduce Framework.Spilled Records:11687640,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):136470,Map-Reduce Framework.Total committed heap usage (bytes):2430533632,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:1950958,Map-Reduce Framework.Reduce input groups:840557,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2770964480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10028032000,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982892028"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"84"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982892029"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:53,036 Stage-2 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:168553,FileSystemCounters.FILE_BYTES_READ:355699455,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:663413137,FileSystemCounters.HDFS_BYTES_WRITTEN:49453058,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:12174279,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):144930,Map-Reduce Framework.Total committed heap usage (bytes):2551513088,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2437597,Map-Reduce Framework.Reduce input groups:1050262,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2906025984,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982893036"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"87"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982893037"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:54,042 Stage-2 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:168553,FileSystemCounters.FILE_BYTES_READ:355699455,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:663413137,FileSystemCounters.HDFS_BYTES_WRITTEN:49453058,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:12174279,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):144930,Map-Reduce Framework.Total committed heap usage (bytes):2551513088,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2437597,Map-Reduce Framework.Reduce input groups:1050262,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2906025984,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982894042"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"90"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982894043"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:56,052 Stage-2 map = 100%,  reduce = 93%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:205279,FileSystemCounters.FILE_BYTES_READ:379317992,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:663413137,FileSystemCounters.HDFS_BYTES_WRITTEN:59337493,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:12660100,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):150350,Map-Reduce Framework.Total committed heap usage (bytes):2551513088,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:2923418,Map-Reduce Framework.Reduce input groups:1260177,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2938208256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982896052"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"93"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982896053"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:54:57,058 Stage-2 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:279602,FileSystemCounters.FILE_BYTES_READ:426570431,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:677402423,FileSystemCounters.HDFS_BYTES_WRITTEN:79055522,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:13635160,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):161230,Map-Reduce Framework.Total committed heap usage (bytes):2551513088,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3895174,Map-Reduce Framework.Reduce input groups:1678884,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2950840320,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982897058"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"96"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982897059"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:00,106 Stage-2 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:279602,FileSystemCounters.FILE_BYTES_READ:426570431,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:677402423,FileSystemCounters.HDFS_BYTES_WRITTEN:79055522,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:13635160,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):161230,Map-Reduce Framework.Total committed heap usage (bytes):2551513088,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:3895174,Map-Reduce Framework.Reduce input groups:1678884,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2950840320,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982900107"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"98"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982900107"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:03,122 Stage-2 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:324447,FileSystemCounters.FILE_BYTES_READ:450235876,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:688060251,FileSystemCounters.HDFS_BYTES_WRITTEN:88932637,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:213067881,Map-Reduce Framework.Spilled Records:14121868,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):167650,Map-Reduce Framework.Total committed heap usage (bytes):2579300352,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4381882,Map-Reduce Framework.Reduce input groups:1888644,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2956931072,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10667778048,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982903122"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"99"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982903123"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:04,128 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:368273,FileSystemCounters.FILE_BYTES_READ:473969767,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:711875659,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:236801814,Map-Reduce Framework.Spilled Records:14609979,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):175830,Map-Reduce Framework.Total committed heap usage (bytes):2728067072,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4869993,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3116085248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11290247168,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982904129"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982904129"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982915262"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982915313"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 21:55:04,128 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:355420,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:368273,FileSystemCounters.FILE_BYTES_READ:473969767,FileSystemCounters.HDFS_BYTES_READ:258818748,FileSystemCounters.FILE_BYTES_WRITTEN:711875659,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:236801814,Map-Reduce Framework.Spilled Records:14609979,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):175830,Map-Reduce Framework.Total committed heap usage (bytes):2728067072,Map-Reduce Framework.Map input bytes:51784510,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2162,Map-Reduce Framework.Reduce input records:4869993,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3116085248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11290247168,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0032" TIME="1337982915313"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982915313"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982915315"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:24,902 Stage-3 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:4711,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982924902"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982924903"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:33,942 Stage-3 map = 33%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:13616,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.HDFS_BYTES_READ:9875022,FileSystemCounters.FILE_BYTES_WRITTEN:10697886,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:209705,Map-Reduce Framework.Physical memory (bytes) snapshot:197795840,Map-Reduce Framework.Spilled Records:209705,Map-Reduce Framework.Map output bytes:10196843,Map-Reduce Framework.CPU time spent (ms):7330,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:616529920,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:209705,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982933942"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"33"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982933943"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:35,954 Stage-3 map = 40%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:24594,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:31897651,FileSystemCounters.HDFS_BYTES_READ:39545282,FileSystemCounters.FILE_BYTES_WRITTEN:74574803,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:839783,Map-Reduce Framework.Physical memory (bytes) snapshot:398344192,Map-Reduce Framework.Spilled Records:1469861,Map-Reduce Framework.Map output bytes:40834320,Map-Reduce Framework.CPU time spent (ms):16680,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1227726848,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:839783,Map-Reduce Framework.SPLIT_RAW_BYTES:692" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982935955"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"40"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982935955"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:38,969 Stage-3 map = 70%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:24594,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:31897651,FileSystemCounters.HDFS_BYTES_READ:39545282,FileSystemCounters.FILE_BYTES_WRITTEN:74574803,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:839783,Map-Reduce Framework.Physical memory (bytes) snapshot:398344192,Map-Reduce Framework.Spilled Records:1469861,Map-Reduce Framework.Map output bytes:40834320,Map-Reduce Framework.CPU time spent (ms):16680,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1227726848,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:839783,Map-Reduce Framework.SPLIT_RAW_BYTES:692" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982938969"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"70"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982938970"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:39,975 Stage-3 map = 77%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:24594,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:31897651,FileSystemCounters.HDFS_BYTES_READ:39545282,FileSystemCounters.FILE_BYTES_WRITTEN:74574803,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:839783,Map-Reduce Framework.Physical memory (bytes) snapshot:398344192,Map-Reduce Framework.Spilled Records:1469861,Map-Reduce Framework.Map output bytes:40834320,Map-Reduce Framework.CPU time spent (ms):16680,Map-Reduce Framework.Total committed heap usage (bytes):353370112,Map-Reduce Framework.Virtual memory (bytes) snapshot:1227726848,Map-Reduce Framework.Map input bytes:19766387,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:839783,Map-Reduce Framework.SPLIT_RAW_BYTES:692" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982939975"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"77"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982939976"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:42,989 Stage-3 map = 93%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58446,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:53143481,FileSystemCounters.HDFS_BYTES_READ:69189249,FileSystemCounters.FILE_BYTES_WRITTEN:127853144,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1469303,Map-Reduce Framework.Physical memory (bytes) snapshot:817635328,Map-Reduce Framework.Spilled Records:2519056,Map-Reduce Framework.Map output bytes:71444524,Map-Reduce Framework.CPU time spent (ms):36140,Map-Reduce Framework.Total committed heap usage (bytes):706740224,Map-Reduce Framework.Virtual memory (bytes) snapshot:2463440896,Map-Reduce Framework.Map input bytes:29643502,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1469303,Map-Reduce Framework.SPLIT_RAW_BYTES:1283" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982942990"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-3_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982942990"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:46,004 Stage-3 map = 100%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:78871,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:85019208,FileSystemCounters.HDFS_BYTES_READ:98839109,FileSystemCounters.FILE_BYTES_WRITTEN:191686214,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1034498048,Map-Reduce Framework.Spilled Records:3778350,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):49820,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3078180864,Map-Reduce Framework.Map input bytes:49399332,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:1730" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982946005"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982946005"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:52,091 Stage-3 map = 100%,  reduce = 67%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:78871,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:85019208,FileSystemCounters.HDFS_BYTES_READ:98839109,FileSystemCounters.FILE_BYTES_WRITTEN:191686214,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1034498048,Map-Reduce Framework.Spilled Records:3778350,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):49820,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3078180864,Map-Reduce Framework.Map input bytes:49399332,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:1730" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982952091"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"67","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982952092"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:55,105 Stage-3 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:78871,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:85019208,FileSystemCounters.HDFS_BYTES_READ:98839109,FileSystemCounters.FILE_BYTES_WRITTEN:191686214,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1034498048,Map-Reduce Framework.Spilled Records:3778350,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):49820,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3078180864,Map-Reduce Framework.Map input bytes:49399332,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:1730" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982955106"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"94","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982955106"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:55:56,111 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:78871,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:21568,FileSystemCounters.FILE_BYTES_READ:191278053,FileSystemCounters.HDFS_BYTES_READ:98839109,FileSystemCounters.FILE_BYTES_WRITTEN:298026575,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258869,Map-Reduce Framework.Spilled Records:5877300,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):59140,Map-Reduce Framework.Total committed heap usage (bytes):1071185920,Map-Reduce Framework.Map input bytes:49399332,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1730,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1244495872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3704180736,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982956111"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982956112"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982960134"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982960183"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 21:55:56,111 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:78871,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:5,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:21568,FileSystemCounters.FILE_BYTES_READ:191278053,FileSystemCounters.HDFS_BYTES_READ:98839109,FileSystemCounters.FILE_BYTES_WRITTEN:298026575,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258869,Map-Reduce Framework.Spilled Records:5877300,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):59140,Map-Reduce Framework.Total committed heap usage (bytes):1071185920,Map-Reduce Framework.Map input bytes:49399332,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1730,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1244495872,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3704180736,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0036" TIME="1337982960183"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982960183"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982960185"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:56:05,965 Stage-4 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:1965,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0038" TIME="1337982965965"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982965966"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:56:08,979 Stage-4 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5077,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:81682,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:196395008,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):780,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:663830528,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0038" TIME="1337982968980"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982968980"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 21:56:17,127 Stage-4 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5077,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:81682,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:196395008,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):780,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:663830528,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0038" TIME="1337982977127"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982977128"
TaskProgress ROWS_INSERTED="rankings_uservisits_join~1" TASK_HADOOP_PROGRESS="2012-05-25 21:56:18,135 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5077,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8682,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163253,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1770,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:293900288,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1339326464,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0038" TIME="1337982978135"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982978136"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982980153"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982980204"
TaskEnd ROWS_INSERTED="rankings_uservisits_join~1" TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 21:56:18,135 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5077,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8682,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163253,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1770,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:293900288,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1339326464,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TASK_HADOOP_ID="job_201205252023_0038" TIME="1337982980208"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982980208"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982980208"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337982980424"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982980424"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982980424"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"}" TIME="1337982980425"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"}" TIME="1337982980856"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" TIME="1337982980856"
QueryEnd ROWS_INSERTED="rankings_uservisits_join~1" QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f" QUERY_RET_CODE="0" QUERY_NUM_TASKS="4" TIME="1337982980856"
Counters plan="{"queryId":"ubuntu_20120525214141_c6de4f27-c640-4afc-a5d2-0a62447d324f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"}" TIME="1337982980857"
