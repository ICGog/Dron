SessionStart SESSION_ID="ubuntu_201205252329" TIME="1337988572529"
QueryStart QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337988586579"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988586656"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337988586659"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988586682"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:30:11,042 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988611042"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988611044"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:31:11,339 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988671340"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988671341"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:32:11,640 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988731641"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988731642"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:33:11,919 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988791920"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988791922"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:34:12,375 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988852376"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988852378"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:35:12,650 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988912650"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988912653"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:36:13,234 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:15752" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337988973235"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988973237"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:36:55,438 Stage-1 map = 3%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:40626,Job Counters .Rack-local map tasks:31,Job Counters .Launched map tasks:86,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056643,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:429518848,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):10250,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Virtual memory (bytes) snapshot:1245073408,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989015440"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"3"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989015442"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:36:56,448 Stage-1 map = 4%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:40626,Job Counters .Rack-local map tasks:31,Job Counters .Launched map tasks:86,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:134226302,FileSystemCounters.FILE_BYTES_WRITTEN:3056643,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1029428,Map-Reduce Framework.Physical memory (bytes) snapshot:429518848,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:2827633,Map-Reduce Framework.CPU time spent (ms):10250,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Virtual memory (bytes) snapshot:1245073408,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:32583,Map-Reduce Framework.SPLIT_RAW_BYTES:380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989016451"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"4"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989016453"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:36:58,468 Stage-1 map = 5%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:67086,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:532040159,FileSystemCounters.FILE_BYTES_WRITTEN:5085942,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:4287296,Map-Reduce Framework.Physical memory (bytes) snapshot:1914839040,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:32708415,Map-Reduce Framework.CPU time spent (ms):44650,Map-Reduce Framework.Total committed heap usage (bytes):1617952768,Map-Reduce Framework.Virtual memory (bytes) snapshot:5739110400,Map-Reduce Framework.Map input bytes:134217728,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:452869,Map-Reduce Framework.SPLIT_RAW_BYTES:2516" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989018468"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"5"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989018471"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:36:59,476 Stage-1 map = 7%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:67086,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:532040159,FileSystemCounters.FILE_BYTES_WRITTEN:5085942,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:4287296,Map-Reduce Framework.Physical memory (bytes) snapshot:1914839040,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:32708415,Map-Reduce Framework.CPU time spent (ms):44650,Map-Reduce Framework.Total committed heap usage (bytes):1617952768,Map-Reduce Framework.Virtual memory (bytes) snapshot:5739110400,Map-Reduce Framework.Map input bytes:134217728,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:452869,Map-Reduce Framework.SPLIT_RAW_BYTES:2516" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989019476"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"7"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989019479"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:01,490 Stage-1 map = 10%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:67086,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:1174183347,FileSystemCounters.FILE_BYTES_WRITTEN:6310128,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:9320705,Map-Reduce Framework.Physical memory (bytes) snapshot:5151412224,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:51194951,Map-Reduce Framework.CPU time spent (ms):130190,Map-Reduce Framework.Total committed heap usage (bytes):4296015872,Map-Reduce Framework.Virtual memory (bytes) snapshot:15418281984,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:682778,Map-Reduce Framework.SPLIT_RAW_BYTES:7576" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989021490"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"10"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989021493"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:02,498 Stage-1 map = 11%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:67086,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:1479791770,FileSystemCounters.FILE_BYTES_WRITTEN:6718193,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:11690156,Map-Reduce Framework.Physical memory (bytes) snapshot:6238875648,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:57668532,Map-Reduce Framework.CPU time spent (ms):161800,Map-Reduce Framework.Total committed heap usage (bytes):5207228416,Map-Reduce Framework.Virtual memory (bytes) snapshot:18583535616,Map-Reduce Framework.Map input bytes:402653184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:757215,Map-Reduce Framework.SPLIT_RAW_BYTES:9336" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989022499"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"11"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989022501"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:03,506 Stage-1 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:67086,Job Counters .Rack-local map tasks:32,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:98030,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1494867,FileSystemCounters.HDFS_BYTES_READ:1479791770,FileSystemCounters.FILE_BYTES_WRITTEN:6718193,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:11690156,Map-Reduce Framework.Physical memory (bytes) snapshot:6238875648,Map-Reduce Framework.Spilled Records:49015,Map-Reduce Framework.Map output bytes:57668532,Map-Reduce Framework.CPU time spent (ms):161800,Map-Reduce Framework.Total committed heap usage (bytes):5207228416,Map-Reduce Framework.Virtual memory (bytes) snapshot:18583535616,Map-Reduce Framework.Map input bytes:402653184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:757215,Map-Reduce Framework.SPLIT_RAW_BYTES:9336" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989023507"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"13"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989023509"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:04,515 Stage-1 map = 15%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:99024,Job Counters .Rack-local map tasks:33,Job Counters .Launched map tasks:88,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:196194,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2989594,FileSystemCounters.HDFS_BYTES_READ:1854115342,FileSystemCounters.FILE_BYTES_WRITTEN:11662619,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:14601598,Map-Reduce Framework.Physical memory (bytes) snapshot:7713423360,Map-Reduce Framework.Spilled Records:98097,Map-Reduce Framework.Map output bytes:65683427,Map-Reduce Framework.CPU time spent (ms):197230,Map-Reduce Framework.Total committed heap usage (bytes):6499598336,Map-Reduce Framework.Virtual memory (bytes) snapshot:23092576256,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:849377,Map-Reduce Framework.SPLIT_RAW_BYTES:11746" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989024515"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"15"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989024518"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:05,523 Stage-1 map = 18%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:116222,Job Counters .Rack-local map tasks:34,Job Counters .Launched map tasks:89,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:228554,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:3488353,FileSystemCounters.HDFS_BYTES_READ:1921228493,FileSystemCounters.FILE_BYTES_WRITTEN:13175497,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:15116537,Map-Reduce Framework.Physical memory (bytes) snapshot:7926370304,Map-Reduce Framework.Spilled Records:114277,Map-Reduce Framework.Map output bytes:67082023,Map-Reduce Framework.CPU time spent (ms):202540,Map-Reduce Framework.Total committed heap usage (bytes):6676283392,Map-Reduce Framework.Virtual memory (bytes) snapshot:23711694848,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:865557,Map-Reduce Framework.SPLIT_RAW_BYTES:11936" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989025523"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"18"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989025526"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:06,535 Stage-1 map = 22%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:116222,Job Counters .Rack-local map tasks:34,Job Counters .Launched map tasks:89,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:228554,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:3488353,FileSystemCounters.HDFS_BYTES_READ:1921228493,FileSystemCounters.FILE_BYTES_WRITTEN:13175497,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:15116537,Map-Reduce Framework.Physical memory (bytes) snapshot:7926370304,Map-Reduce Framework.Spilled Records:114277,Map-Reduce Framework.Map output bytes:67082023,Map-Reduce Framework.CPU time spent (ms):202540,Map-Reduce Framework.Total committed heap usage (bytes):6676283392,Map-Reduce Framework.Virtual memory (bytes) snapshot:23711694848,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:865557,Map-Reduce Framework.SPLIT_RAW_BYTES:11936" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989026535"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"22"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989026538"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:07,543 Stage-1 map = 25%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:116222,Job Counters .Rack-local map tasks:34,Job Counters .Launched map tasks:89,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:228554,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:3488353,FileSystemCounters.HDFS_BYTES_READ:2293523317,FileSystemCounters.FILE_BYTES_WRITTEN:31486110,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:18300522,Map-Reduce Framework.Physical memory (bytes) snapshot:8831344640,Map-Reduce Framework.Spilled Records:376421,Map-Reduce Framework.Map output bytes:113487170,Map-Reduce Framework.CPU time spent (ms):235830,Map-Reduce Framework.Total committed heap usage (bytes):7436566528,Map-Reduce Framework.Virtual memory (bytes) snapshot:26271559680,Map-Reduce Framework.Map input bytes:872415232,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1537068,Map-Reduce Framework.SPLIT_RAW_BYTES:13120" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989027544"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"25"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989027546"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:08,552 Stage-1 map = 28%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:151451,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:358590,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:5482321,FileSystemCounters.HDFS_BYTES_READ:2462999415,FileSystemCounters.FILE_BYTES_WRITTEN:37261200,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:19594846,Map-Reduce Framework.Physical memory (bytes) snapshot:8833363968,Map-Reduce Framework.Spilled Records:441439,Map-Reduce Framework.Map output bytes:117025177,Map-Reduce Framework.CPU time spent (ms):239400,Map-Reduce Framework.Total committed heap usage (bytes):7436566528,Map-Reduce Framework.Virtual memory (bytes) snapshot:26271559680,Map-Reduce Framework.Map input bytes:1006632960,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1577894,Map-Reduce Framework.SPLIT_RAW_BYTES:13120" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989028552"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"28"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989028554"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:09,560 Stage-1 map = 31%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:221978,Job Counters .Rack-local map tasks:37,Job Counters .Launched map tasks:92,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:553454,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:8473228,FileSystemCounters.HDFS_BYTES_READ:2770183387,FileSystemCounters.FILE_BYTES_WRITTEN:45991171,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:21942637,Map-Reduce Framework.Physical memory (bytes) snapshot:9046568960,Map-Reduce Framework.Spilled Records:538871,Map-Reduce Framework.Map output bytes:123436299,Map-Reduce Framework.CPU time spent (ms):252100,Map-Reduce Framework.Total committed heap usage (bytes):7613251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:26903941120,Map-Reduce Framework.Map input bytes:1207959552,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1651782,Map-Reduce Framework.SPLIT_RAW_BYTES:13472" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989029560"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"31"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989029563"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:10,568 Stage-1 map = 34%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:254887,Job Counters .Rack-local map tasks:38,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:651804,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:9968244,FileSystemCounters.HDFS_BYTES_READ:2919695581,FileSystemCounters.FILE_BYTES_WRITTEN:50373172,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:23084275,Map-Reduce Framework.Physical memory (bytes) snapshot:9046712320,Map-Reduce Framework.Spilled Records:588046,Map-Reduce Framework.Map output bytes:126614632,Map-Reduce Framework.CPU time spent (ms):256420,Map-Reduce Framework.Total committed heap usage (bytes):7613251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:26903941120,Map-Reduce Framework.Map input bytes:1342177280,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1688210,Map-Reduce Framework.SPLIT_RAW_BYTES:13472" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989030568"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"34"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989030588"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:11,599 Stage-1 map = 37%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:322870,Job Counters .Rack-local map tasks:40,Job Counters .Launched map tasks:95,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:911516,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:13956211,FileSystemCounters.HDFS_BYTES_READ:3388233283,FileSystemCounters.FILE_BYTES_WRITTEN:61989816,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:26669971,Map-Reduce Framework.Physical memory (bytes) snapshot:9266319360,Map-Reduce Framework.Spilled Records:717902,Map-Reduce Framework.Map output bytes:136422611,Map-Reduce Framework.CPU time spent (ms):270480,Map-Reduce Framework.Total committed heap usage (bytes):7789936640,Map-Reduce Framework.Virtual memory (bytes) snapshot:27532939264,Map-Reduce Framework.Map input bytes:1677721600,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1801186,Map-Reduce Framework.SPLIT_RAW_BYTES:13824" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989031599"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"37"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989031601"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:12,606 Stage-1 map = 40%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:358598,Job Counters .Rack-local map tasks:41,Job Counters .Launched map tasks:96,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1041042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:15950804,FileSystemCounters.HDFS_BYTES_READ:3656685479,FileSystemCounters.FILE_BYTES_WRITTEN:67829582,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:28729327,Map-Reduce Framework.Physical memory (bytes) snapshot:9482526720,Map-Reduce Framework.Spilled Records:782665,Map-Reduce Framework.Map output bytes:142050930,Map-Reduce Framework.CPU time spent (ms):280260,Map-Reduce Framework.Total committed heap usage (bytes):7966621696,Map-Reduce Framework.Virtual memory (bytes) snapshot:28222959616,Map-Reduce Framework.Map input bytes:1879048192,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1865949,Map-Reduce Framework.SPLIT_RAW_BYTES:14176" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989032607"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"40"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989032608"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:13,613 Stage-1 map = 42%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:358598,Job Counters .Rack-local map tasks:41,Job Counters .Launched map tasks:96,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1041042,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:15950804,FileSystemCounters.HDFS_BYTES_READ:3656685479,FileSystemCounters.FILE_BYTES_WRITTEN:67829582,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:28729327,Map-Reduce Framework.Physical memory (bytes) snapshot:9482526720,Map-Reduce Framework.Spilled Records:782665,Map-Reduce Framework.Map output bytes:142050930,Map-Reduce Framework.CPU time spent (ms):280260,Map-Reduce Framework.Total committed heap usage (bytes):7966621696,Map-Reduce Framework.Virtual memory (bytes) snapshot:28222959616,Map-Reduce Framework.Map input bytes:1879048192,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1865949,Map-Reduce Framework.SPLIT_RAW_BYTES:14176" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989033614"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"42"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989033615"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:14,620 Stage-1 map = 46%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:377815,Job Counters .Rack-local map tasks:42,Job Counters .Launched map tasks:97,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1106074,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:16947645,FileSystemCounters.HDFS_BYTES_READ:4176702794,FileSystemCounters.FILE_BYTES_WRITTEN:71125787,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:32776415,Map-Reduce Framework.Physical memory (bytes) snapshot:10582818816,Map-Reduce Framework.Spilled Records:815181,Map-Reduce Framework.Map output bytes:156720160,Map-Reduce Framework.CPU time spent (ms):317090,Map-Reduce Framework.Total committed heap usage (bytes):8850046976,Map-Reduce Framework.Virtual memory (bytes) snapshot:31452512256,Map-Reduce Framework.Map input bytes:2281701376,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2047919,Map-Reduce Framework.SPLIT_RAW_BYTES:15608" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989034620"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"46"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989034621"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:15,629 Stage-1 map = 47%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:411534,Job Counters .Rack-local map tasks:43,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:55,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1235858,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:18941881,FileSystemCounters.HDFS_BYTES_READ:4445154990,FileSystemCounters.FILE_BYTES_WRITTEN:76978133,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:34835543,Map-Reduce Framework.Physical memory (bytes) snapshot:10794131456,Map-Reduce Framework.Spilled Records:880073,Map-Reduce Framework.Map output bytes:162360800,Map-Reduce Framework.CPU time spent (ms):326930,Map-Reduce Framework.Total committed heap usage (bytes):9024700416,Map-Reduce Framework.Virtual memory (bytes) snapshot:32076541952,Map-Reduce Framework.Map input bytes:2483027968,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2112811,Map-Reduce Framework.SPLIT_RAW_BYTES:15960" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989035629"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"47"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989035631"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:16,636 Stage-1 map = 49%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:485091,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:100,Job Counters .Data-local map tasks:56,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1365794,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:20936091,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:5520291585,FileSystemCounters.FILE_BYTES_WRITTEN:235389374,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:43501795,Map-Reduce Framework.Physical memory (bytes) snapshot:12077674496,Map-Reduce Framework.Spilled Records:3163711,Map-Reduce Framework.Map output bytes:236019155,Map-Reduce Framework.CPU time spent (ms):379110,Map-Reduce Framework.Total committed heap usage (bytes):10112598016,Map-Reduce Framework.Virtual memory (bytes) snapshot:35821432832,Map-Reduce Framework.Map input bytes:3355443200,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3143250,Map-Reduce Framework.SPLIT_RAW_BYTES:18072" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989036636"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"49"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989036637"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:17,642 Stage-1 map = 53%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:644442,Job Counters .Rack-local map tasks:47,Job Counters .Launched map tasks:104,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1883874,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:28913308,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6383326988,FileSystemCounters.FILE_BYTES_WRITTEN:258418594,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:50107378,Map-Reduce Framework.Physical memory (bytes) snapshot:12103004160,Map-Reduce Framework.Spilled Records:3422751,Map-Reduce Framework.Map output bytes:254073963,Map-Reduce Framework.CPU time spent (ms):402140,Map-Reduce Framework.Total committed heap usage (bytes):10112598016,Map-Reduce Framework.Virtual memory (bytes) snapshot:35821432832,Map-Reduce Framework.Map input bytes:4093640704,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3351061,Map-Reduce Framework.SPLIT_RAW_BYTES:18072" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989037642"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"53"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989037643"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:18,651 Stage-1 map = 56%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:685356,Job Counters .Rack-local map tasks:48,Job Counters .Launched map tasks:105,Job Counters .Data-local map tasks:57,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2013876,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:30906719,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6844414240,FileSystemCounters.FILE_BYTES_WRITTEN:246307081,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:53292457,Map-Reduce Framework.Physical memory (bytes) snapshot:12326465536,Map-Reduce Framework.Spilled Records:3225608,Map-Reduce Framework.Map output bytes:220426576,Map-Reduce Framework.CPU time spent (ms):411840,Map-Reduce Framework.Total committed heap usage (bytes):10289283072,Map-Reduce Framework.Virtual memory (bytes) snapshot:36535169024,Map-Reduce Framework.Map input bytes:4429185024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2808841,Map-Reduce Framework.SPLIT_RAW_BYTES:18598" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989038651"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"56"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989038652"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:19,658 Stage-1 map = 58%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:902141,Job Counters .Rack-local map tasks:50,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:60,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2662988,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:40878609,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:7836113548,FileSystemCounters.FILE_BYTES_WRITTEN:275263726,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:60875067,Map-Reduce Framework.Physical memory (bytes) snapshot:12596523008,Map-Reduce Framework.Spilled Records:3550164,Map-Reduce Framework.Map output bytes:241214169,Map-Reduce Framework.CPU time spent (ms):443260,Map-Reduce Framework.Total committed heap usage (bytes):10493755392,Map-Reduce Framework.Virtual memory (bytes) snapshot:37164122112,Map-Reduce Framework.Map input bytes:5167382528,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3047988,Map-Reduce Framework.SPLIT_RAW_BYTES:18950" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989039658"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"58"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989039659"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:20,707 Stage-1 map = 63%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1168468,Job Counters .Rack-local map tasks:56,Job Counters .Launched map tasks:117,Job Counters .Data-local map tasks:61,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3443170,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:52841887,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:9148910942,FileSystemCounters.FILE_BYTES_WRITTEN:310091464,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:70926256,Map-Reduce Framework.Physical memory (bytes) snapshot:13036294144,Map-Reduce Framework.Spilled Records:3940255,Map-Reduce Framework.Map output bytes:268815496,Map-Reduce Framework.CPU time spent (ms):485170,Map-Reduce Framework.Total committed heap usage (bytes):10845093888,Map-Reduce Framework.Virtual memory (bytes) snapshot:38441549824,Map-Reduce Framework.Map input bytes:6241124352,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3365770,Map-Reduce Framework.SPLIT_RAW_BYTES:19654" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989040708"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"63"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989040708"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:21,714 Stage-1 map = 64%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1206613,Job Counters .Rack-local map tasks:57,Job Counters .Launched map tasks:118,Job Counters .Data-local map tasks:61,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3540952,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:54337088,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:9258601823,FileSystemCounters.FILE_BYTES_WRITTEN:314433104,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:71760134,Map-Reduce Framework.Physical memory (bytes) snapshot:13038522368,Map-Reduce Framework.Spilled Records:3989146,Map-Reduce Framework.Map output bytes:271103720,Map-Reduce Framework.CPU time spent (ms):488750,Map-Reduce Framework.Total committed heap usage (bytes):10845093888,Map-Reduce Framework.Virtual memory (bytes) snapshot:38441549824,Map-Reduce Framework.Map input bytes:6308233216,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3392190,Map-Reduce Framework.SPLIT_RAW_BYTES:19654" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989041714"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"64"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989041715"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:22,720 Stage-1 map = 67%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1314280,Job Counters .Rack-local map tasks:59,Job Counters .Launched map tasks:121,Job Counters .Data-local map tasks:62,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3805726,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:58380242,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:9699360313,FileSystemCounters.FILE_BYTES_WRITTEN:326292142,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:75128180,Map-Reduce Framework.Physical memory (bytes) snapshot:13241929728,Map-Reduce Framework.Spilled Records:4121533,Map-Reduce Framework.Map output bytes:280394290,Map-Reduce Framework.CPU time spent (ms):504610,Map-Reduce Framework.Total committed heap usage (bytes):11021778944,Map-Reduce Framework.Virtual memory (bytes) snapshot:39073464320,Map-Reduce Framework.Map input bytes:6710886400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3498955,Map-Reduce Framework.SPLIT_RAW_BYTES:19844" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989042720"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"67"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989042721"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:23,726 Stage-1 map = 69%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1495264,Job Counters .Rack-local map tasks:61,Job Counters .Launched map tasks:123,Job Counters .Data-local map tasks:62,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4326758,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:66355933,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:11330368397,FileSystemCounters.FILE_BYTES_WRITTEN:435653571,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:88360216,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:5640380,Map-Reduce Framework.Map output bytes:404672021,Map-Reduce Framework.CPU time spent (ms):576760,Map-Reduce Framework.Total committed heap usage (bytes):11877351424,Map-Reduce Framework.Map input bytes:7985954816,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21186,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14272475136,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42281447424,Map-Reduce Framework.Map output records:5250997" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989043727"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"69"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989043728"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:24,733 Stage-1 map = 72%,  reduce = 7%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1548405,Job Counters .Rack-local map tasks:61,Job Counters .Launched map tasks:124,Job Counters .Data-local map tasks:63,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4456630,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:68350052,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:11458171790,FileSystemCounters.FILE_BYTES_WRITTEN:441431882,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:89336541,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:5705316,Map-Reduce Framework.Map output bytes:407356077,Map-Reduce Framework.CPU time spent (ms):580130,Map-Reduce Framework.Total committed heap usage (bytes):11877351424,Map-Reduce Framework.Map input bytes:8053063680,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21186,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14274596864,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42281447424,Map-Reduce Framework.Map output records:5281873" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989044733"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"7","CNTR_NAME_Stage-1_MAP_PROGRESS":"72"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989044734"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:25,742 Stage-1 map = 75%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1690528,Job Counters .Rack-local map tasks:64,Job Counters .Launched map tasks:128,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4846850,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:74332330,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:12097651958,FileSystemCounters.FILE_BYTES_WRITTEN:458850980,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:94235552,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:5900426,Map-Reduce Framework.Map output bytes:420785196,Map-Reduce Framework.CPU time spent (ms):603130,Map-Reduce Framework.Total committed heap usage (bytes):12081823744,Map-Reduce Framework.Map input bytes:8522825728,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21538,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14520344576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42919153664,Map-Reduce Framework.Map output records:5436493" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989045742"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"75"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989045743"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:26,749 Stage-1 map = 77%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1863373,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5300610,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:81312462,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:12552484091,FileSystemCounters.FILE_BYTES_WRITTEN:479041078,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:97713070,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:6127306,Map-Reduce Framework.Map output bytes:430300474,Map-Reduce Framework.CPU time spent (ms):617300,Map-Reduce Framework.Total committed heap usage (bytes):12081823744,Map-Reduce Framework.Map input bytes:8858370048,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21538,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14530150400,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42919153664,Map-Reduce Framework.Map output records:5545963" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989046749"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"77"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989046750"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:27,756 Stage-1 map = 80%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1963735,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5561100,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:85300689,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:12865737983,FileSystemCounters.FILE_BYTES_WRITTEN:490627273,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:100104309,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:6257551,Map-Reduce Framework.Map output bytes:436845614,Map-Reduce Framework.CPU time spent (ms):627160,Map-Reduce Framework.Total committed heap usage (bytes):12109611008,Map-Reduce Framework.Map input bytes:9126805504,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21538,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14554853376,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42919153664,Map-Reduce Framework.Map output records:5621147" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989047756"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"80"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989047757"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:29,772 Stage-1 map = 82%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2266557,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6406132,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:98263247,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:14593244396,FileSystemCounters.FILE_BYTES_WRITTEN:528672314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:113352109,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:6680067,Map-Reduce Framework.Map output bytes:473180522,Map-Reduce Framework.CPU time spent (ms):704130,Map-Reduce Framework.Total committed heap usage (bytes):13197508608,Map-Reduce Framework.Map input bytes:10401873920,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23542,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15872851968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:46864658432,Map-Reduce Framework.Map output records:6039360" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989049772"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"82"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989049774"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:30,779 Stage-1 map = 84%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2456081,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6924716,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:106240208,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:15667053180,FileSystemCounters.FILE_BYTES_WRITTEN:552060570,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:121588362,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:6939359,Map-Reduce Framework.Map output bytes:495722509,Map-Reduce Framework.CPU time spent (ms):751630,Map-Reduce Framework.Total committed heap usage (bytes):13904248832,Map-Reduce Framework.Map input bytes:11207180288,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24950,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16744792064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:49499705344,Map-Reduce Framework.Map output records:6298652" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989050780"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"84"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989050781"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:31,786 Stage-1 map = 85%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2621827,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7313868,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:112222724,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:16351400581,FileSystemCounters.FILE_BYTES_WRITTEN:569348613,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:126822021,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:7133935,Map-Reduce Framework.Map output bytes:510044593,Map-Reduce Framework.CPU time spent (ms):770580,Map-Reduce Framework.Total committed heap usage (bytes):13932036096,Map-Reduce Framework.Map input bytes:11811160064,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24950,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16797904896,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:49499705344,Map-Reduce Framework.Map output records:6463629" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989051786"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"85"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989051787"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:32,792 Stage-1 map = 86%,  reduce = 17%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2726972,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7574012,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:116210413,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:16689976298,FileSystemCounters.FILE_BYTES_WRITTEN:581000254,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:129417197,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:7264007,Map-Reduce Framework.Map output bytes:517158337,Map-Reduce Framework.CPU time spent (ms):786150,Map-Reduce Framework.Total committed heap usage (bytes):14108721152,Map-Reduce Framework.Map input bytes:12079595520,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25302,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17026371584,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50187177984,Map-Reduce Framework.Map output records:6545427" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989052792"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"17","CNTR_NAME_Stage-1_MAP_PROGRESS":"86"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989052793"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:33,798 Stage-1 map = 87%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2783870,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7703462,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:118205165,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:16958428494,FileSystemCounters.FILE_BYTES_WRITTEN:586825908,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:131476674,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:7328732,Map-Reduce Framework.Map output bytes:522772619,Map-Reduce Framework.CPU time spent (ms):797790,Map-Reduce Framework.Total committed heap usage (bytes):14313193472,Map-Reduce Framework.Map input bytes:12280922112,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25654,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17260453888,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50826276864,Map-Reduce Framework.Map output records:6610152" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989053799"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"87"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989053800"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:34,805 Stage-1 map = 88%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2841613,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7833688,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:120199134,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:17071813967,FileSystemCounters.FILE_BYTES_WRITTEN:592618519,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:132346006,Map-Reduce Framework.Reduce shuffle bytes:19478429,Map-Reduce Framework.Spilled Records:7393845,Map-Reduce Framework.Map output bytes:525174543,Map-Reduce Framework.CPU time spent (ms):800390,Map-Reduce Framework.Total committed heap usage (bytes):14313193472,Map-Reduce Framework.Map input bytes:12348030976,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25654,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17260625920,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50826276864,Map-Reduce Framework.Map output records:6637719" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989054805"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"88"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989054806"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:35,813 Stage-1 map = 89%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3023090,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8222942,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:126180878,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:18231515872,FileSystemCounters.FILE_BYTES_WRITTEN:610326093,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:141252037,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:7588472,Map-Reduce Framework.Map output bytes:549518463,Map-Reduce Framework.CPU time spent (ms):856460,Map-Reduce Framework.Total committed heap usage (bytes):15140913152,Map-Reduce Framework.Map input bytes:13220446208,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27062,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18270699520,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53988188160,Map-Reduce Framework.Map output records:6917846" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989055813"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"89"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989055814"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:36,819 Stage-1 map = 90%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3146862,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8481180,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:130169926,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:18455366371,FileSystemCounters.FILE_BYTES_WRITTEN:621818117,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:142956479,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:7717591,Map-Reduce Framework.Map output bytes:554173631,Map-Reduce Framework.CPU time spent (ms):864260,Map-Reduce Framework.Total committed heap usage (bytes):15140913152,Map-Reduce Framework.Map input bytes:13421772800,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27062,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18272350208,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53988188160,Map-Reduce Framework.Map output records:6971418" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989056820"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989056821"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:37,826 Stage-1 map = 91%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3384280,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9001466,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:138146595,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:19376975279,FileSystemCounters.FILE_BYTES_WRITTEN:645128165,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:150023846,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:7977734,Map-Reduce Framework.Map output bytes:573578493,Map-Reduce Framework.CPU time spent (ms):903280,Map-Reduce Framework.Total committed heap usage (bytes):15549857792,Map-Reduce Framework.Map input bytes:14092861440,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27766,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18760040448,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:55368388608,Map-Reduce Framework.Map output records:7194569" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989057826"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"21","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989057827"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:38,833 Stage-1 map = 91%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3506648,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9261420,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142134557,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:19622157981,FileSystemCounters.FILE_BYTES_WRITTEN:710709670,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152497489,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:8894141,Map-Reduce Framework.Map output bytes:651493225,Map-Reduce Framework.CPU time spent (ms):922600,Map-Reduce Framework.Total committed heap usage (bytes):15726542848,Map-Reduce Framework.Map input bytes:14227079168,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28002,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18995920896,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56077557760,Map-Reduce Framework.Map output records:8351744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989058833"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989058834"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:39,853 Stage-1 map = 91%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3521202,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9261420,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142134557,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:19622157981,FileSystemCounters.FILE_BYTES_WRITTEN:710709670,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152497489,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:8894141,Map-Reduce Framework.Map output bytes:651493225,Map-Reduce Framework.CPU time spent (ms):922600,Map-Reduce Framework.Total committed heap usage (bytes):15726542848,Map-Reduce Framework.Map input bytes:14227079168,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28002,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18995920896,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56077557760,Map-Reduce Framework.Map output records:8351744" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989059854"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989059855"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:40,861 Stage-1 map = 93%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3588310,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9390966,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144128027,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:19890610177,FileSystemCounters.FILE_BYTES_WRITTEN:716550620,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:154555732,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:8958914,Map-Reduce Framework.Map output bytes:657122708,Map-Reduce Framework.CPU time spent (ms):936410,Map-Reduce Framework.Total committed heap usage (bytes):15903227904,Map-Reduce Framework.Map input bytes:14428405760,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28354,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19216109568,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:56694886400,Map-Reduce Framework.Map output records:8416517" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989060861"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989060862"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:42,872 Stage-1 map = 96%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3810675,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9650762,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148115682,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:20408545474,FileSystemCounters.FILE_BYTES_WRITTEN:880318766,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159101076,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:11307870,Map-Reduce Framework.Map output bytes:740387898,Map-Reduce Framework.CPU time spent (ms):971640,Map-Reduce Framework.Total committed heap usage (bytes):16107700224,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28540,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19482529792,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57326284800,Map-Reduce Framework.Map output records:9634452" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989062873"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989062874"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:43,879 Stage-1 map = 96%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3878535,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:20495081667,FileSystemCounters.FILE_BYTES_WRITTEN:886103692,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159764874,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:11372984,Map-Reduce Framework.Map output bytes:742225342,Map-Reduce Framework.CPU time spent (ms):975050,Map-Reduce Framework.Total committed heap usage (bytes):16107700224,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28540,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19482689536,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57326284800,Map-Reduce Framework.Map output records:9655576" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989063879"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"26","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989063880"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:44,886 Stage-1 map = 96%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3885057,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:20495081667,FileSystemCounters.FILE_BYTES_WRITTEN:886103692,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159764874,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:11372984,Map-Reduce Framework.Map output bytes:742225342,Map-Reduce Framework.CPU time spent (ms):975050,Map-Reduce Framework.Total committed heap usage (bytes):16107700224,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28540,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19482689536,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57326284800,Map-Reduce Framework.Map output records:9655576" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989064886"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"27","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989064887"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:45,894 Stage-1 map = 96%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3892267,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:20495081667,FileSystemCounters.FILE_BYTES_WRITTEN:886103692,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159764874,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:11372984,Map-Reduce Framework.Map output bytes:742225342,Map-Reduce Framework.CPU time spent (ms):975050,Map-Reduce Framework.Total committed heap usage (bytes):16107700224,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28540,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19482689536,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57326284800,Map-Reduce Framework.Map output records:9655576" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989065895"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989065896"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:46,901 Stage-1 map = 96%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3906816,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:20495081667,FileSystemCounters.FILE_BYTES_WRITTEN:886103692,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:159764874,Map-Reduce Framework.Reduce shuffle bytes:49182525,Map-Reduce Framework.Spilled Records:11372984,Map-Reduce Framework.Map output bytes:742225342,Map-Reduce Framework.CPU time spent (ms):975050,Map-Reduce Framework.Total committed heap usage (bytes):16107700224,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28540,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19482689536,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57326284800,Map-Reduce Framework.Map output records:9655576" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989066901"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989066902"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:49,921 Stage-1 map = 96%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4073297,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304632938,FileSystemCounters.HDFS_BYTES_READ:20722307692,FileSystemCounters.FILE_BYTES_WRITTEN:1280625717,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:163506290,Map-Reduce Framework.Reduce shuffle bytes:156834169,Map-Reduce Framework.Spilled Records:17118009,Map-Reduce Framework.Map output bytes:991451651,Map-Reduce Framework.CPU time spent (ms):1021980,Map-Reduce Framework.Total committed heap usage (bytes):16781344768,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28962,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20253794304,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:59917889536,Map-Reduce Framework.Map output records:13396794" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989069922"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989069923"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:52,940 Stage-1 map = 98%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4143645,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:380787632,FileSystemCounters.HDFS_BYTES_READ:20789420839,FileSystemCounters.FILE_BYTES_WRITTEN:1432841347,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:164614987,Map-Reduce Framework.Reduce shuffle bytes:156834169,Map-Reduce Framework.Spilled Records:19335403,Map-Reduce Framework.Map output bytes:1065300961,Map-Reduce Framework.CPU time spent (ms):1034370,Map-Reduce Framework.Total committed heap usage (bytes):16958029824,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29148,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20472180736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60549214208,Map-Reduce Framework.Map output records:14505491" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989072941"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989072943"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:54,953 Stage-1 map = 98%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4143645,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:380787632,FileSystemCounters.HDFS_BYTES_READ:20789420839,FileSystemCounters.FILE_BYTES_WRITTEN:1432841347,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:164614987,Map-Reduce Framework.Reduce shuffle bytes:156834169,Map-Reduce Framework.Spilled Records:19335403,Map-Reduce Framework.Map output bytes:1065300961,Map-Reduce Framework.CPU time spent (ms):1034370,Map-Reduce Framework.Total committed heap usage (bytes):16958029824,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29148,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20472180736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60549214208,Map-Reduce Framework.Map output records:14505491" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989074953"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989074954"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:37:55,962 Stage-1 map = 99%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4143645,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:380787632,FileSystemCounters.HDFS_BYTES_READ:20789420839,FileSystemCounters.FILE_BYTES_WRITTEN:1432841347,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:164614987,Map-Reduce Framework.Reduce shuffle bytes:156834169,Map-Reduce Framework.Spilled Records:19335403,Map-Reduce Framework.Map output bytes:1065300961,Map-Reduce Framework.CPU time spent (ms):1034370,Map-Reduce Framework.Total committed heap usage (bytes):16958029824,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29148,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20472180736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60549214208,Map-Reduce Framework.Map output records:14505491" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989075962"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"99"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989075963"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:07,060 Stage-1 map = 100%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4428044,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:826295559,FileSystemCounters.HDFS_BYTES_READ:21087103207,FileSystemCounters.FILE_BYTES_WRITTEN:2233638711,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169522712,Map-Reduce Framework.Reduce shuffle bytes:623044481,Map-Reduce Framework.Spilled Records:30999954,Map-Reduce Framework.Map output bytes:1392074694,Map-Reduce Framework.CPU time spent (ms):1122000,Map-Reduce Framework.Total committed heap usage (bytes):18633195520,Map-Reduce Framework.Map input bytes:15032385536,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22273654784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66388369408,Map-Reduce Framework.Map output records:19413205" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989087060"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989087061"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:08,066 Stage-1 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4428044,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:826295559,FileSystemCounters.HDFS_BYTES_READ:21087103207,FileSystemCounters.FILE_BYTES_WRITTEN:2233638711,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169522712,Map-Reduce Framework.Reduce shuffle bytes:623044481,Map-Reduce Framework.Spilled Records:30999954,Map-Reduce Framework.Map output bytes:1392074694,Map-Reduce Framework.CPU time spent (ms):1122000,Map-Reduce Framework.Total committed heap usage (bytes):18633195520,Map-Reduce Framework.Map input bytes:15032385536,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22273654784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66388369408,Map-Reduce Framework.Map output records:19413205" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989088066"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989088067"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:12,090 Stage-1 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4446867,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:826295559,FileSystemCounters.HDFS_BYTES_READ:21087103207,FileSystemCounters.FILE_BYTES_WRITTEN:2233638711,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169522712,Map-Reduce Framework.Reduce shuffle bytes:623044481,Map-Reduce Framework.Spilled Records:30999954,Map-Reduce Framework.Map output bytes:1392074694,Map-Reduce Framework.CPU time spent (ms):1122000,Map-Reduce Framework.Total committed heap usage (bytes):18633195520,Map-Reduce Framework.Map input bytes:15032385536,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22273654784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66388369408,Map-Reduce Framework.Map output records:19413205" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989092090"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989092091"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:36,278 Stage-1 map = 100%,  reduce = 37%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989116279"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"37","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989116279"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:37,285 Stage-1 map = 100%,  reduce = 40%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989117285"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"40","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989117286"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:39,296 Stage-1 map = 100%,  reduce = 54%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:11,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989119297"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"54","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989119298"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:40,303 Stage-1 map = 100%,  reduce = 61%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989120303"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"61","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989120304"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:42,314 Stage-1 map = 100%,  reduce = 69%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989122315"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"69","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989122316"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:43,322 Stage-1 map = 100%,  reduce = 70%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989123322"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"70","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989123323"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:45,334 Stage-1 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989125334"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"71","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989125335"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:46,348 Stage-1 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989126348"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"72","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989126349"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:47,355 Stage-1 map = 100%,  reduce = 73%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3111081817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:879067114,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1161250,Map-Reduce Framework.Total committed heap usage (bytes):18771804160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22526365696,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989127355"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"73","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989127356"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:48,362 Stage-1 map = 100%,  reduce = 75%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1317230978,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3275168418,FileSystemCounters.HDFS_BYTES_WRITTEN:5946827,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:994317969,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1172930,Map-Reduce Framework.Total committed heap usage (bytes):18837274624,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:523180,Map-Reduce Framework.Reduce input groups:523181,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22641479680,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989128362"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"75","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989128363"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:49,371 Stage-1 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:15752,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1317230978,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3275168418,FileSystemCounters.HDFS_BYTES_WRITTEN:5946827,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:994317969,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1172930,Map-Reduce Framework.Total committed heap usage (bytes):18837274624,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:523180,Map-Reduce Framework.Reduce input groups:523181,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22641479680,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989129371"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"77","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989129372"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:51,385 Stage-1 map = 100%,  reduce = 80%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:121764,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1484812281,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3603299637,FileSystemCounters.HDFS_BYTES_WRITTEN:31758768,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1189814209,Map-Reduce Framework.Spilled Records:43340960,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1197940,Map-Reduce Framework.Total committed heap usage (bytes):18805686272,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2819244,Map-Reduce Framework.Reduce input groups:2819245,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22752706560,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989131386"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"80","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989131387"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:54,642 Stage-1 map = 100%,  reduce = 82%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:339607,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1812895395,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3842344818,FileSystemCounters.HDFS_BYTES_WRITTEN:83469661,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1280029009,Map-Reduce Framework.Spilled Records:47835294,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232400,Map-Reduce Framework.Total committed heap usage (bytes):18783535104,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7313578,Map-Reduce Framework.Reduce input groups:7313579,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22802087936,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989134642"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"82","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989134643"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:55,648 Stage-1 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:339607,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1812895395,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3842344818,FileSystemCounters.HDFS_BYTES_WRITTEN:83469661,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1280029009,Map-Reduce Framework.Spilled Records:47835294,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232400,Map-Reduce Framework.Total committed heap usage (bytes):18783535104,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7313578,Map-Reduce Framework.Reduce input groups:7313579,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22802087936,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989135648"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"83","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989135649"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:57,661 Stage-1 map = 100%,  reduce = 85%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:339607,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1812895395,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3842344818,FileSystemCounters.HDFS_BYTES_WRITTEN:83469661,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1280029009,Map-Reduce Framework.Spilled Records:47835294,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232400,Map-Reduce Framework.Total committed heap usage (bytes):18783535104,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7313578,Map-Reduce Framework.Reduce input groups:7313579,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22802087936,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989137661"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"85","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989137662"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:38:58,667 Stage-1 map = 100%,  reduce = 86%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:339607,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1812895395,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3842344818,FileSystemCounters.HDFS_BYTES_WRITTEN:83469661,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1280029009,Map-Reduce Framework.Spilled Records:47835294,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1232400,Map-Reduce Framework.Total committed heap usage (bytes):18783535104,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:7313578,Map-Reduce Framework.Reduce input groups:7313579,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22802087936,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989138667"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"86","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989138668"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:00,679 Stage-1 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1973246444,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4006260666,FileSystemCounters.HDFS_BYTES_WRITTEN:108802567,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1362415904,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1253180,Map-Reduce Framework.Total committed heap usage (bytes):18736087040,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:9510564,Map-Reduce Framework.Reduce input groups:9510564,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22824366080,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989140679"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"87","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989140680"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:01,686 Stage-1 map = 100%,  reduce = 88%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2084293100,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4170185009,FileSystemCounters.HDFS_BYTES_WRITTEN:126293991,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1452491738,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1269770,Map-Reduce Framework.Total committed heap usage (bytes):18738970624,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:11034077,Map-Reduce Framework.Reduce input groups:11034077,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22904033280,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989141687"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"88","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989141696"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:03,708 Stage-1 map = 100%,  reduce = 89%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2156476908,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4334389685,FileSystemCounters.HDFS_BYTES_WRITTEN:137613468,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1535149203,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1284510,Map-Reduce Framework.Total committed heap usage (bytes):18730647552,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12022340,Map-Reduce Framework.Reduce input groups:12022340,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22982352896,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989143708"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"89","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989143710"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:05,722 Stage-1 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2214308332,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4498544695,FileSystemCounters.HDFS_BYTES_WRITTEN:146652279,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617715706,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1299000,Map-Reduce Framework.Total committed heap usage (bytes):18724618240,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12816653,Map-Reduce Framework.Reduce input groups:12816653,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23051636736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989145722"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"90","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989145723"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:06,729 Stage-1 map = 100%,  reduce = 91%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2214308332,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4498544695,FileSystemCounters.HDFS_BYTES_WRITTEN:146652279,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617715706,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1299000,Map-Reduce Framework.Total committed heap usage (bytes):18724618240,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12816653,Map-Reduce Framework.Reduce input groups:12816653,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23051636736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989146729"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"91","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989146730"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:07,736 Stage-1 map = 100%,  reduce = 92%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:453997,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2214308332,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4498544695,FileSystemCounters.HDFS_BYTES_WRITTEN:146652279,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617715706,Map-Reduce Framework.Spilled Records:50082651,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1299000,Map-Reduce Framework.Total committed heap usage (bytes):18724618240,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12816653,Map-Reduce Framework.Reduce input groups:12816653,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23051636736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66453979136,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989147736"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"92","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989147737"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:08,742 Stage-1 map = 100%,  reduce = 93%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:482597,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2378287801,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:172522536,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:52328241,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1309270,Map-Reduce Framework.Total committed heap usage (bytes):18685362176,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:15062243,Map-Reduce Framework.Reduce input groups:15062243,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23031283712,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66452275200,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989148743"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"93","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989148744"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:09,749 Stage-1 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:607157,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2470308669,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:187118206,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:54577202,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1315590,Map-Reduce Framework.Total committed heap usage (bytes):18695192576,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:16322941,Map-Reduce Framework.Reduce input groups:16322941,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23025397760,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66452275200,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989149750"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"94","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989149751"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:10,757 Stage-1 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:732263,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2523186356,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:195484751,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56821673,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1319650,Map-Reduce Framework.Total committed heap usage (bytes):18698600448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17043899,Map-Reduce Framework.Reduce input groups:17043899,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23025733632,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66452275200,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989150757"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"95","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989150758"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:13,810 Stage-1 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:732263,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2523186356,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:195484751,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56821673,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1319650,Map-Reduce Framework.Total committed heap usage (bytes):18698600448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17043899,Map-Reduce Framework.Reduce input groups:17043899,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23025733632,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66452275200,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989153811"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"96","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989153811"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:16,827 Stage-1 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:737979,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2523186356,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:195484751,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:56821673,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1319650,Map-Reduce Framework.Total committed heap usage (bytes):18698600448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17043899,Map-Reduce Framework.Reduce input groups:17043899,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23025733632,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66452275200,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989156827"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"98","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989156828"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:18,839 Stage-1 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:775466,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2683736272,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:221451805,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:59071056,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1325860,Map-Reduce Framework.Total committed heap usage (bytes):18622840832,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:19242388,Map-Reduce Framework.Reduce input groups:19242388,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23019638784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66448666624,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989158839"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"99","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989158840"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:20,851 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:909970,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2790059858,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:238268140,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:61318357,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1333090,Map-Reduce Framework.Total committed heap usage (bytes):18629132288,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20695376,Map-Reduce Framework.Reduce input groups:20695376,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23018520576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66448666624,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989160851"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989160852"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989165885"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989165939"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:39:20,851 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4622924,Job Counters .Rack-local map tasks:65,Job Counters .Launched map tasks:129,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:909970,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2790059858,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989167,FileSystemCounters.HDFS_BYTES_WRITTEN:238268140,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:61318357,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1333090,Map-Reduce Framework.Total committed heap usage (bytes):18629132288,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20695376,Map-Reduce Framework.Reduce input groups:20695376,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:23018520576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66448666624,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0105" TIME="1337989165939"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989165939"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989165941"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:39:34,519 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2522" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989174519"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989174520"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:40:34,792 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2522" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989234792"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989234793"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:35,081 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989295081"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989295082"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:44,159 Stage-2 map = 17%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.HDFS_BYTES_READ:2859944,FileSystemCounters.FILE_BYTES_WRITTEN:81595,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:56558,Map-Reduce Framework.Physical memory (bytes) snapshot:206548992,Map-Reduce Framework.Spilled Records:0,Map-Reduce Framework.Map output bytes:2637102,Map-Reduce Framework.CPU time spent (ms):6270,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:632401920,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:56558,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989304159"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"17","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989304160"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:45,165 Stage-2 map = 50%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:22246,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:9,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:23675501,FileSystemCounters.HDFS_BYTES_READ:25838578,FileSystemCounters.FILE_BYTES_WRITTEN:47363017,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:486193,Map-Reduce Framework.Physical memory (bytes) snapshot:215384064,Map-Reduce Framework.Spilled Records:972386,Map-Reduce Framework.Map output bytes:22668111,Map-Reduce Framework.CPU time spent (ms):13720,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:632401920,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:486193,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989305165"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"50","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989305166"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:52,197 Stage-2 map = 58%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:45242,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:9,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:47430757,FileSystemCounters.HDFS_BYTES_READ:51751391,FileSystemCounters.FILE_BYTES_WRITTEN:94861848,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:973768,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:1947536,Map-Reduce Framework.Map output bytes:45401365,Map-Reduce Framework.CPU time spent (ms):25040,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:490,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:431796224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1241833472,Map-Reduce Framework.Map output records:973768" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989312197"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"58","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989312198"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:53,203 Stage-2 map = 75%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:45242,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:47430757,FileSystemCounters.HDFS_BYTES_READ:51751391,FileSystemCounters.FILE_BYTES_WRITTEN:94861848,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:973768,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:1947536,Map-Reduce Framework.Map output bytes:45401365,Map-Reduce Framework.CPU time spent (ms):25040,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:490,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:431796224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1241833472,Map-Reduce Framework.Map output records:973768" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989313203"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"1"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989313204"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:54,209 Stage-2 map = 75%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:45242,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:47430757,FileSystemCounters.HDFS_BYTES_READ:51751391,FileSystemCounters.FILE_BYTES_WRITTEN:94861848,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:973768,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:1947536,Map-Reduce Framework.Map output bytes:45401365,Map-Reduce Framework.CPU time spent (ms):25040,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:490,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:431796224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1241833472,Map-Reduce Framework.Map output records:973768" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989314209"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"4"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989314210"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:55,215 Stage-2 map = 75%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:77957,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:94861818,FileSystemCounters.HDFS_BYTES_READ:103522406,FileSystemCounters.FILE_BYTES_WRITTEN:189677953,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1947898,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3895796,Map-Reduce Framework.Map output bytes:90820086,Map-Reduce Framework.CPU time spent (ms):41770,Map-Reduce Framework.Total committed heap usage (bytes):585629696,Map-Reduce Framework.Map input bytes:25915147,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:836,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:660606976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1876582400,Map-Reduce Framework.Map output records:1947898" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989315215"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"8"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989315216"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:56,220 Stage-2 map = 83%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:77957,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:94861818,FileSystemCounters.HDFS_BYTES_READ:103522406,FileSystemCounters.FILE_BYTES_WRITTEN:189677953,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1947898,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3895796,Map-Reduce Framework.Map output bytes:90820086,Map-Reduce Framework.CPU time spent (ms):41770,Map-Reduce Framework.Total committed heap usage (bytes):585629696,Map-Reduce Framework.Map input bytes:25915147,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:836,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:660606976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1876582400,Map-Reduce Framework.Map output records:1947898" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989316220"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"83","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"8"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989316221"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:57,226 Stage-2 map = 92%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:112648,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:142275019,FileSystemCounters.HDFS_BYTES_READ:155266133,FileSystemCounters.FILE_BYTES_WRITTEN:284444178,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2921516,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:5843032,Map-Reduce Framework.Map output bytes:136214891,Map-Reduce Framework.CPU time spent (ms):60360,Map-Reduce Framework.Total committed heap usage (bytes):762314752,Map-Reduce Framework.Map input bytes:51785404,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1182,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:883154944,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:2513604608,Map-Reduce Framework.Map output records:2921516" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989317226"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"11"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989317227"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:41:58,231 Stage-2 map = 100%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:182182,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:237172517,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:474097032,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9740022,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):95080,Map-Reduce Framework.Total committed heap usage (bytes):1115684864,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1336328192,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3832500224,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989318231"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"11"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989318232"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:00,242 Stage-2 map = 100%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:182182,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:237172517,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:474097032,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9740022,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):95080,Map-Reduce Framework.Total committed heap usage (bytes):1115684864,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1336328192,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3832500224,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989320242"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"12"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989320243"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:02,253 Stage-2 map = 100%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:237172517,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:474423093,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:47366818,Map-Reduce Framework.Spilled Records:9740022,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):99230,Map-Reduce Framework.Total committed heap usage (bytes):1599602688,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1729097728,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:6453022720,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989322253"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"13"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989322254"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:03,260 Stage-2 map = 100%,  reduce = 17%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:237172517,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:474504609,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:71096153,Map-Reduce Framework.Spilled Records:9740022,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):99870,Map-Reduce Framework.Total committed heap usage (bytes):1720582144,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1823870976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7084048384,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989323260"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"17"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989323261"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:04,306 Stage-2 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:12,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:2522,FileSystemCounters.FILE_BYTES_READ:237172517,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:474504609,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:71096153,Map-Reduce Framework.Spilled Records:9740022,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):99870,Map-Reduce Framework.Total committed heap usage (bytes):1720582144,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1823870976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7084048384,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989324306"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"32"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989324307"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:05,353 Stage-2 map = 100%,  reduce = 49%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:16,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:61443,FileSystemCounters.FILE_BYTES_READ:308250388,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:545745512,FileSystemCounters.HDFS_BYTES_WRITTEN:29660652,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:118402017,Map-Reduce Framework.Spilled Records:11201795,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):119710,Map-Reduce Framework.Total committed heap usage (bytes):1962541056,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:1461773,Map-Reduce Framework.Reduce input groups:629898,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2120183808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8413564928,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989325353"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"49"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989325354"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:06,388 Stage-2 map = 100%,  reduce = 61%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:17,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:61443,FileSystemCounters.FILE_BYTES_READ:308250388,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:545745512,FileSystemCounters.HDFS_BYTES_WRITTEN:29660652,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:118402017,Map-Reduce Framework.Spilled Records:11201795,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):119710,Map-Reduce Framework.Total committed heap usage (bytes):1962541056,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:1461773,Map-Reduce Framework.Reduce input groups:629898,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2120183808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8413564928,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989326389"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"61"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989326390"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:07,395 Stage-2 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:17,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:104773,FileSystemCounters.FILE_BYTES_READ:355591403,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:593168043,FileSystemCounters.HDFS_BYTES_WRITTEN:49417215,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:156271339,Map-Reduce Framework.Spilled Records:12175388,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):131770,Map-Reduce Framework.Total committed heap usage (bytes):2109997056,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:2435366,Map-Reduce Framework.Reduce input groups:1049461,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2264809472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9084534784,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989327395"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"71"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989327396"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:08,401 Stage-2 map = 100%,  reduce = 86%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:18,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:175987,FileSystemCounters.FILE_BYTES_READ:426712536,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:664370692,FileSystemCounters.HDFS_BYTES_WRITTEN:79075195,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:213163020,Map-Reduce Framework.Spilled Records:13638052,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):151700,Map-Reduce Framework.Total committed heap usage (bytes):2258763776,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:3898030,Map-Reduce Framework.Reduce input groups:1679307,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2440445952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9768484864,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989328401"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"86"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989328402"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:09,410 Stage-2 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:18,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:175987,FileSystemCounters.FILE_BYTES_READ:426712536,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:664370692,FileSystemCounters.HDFS_BYTES_WRITTEN:79075195,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:213163020,Map-Reduce Framework.Spilled Records:13638052,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):151700,Map-Reduce Framework.Total committed heap usage (bytes):2258763776,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:3898030,Map-Reduce Framework.Reduce input groups:1679307,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2440445952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9768484864,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989329410"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"98"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989329411"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:10,419 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:18,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:229837,FileSystemCounters.FILE_BYTES_READ:473974785,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:711714457,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:236802568,Map-Reduce Framework.Spilled Records:14610033,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):165390,Map-Reduce Framework.Total committed heap usage (bytes):2379743232,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:4870011,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2569408512,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10450612224,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989330419"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989330420"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989336513"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989336601"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:42:10,419 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:18,Job Counters .SLOTS_MILLIS_MAPS:189936,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:10,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:229837,FileSystemCounters.FILE_BYTES_READ:473974785,FileSystemCounters.HDFS_BYTES_READ:258819426,FileSystemCounters.FILE_BYTES_WRITTEN:711714457,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4870011,Map-Reduce Framework.Reduce shuffle bytes:236802568,Map-Reduce Framework.Spilled Records:14610033,Map-Reduce Framework.Map output bytes:227062186,Map-Reduce Framework.CPU time spent (ms):165390,Map-Reduce Framework.Total committed heap usage (bytes):2379743232,Map-Reduce Framework.Map input bytes:103455314,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:4870011,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2569408512,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10450612224,Map-Reduce Framework.Map output records:4870011" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0110" TIME="1337989336601"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989336601"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989336603"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:23,816 Stage-3 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2493,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989343817"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989343817"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:30,845 Stage-3 map = 71%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:38145,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.HDFS_BYTES_READ:49411364,FileSystemCounters.FILE_BYTES_WRITTEN:53528393,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1049292,Map-Reduce Framework.Physical memory (bytes) snapshot:1005223936,Map-Reduce Framework.Spilled Records:1049292,Map-Reduce Framework.Map output bytes:51021643,Map-Reduce Framework.CPU time spent (ms):37580,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3312730112,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1049292,Map-Reduce Framework.SPLIT_RAW_BYTES:1225" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989350845"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"71"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989350846"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:31,851 Stage-3 map = 83%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:38145,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.HDFS_BYTES_READ:49411364,FileSystemCounters.FILE_BYTES_WRITTEN:53528393,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1049292,Map-Reduce Framework.Physical memory (bytes) snapshot:1005223936,Map-Reduce Framework.Spilled Records:1049292,Map-Reduce Framework.Map output bytes:51021643,Map-Reduce Framework.CPU time spent (ms):37580,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3312730112,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1049292,Map-Reduce Framework.SPLIT_RAW_BYTES:1225" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989351851"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"83"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989351852"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:32,857 Stage-3 map = 90%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:47429,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:21253068,FileSystemCounters.HDFS_BYTES_READ:69180406,FileSystemCounters.FILE_BYTES_WRITTEN:96116151,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1469104,Map-Reduce Framework.Physical memory (bytes) snapshot:1216180224,Map-Reduce Framework.Spilled Records:1888916,Map-Reduce Framework.Map output bytes:71435075,Map-Reduce Framework.CPU time spent (ms):47030,Map-Reduce Framework.Total committed heap usage (bytes):1060110336,Map-Reduce Framework.Virtual memory (bytes) snapshot:3933794304,Map-Reduce Framework.Map input bytes:9875301,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1469104,Map-Reduce Framework.SPLIT_RAW_BYTES:1571" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989352857"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989352858"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:34,867 Stage-3 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58603,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:53138642,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:159968914,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1421119488,Map-Reduce Framework.Spilled Records:3148608,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):58840,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4613529600,Map-Reduce Framework.Map input bytes:29630419,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989354867"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989354868"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:38,920 Stage-3 map = 100%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58603,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:53138642,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:159968914,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1421119488,Map-Reduce Framework.Spilled Records:3148608,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):58840,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4613529600,Map-Reduce Framework.Map input bytes:29630419,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989358921"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989358921"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:41,935 Stage-3 map = 100%,  reduce = 67%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58603,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:53138642,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:159968914,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1421119488,Map-Reduce Framework.Spilled Records:3148608,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):58840,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4613529600,Map-Reduce Framework.Map input bytes:29630419,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989361936"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"67","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989361936"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:44,951 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58603,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:53138642,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:159968914,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1421119488,Map-Reduce Framework.Spilled Records:3148608,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):58840,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4613529600,Map-Reduce Framework.Map input bytes:29630419,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989364951"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989364952"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989367970"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989368019"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:42:44,951 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:58603,Job Counters .Rack-local map tasks:4,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:3,FileSystemCounters.FILE_BYTES_READ:53138642,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:159968914,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1421119488,Map-Reduce Framework.Spilled Records:3148608,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):58840,Map-Reduce Framework.Total committed heap usage (bytes):1236795392,Map-Reduce Framework.Virtual memory (bytes) snapshot:4613529600,Map-Reduce Framework.Map input bytes:29630419,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0113" TIME="1337989368019"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989368019"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989368021"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:53,132 Stage-4 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:1755,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0114" TIME="1337989373133"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989373133"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:42:55,143 Stage-4 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4017,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:81680,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:195371008,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):740,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:675729408,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0114" TIME="1337989375143"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989375144"
TaskProgress ROWS_INSERTED="rankings_uservisits_join~1" TASK_HADOOP_PROGRESS="2012-05-25 23:43:03,270 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4017,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8223,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163249,FileSystemCounters.HDFS_BYTES_WRITTEN:48,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1830,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:291553280,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1301876736,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0114" TIME="1337989383271"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989383271"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989385285"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989385335"
TaskEnd ROWS_INSERTED="rankings_uservisits_join~1" TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:43:03,270 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4017,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8223,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163249,FileSystemCounters.HDFS_BYTES_WRITTEN:48,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1830,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:291553280,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1301876736,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TASK_HADOOP_ID="job_201205252023_0114" TIME="1337989385335"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989385336"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989385336"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337989385558"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989385558"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989385558"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"}" TIME="1337989385559"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"}" TIME="1337989385923"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" TIME="1337989385923"
QueryEnd ROWS_INSERTED="rankings_uservisits_join~1" QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f" QUERY_RET_CODE="0" QUERY_NUM_TASKS="4" TIME="1337989385923"
Counters plan="{"queryId":"ubuntu_20120525232929_fa51d98c-d382-48a1-b1dd-7b201445361f","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"}" TIME="1337989385924"
