SessionStart SESSION_ID="ubuntu_201205252231" TIME="1337985064411"
QueryStart QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985084106"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985084128"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985084131"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985084195"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:31:46,777 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:14380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985106777"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985106778"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:32:47,060 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:23,Job Counters .Data-local map tasks:17,Job Counters .SLOTS_MILLIS_REDUCES:14380" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985167061"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985167062"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:06,157 Stage-1 map = 1%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:21848,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:32496,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:498550,FileSystemCounters.HDFS_BYTES_READ:220378231,FileSystemCounters.FILE_BYTES_WRITTEN:1768939,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1706046,Map-Reduce Framework.Physical memory (bytes) snapshot:842936320,Map-Reduce Framework.Spilled Records:16248,Map-Reduce Framework.Map output bytes:4664051,Map-Reduce Framework.CPU time spent (ms):17220,Map-Reduce Framework.Total committed heap usage (bytes):704708608,Map-Reduce Framework.Virtual memory (bytes) snapshot:2462642176,Map-Reduce Framework.Map input bytes:67108864,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:53574,Map-Reduce Framework.SPLIT_RAW_BYTES:1138" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985186160"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"1"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985186161"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:07,167 Stage-1 map = 2%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:21848,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:32496,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:498550,FileSystemCounters.HDFS_BYTES_READ:220378231,FileSystemCounters.FILE_BYTES_WRITTEN:1768939,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1706046,Map-Reduce Framework.Physical memory (bytes) snapshot:842936320,Map-Reduce Framework.Spilled Records:16248,Map-Reduce Framework.Map output bytes:4664051,Map-Reduce Framework.CPU time spent (ms):17220,Map-Reduce Framework.Total committed heap usage (bytes):704708608,Map-Reduce Framework.Virtual memory (bytes) snapshot:2462642176,Map-Reduce Framework.Map input bytes:67108864,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:53574,Map-Reduce Framework.SPLIT_RAW_BYTES:1138" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985187172"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"2"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985187173"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:10,189 Stage-1 map = 4%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:42116,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:454388058,FileSystemCounters.FILE_BYTES_WRITTEN:3546302,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:3510942,Map-Reduce Framework.Physical memory (bytes) snapshot:1703141376,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:9611907,Map-Reduce Framework.CPU time spent (ms):36400,Map-Reduce Framework.Total committed heap usage (bytes):1407385600,Map-Reduce Framework.Virtual memory (bytes) snapshot:5079416832,Map-Reduce Framework.Map input bytes:134217728,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:110575,Map-Reduce Framework.SPLIT_RAW_BYTES:2384" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985190189"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"4"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985190191"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:13,207 Stage-1 map = 6%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:42116,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:635211840,FileSystemCounters.FILE_BYTES_WRITTEN:3954362,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:4913298,Map-Reduce Framework.Physical memory (bytes) snapshot:2738200576,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:13462602,Map-Reduce Framework.CPU time spent (ms):58930,Map-Reduce Framework.Total committed heap usage (bytes):2318598144,Map-Reduce Framework.Virtual memory (bytes) snapshot:8389480448,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:154840,Map-Reduce Framework.SPLIT_RAW_BYTES:4144" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985193207"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"6"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985193208"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:14,214 Stage-1 map = 7%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:42116,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:65166,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:996845,FileSystemCounters.HDFS_BYTES_READ:635211840,FileSystemCounters.FILE_BYTES_WRITTEN:3954362,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:4913298,Map-Reduce Framework.Physical memory (bytes) snapshot:2738200576,Map-Reduce Framework.Spilled Records:32583,Map-Reduce Framework.Map output bytes:13462602,Map-Reduce Framework.CPU time spent (ms):58930,Map-Reduce Framework.Total committed heap usage (bytes):2318598144,Map-Reduce Framework.Virtual memory (bytes) snapshot:8389480448,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:154840,Map-Reduce Framework.SPLIT_RAW_BYTES:4144" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985194214"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"7"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985194215"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:15,221 Stage-1 map = 9%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:59732,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:97526,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1495604,FileSystemCounters.HDFS_BYTES_READ:702324991,FileSystemCounters.FILE_BYTES_WRITTEN:5467236,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:5428237,Map-Reduce Framework.Physical memory (bytes) snapshot:2955194368,Map-Reduce Framework.Spilled Records:48763,Map-Reduce Framework.Map output bytes:14861198,Map-Reduce Framework.CPU time spent (ms):63770,Map-Reduce Framework.Total committed heap usage (bytes):2495283200,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:171020,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985195221"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"9"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985195222"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:16,229 Stage-1 map = 11%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:59732,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:97526,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1495604,FileSystemCounters.HDFS_BYTES_READ:702324991,FileSystemCounters.FILE_BYTES_WRITTEN:5467236,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:5428237,Map-Reduce Framework.Physical memory (bytes) snapshot:2955194368,Map-Reduce Framework.Spilled Records:48763,Map-Reduce Framework.Map output bytes:14861198,Map-Reduce Framework.CPU time spent (ms):63770,Map-Reduce Framework.Total committed heap usage (bytes):2495283200,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:171020,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985196229"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"11"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985196231"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:17,237 Stage-1 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:59732,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:97526,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:1495604,FileSystemCounters.HDFS_BYTES_READ:702324991,FileSystemCounters.FILE_BYTES_WRITTEN:5467236,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:5428237,Map-Reduce Framework.Physical memory (bytes) snapshot:2955194368,Map-Reduce Framework.Spilled Records:48763,Map-Reduce Framework.Map output bytes:14861198,Map-Reduce Framework.CPU time spent (ms):63770,Map-Reduce Framework.Total committed heap usage (bytes):2495283200,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:201326592,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:171020,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985197237"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"13"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985197238"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:18,278 Stage-1 map = 15%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:88013,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:162400,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2492752,FileSystemCounters.HDFS_BYTES_READ:831529216,FileSystemCounters.FILE_BYTES_WRITTEN:8355616,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6415418,Map-Reduce Framework.Physical memory (bytes) snapshot:2965262336,Map-Reduce Framework.Spilled Records:81200,Map-Reduce Framework.Map output bytes:17571589,Map-Reduce Framework.CPU time spent (ms):67840,Map-Reduce Framework.Total committed heap usage (bytes):2493251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:202168,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985198279"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"15"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985198280"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:19,286 Stage-1 map = 17%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:88013,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:162400,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2492752,FileSystemCounters.HDFS_BYTES_READ:831529216,FileSystemCounters.FILE_BYTES_WRITTEN:8355616,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6415418,Map-Reduce Framework.Physical memory (bytes) snapshot:2965262336,Map-Reduce Framework.Spilled Records:81200,Map-Reduce Framework.Map output bytes:17571589,Map-Reduce Framework.CPU time spent (ms):67840,Map-Reduce Framework.Total committed heap usage (bytes):2493251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:202168,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985199286"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"17"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985199287"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:20,293 Stage-1 map = 18%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:88013,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:162400,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:2492752,FileSystemCounters.HDFS_BYTES_READ:831529216,FileSystemCounters.FILE_BYTES_WRITTEN:8355616,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6415418,Map-Reduce Framework.Physical memory (bytes) snapshot:2965262336,Map-Reduce Framework.Spilled Records:81200,Map-Reduce Framework.Map output bytes:17571589,Map-Reduce Framework.CPU time spent (ms):67840,Map-Reduce Framework.Total committed heap usage (bytes):2493251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:268435456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:202168,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985200293"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"18"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985200295"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:21,300 Stage-1 map = 21%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:9,Job Counters .SLOTS_MILLIS_MAPS:124776,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:93,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:292240,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:4486620,FileSystemCounters.HDFS_BYTES_READ:1004765442,FileSystemCounters.FILE_BYTES_WRITTEN:14128573,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:7737913,Map-Reduce Framework.Physical memory (bytes) snapshot:2967629824,Map-Reduce Framework.Spilled Records:146120,Map-Reduce Framework.Map output bytes:21205986,Map-Reduce Framework.CPU time spent (ms):71640,Map-Reduce Framework.Total committed heap usage (bytes):2493251584,Map-Reduce Framework.Virtual memory (bytes) snapshot:9030311936,Map-Reduce Framework.Map input bytes:402653184,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:244040,Map-Reduce Framework.SPLIT_RAW_BYTES:4334" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985201300"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"21"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985201302"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:22,310 Stage-1 map = 24%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:158157,Job Counters .Rack-local map tasks:36,Job Counters .Launched map tasks:94,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:422144,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:6480763,FileSystemCounters.HDFS_BYTES_READ:1273217638,FileSystemCounters.FILE_BYTES_WRITTEN:19978959,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:9797008,Map-Reduce Framework.Physical memory (bytes) snapshot:3181248512,Map-Reduce Framework.Spilled Records:211072,Map-Reduce Framework.Map output bytes:26844550,Map-Reduce Framework.CPU time spent (ms):80560,Map-Reduce Framework.Total committed heap usage (bytes):2669936640,Map-Reduce Framework.Virtual memory (bytes) snapshot:9670508544,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:308992,Map-Reduce Framework.SPLIT_RAW_BYTES:4686" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985202310"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"24"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985202312"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:23,317 Stage-1 map = 27%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:262604,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:97,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:779786,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:11963866,FileSystemCounters.HDFS_BYTES_READ:1929520377,FileSystemCounters.FILE_BYTES_WRITTEN:36043192,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:14827090,Map-Reduce Framework.Physical memory (bytes) snapshot:3604197376,Map-Reduce Framework.Spilled Records:389893,Map-Reduce Framework.Map output bytes:40661109,Map-Reduce Framework.CPU time spent (ms):102240,Map-Reduce Framework.Total committed heap usage (bytes):3023306752,Map-Reduce Framework.Virtual memory (bytes) snapshot:10928287744,Map-Reduce Framework.Map input bytes:1073741824,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:467922,Map-Reduce Framework.SPLIT_RAW_BYTES:5336" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985203317"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"27"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985203319"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:24,324 Stage-1 map = 29%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:293517,Job Counters .Rack-local map tasks:40,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:812650,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:12461888,FileSystemCounters.HDFS_BYTES_READ:2179345213,FileSystemCounters.FILE_BYTES_WRITTEN:37909256,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:16751914,Map-Reduce Framework.Physical memory (bytes) snapshot:4690345984,Map-Reduce Framework.Spilled Records:406325,Map-Reduce Framework.Map output bytes:45943100,Map-Reduce Framework.CPU time spent (ms):133120,Map-Reduce Framework.Total committed heap usage (bytes):3906732032,Map-Reduce Framework.Virtual memory (bytes) snapshot:14073257984,Map-Reduce Framework.Map input bytes:1140850688,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:528655,Map-Reduce Framework.SPLIT_RAW_BYTES:6934" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985204324"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"29"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985204325"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:25,331 Stage-1 map = 32%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:293517,Job Counters .Rack-local map tasks:40,Job Counters .Launched map tasks:98,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:812650,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:12461888,FileSystemCounters.HDFS_BYTES_READ:2179345213,FileSystemCounters.FILE_BYTES_WRITTEN:37909256,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:16751914,Map-Reduce Framework.Physical memory (bytes) snapshot:4690345984,Map-Reduce Framework.Spilled Records:406325,Map-Reduce Framework.Map output bytes:45943100,Map-Reduce Framework.CPU time spent (ms):133120,Map-Reduce Framework.Total committed heap usage (bytes):3906732032,Map-Reduce Framework.Virtual memory (bytes) snapshot:14073257984,Map-Reduce Framework.Map input bytes:1140850688,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:528655,Map-Reduce Framework.SPLIT_RAW_BYTES:6934" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985205331"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"32"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985205333"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:26,338 Stage-1 map = 36%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:315176,Job Counters .Rack-local map tasks:41,Job Counters .Launched map tasks:99,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:816302,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:12517935,FileSystemCounters.HDFS_BYTES_READ:2857583192,FileSystemCounters.FILE_BYTES_WRITTEN:38560708,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:22075873,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:408151,Map-Reduce Framework.Map output bytes:70875346,Map-Reduce Framework.CPU time spent (ms):181760,Map-Reduce Framework.Total committed heap usage (bytes):4964745216,Map-Reduce Framework.Map input bytes:1677721600,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:8718,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5992558592,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:17990127616,Map-Reduce Framework.Map output records:853186" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985206338"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"36"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985206340"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:27,347 Stage-1 map = 38%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:315176,Job Counters .Rack-local map tasks:41,Job Counters .Launched map tasks:99,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:816302,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:12517935,FileSystemCounters.HDFS_BYTES_READ:2857583192,FileSystemCounters.FILE_BYTES_WRITTEN:38560708,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:22075873,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:408151,Map-Reduce Framework.Map output bytes:70875346,Map-Reduce Framework.CPU time spent (ms):181760,Map-Reduce Framework.Total committed heap usage (bytes):4964745216,Map-Reduce Framework.Map input bytes:1677721600,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:8718,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5992558592,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:17990127616,Map-Reduce Framework.Map output records:853186" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985207347"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"38"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985207348"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:28,354 Stage-1 map = 40%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:437834,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1206190,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:18499684,FileSystemCounters.HDFS_BYTES_READ:3542803394,FileSystemCounters.FILE_BYTES_WRITTEN:55952362,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:27325276,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:603095,Map-Reduce Framework.Map output bytes:85249822,Map-Reduce Framework.CPU time spent (ms):202080,Map-Reduce Framework.Total committed heap usage (bytes):5141430272,Map-Reduce Framework.Map input bytes:2281701376,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9070,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6214238208,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:18630791168,Map-Reduce Framework.Map output records:1018869" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985208354"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"40"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985208356"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:29,361 Stage-1 map = 44%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:437834,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1206190,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:18499684,FileSystemCounters.HDFS_BYTES_READ:3542803394,FileSystemCounters.FILE_BYTES_WRITTEN:55952362,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:27325276,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:603095,Map-Reduce Framework.Map output bytes:85249822,Map-Reduce Framework.CPU time spent (ms):202080,Map-Reduce Framework.Total committed heap usage (bytes):5141430272,Map-Reduce Framework.Map input bytes:2281701376,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9070,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6214238208,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:18630791168,Map-Reduce Framework.Map output records:1018869" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985209362"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"44"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985209363"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:30,370 Stage-1 map = 47%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:518963,Job Counters .Rack-local map tasks:46,Job Counters .Launched map tasks:104,Job Counters .Data-local map tasks:58,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1465988,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:22487670,FileSystemCounters.HDFS_BYTES_READ:4061861161,FileSystemCounters.FILE_BYTES_WRITTEN:67578769,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:31299476,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:732994,Map-Reduce Framework.Map output bytes:96141789,Map-Reduce Framework.CPU time spent (ms):219350,Map-Reduce Framework.Total committed heap usage (bytes):5318115328,Map-Reduce Framework.Map input bytes:2684354560,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9422,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6432313344,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:19261394944,Map-Reduce Framework.Map output records:1144265" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985210370"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"47"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985210371"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:31,377 Stage-1 map = 51%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:644833,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:108,Job Counters .Data-local map tasks:59,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1855884,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:28469969,FileSystemCounters.HDFS_BYTES_READ:4590691984,FileSystemCounters.FILE_BYTES_WRITTEN:84988650,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:35351541,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:927942,Map-Reduce Framework.Map output bytes:107249997,Map-Reduce Framework.CPU time spent (ms):236590,Map-Reduce Framework.Total committed heap usage (bytes):5494800384,Map-Reduce Framework.Map input bytes:3087007744,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9774,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6647427072,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:19889766400,Map-Reduce Framework.Map output records:1272118" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985211377"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"51"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985211378"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:32,385 Stage-1 map = 53%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:687652,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:109,Job Counters .Data-local map tasks:60,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1987118,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:30463761,FileSystemCounters.HDFS_BYTES_READ:4837648019,FileSystemCounters.FILE_BYTES_WRITTEN:90825334,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:37246080,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:993559,Map-Reduce Framework.Map output bytes:112501144,Map-Reduce Framework.CPU time spent (ms):243010,Map-Reduce Framework.Total committed heap usage (bytes):5494800384,Map-Reduce Framework.Map input bytes:3288334336,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9774,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6649688064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:19889766400,Map-Reduce Framework.Map output records:1332502" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985212385"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"53"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985212387"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:33,393 Stage-1 map = 57%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:892853,Job Counters .Rack-local map tasks:52,Job Counters .Launched map tasks:114,Job Counters .Data-local map tasks:62,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2539146,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:38937960,FileSystemCounters.HDFS_BYTES_READ:5880068639,FileSystemCounters.FILE_BYTES_WRITTEN:115631230,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:45235260,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:1269573,Map-Reduce Framework.Map output bytes:134418972,Map-Reduce Framework.CPU time spent (ms):284170,Map-Reduce Framework.Total committed heap usage (bytes):6052642816,Map-Reduce Framework.Map input bytes:4026531840,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10668,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7326228480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:21791358976,Map-Reduce Framework.Map output records:1584509" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985213394"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"57"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985213395"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:34,401 Stage-1 map = 59%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:937004,Job Counters .Rack-local map tasks:53,Job Counters .Launched map tasks:115,Job Counters .Data-local map tasks:62,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2539146,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:38937960,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:5947181786,FileSystemCounters.FILE_BYTES_WRITTEN:267856874,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:46344595,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3488243,Map-Reduce Framework.Map output bytes:208272015,Map-Reduce Framework.CPU time spent (ms):296020,Map-Reduce Framework.Total committed heap usage (bytes):6229327872,Map-Reduce Framework.Map input bytes:4026531840,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10854,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7536377856,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:22414966784,Map-Reduce Framework.Map output records:2693844" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985214401"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"59"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985214402"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:35,408 Stage-1 map = 62%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1167092,Job Counters .Rack-local map tasks:58,Job Counters .Launched map tasks:121,Job Counters .Data-local map tasks:63,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3058024,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:46914842,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:7467127670,FileSystemCounters.FILE_BYTES_WRITTEN:461611055,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:58813859,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6227220,Map-Reduce Framework.Map output bytes:338528756,Map-Reduce Framework.CPU time spent (ms):378100,Map-Reduce Framework.Total committed heap usage (bytes):7466123264,Map-Reduce Framework.Map input bytes:5100273664,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:13036,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9063763968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:26812133376,Map-Reduce Framework.Map output records:4544415" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985215408"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"62"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985215409"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:36,415 Stage-1 map = 66%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1389335,Job Counters .Rack-local map tasks:63,Job Counters .Launched map tasks:126,Job Counters .Data-local map tasks:63,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3643216,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:55886952,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:8415742104,FileSystemCounters.FILE_BYTES_WRITTEN:487961759,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:66085439,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6519816,Map-Reduce Framework.Map output bytes:358512256,Map-Reduce Framework.CPU time spent (ms):424190,Map-Reduce Framework.Total committed heap usage (bytes):8228438016,Map-Reduce Framework.Map input bytes:5771362304,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:14336,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9940017152,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29489831936,Map-Reduce Framework.Map output records:4774165" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985216416"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"66"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985216429"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:37,435 Stage-1 map = 69%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1591742,Job Counters .Rack-local map tasks:66,Job Counters .Launched map tasks:130,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4161738,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:63865083,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:9814630639,FileSystemCounters.FILE_BYTES_WRITTEN:511596530,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:76833973,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:6779077,Map-Reduce Framework.Map output bytes:387993569,Map-Reduce Framework.CPU time spent (ms):490080,Map-Reduce Framework.Total committed heap usage (bytes):9407561728,Map-Reduce Framework.Map input bytes:6912212992,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:16448,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11331411968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:33904340992,Map-Reduce Framework.Map output records:5113204" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985217435"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"69"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985217436"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:38,442 Stage-1 map = 71%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1676935,Job Counters .Rack-local map tasks:68,Job Counters .Launched map tasks:132,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4356706,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:66856109,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:11226491450,FileSystemCounters.FILE_BYTES_WRITTEN:520836731,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:87697626,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:6876561,Map-Reduce Framework.Map output bytes:417751378,Map-Reduce Framework.CPU time spent (ms):563750,Map-Reduce Framework.Total committed heap usage (bytes):10642325504,Map-Reduce Framework.Map input bytes:7985954816,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:18804,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12900642816,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:38350102528,Map-Reduce Framework.Map output records:5455546" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985218442"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"71"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985218443"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:39,449 Stage-1 map = 74%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1831507,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4746274,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:72838345,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:11696495520,FileSystemCounters.FILE_BYTES_WRITTEN:538229951,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:91296330,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:7071345,Map-Reduce Framework.Map output bytes:427609878,Map-Reduce Framework.CPU time spent (ms):582610,Map-Reduce Framework.Total committed heap usage (bytes):10819010560,Map-Reduce Framework.Map input bytes:8321499136,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19156,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13124472832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:39028604928,Map-Reduce Framework.Map output records:5569122" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985219449"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"74"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985219450"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:40,456 Stage-1 map = 77%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1972996,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5103764,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:78321470,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:12154453200,FileSystemCounters.FILE_BYTES_WRITTEN:554198497,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:94796758,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:7250090,Map-Reduce Framework.Map output bytes:437217302,Map-Reduce Framework.CPU time spent (ms):602340,Map-Reduce Framework.Total committed heap usage (bytes):10995695616,Map-Reduce Framework.Map input bytes:8657043456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19454,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13368823808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:39679299584,Map-Reduce Framework.Map output records:5679730" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985220456"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"77"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985220457"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:41,463 Stage-1 map = 79%,  reduce = 9%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2283182,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5883286,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:90286124,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:13765166376,FileSystemCounters.FILE_BYTES_WRITTEN:589356433,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:107151173,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:7639851,Map-Reduce Framework.Map output bytes:471104198,Map-Reduce Framework.CPU time spent (ms):678650,Map-Reduce Framework.Total committed heap usage (bytes):12079595520,Map-Reduce Framework.Map input bytes:9865003008,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21566,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14700273664,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:43536510976,Map-Reduce Framework.Map output records:6069491" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985221463"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"9","CNTR_NAME_Stage-1_MAP_PROGRESS":"79"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985221464"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:42,471 Stage-1 map = 81%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2380988,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6143620,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:94273942,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:14080587404,FileSystemCounters.FILE_BYTES_WRITTEN:600993152,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:109551877,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:7770018,Map-Reduce Framework.Map output bytes:477687930,Map-Reduce Framework.CPU time spent (ms):693220,Map-Reduce Framework.Total committed heap usage (bytes):12256280576,Map-Reduce Framework.Map input bytes:10066329600,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21918,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14923489280,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:44171243520,Map-Reduce Framework.Map output records:6145518" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985222471"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"10","CNTR_NAME_Stage-1_MAP_PROGRESS":"81"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985222472"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:43,478 Stage-1 map = 83%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2592327,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6663658,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:102251024,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:14663510003,FileSystemCounters.FILE_BYTES_WRITTEN:624182515,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:113984940,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:8030037,Map-Reduce Framework.Map output bytes:489868729,Map-Reduce Framework.CPU time spent (ms):717780,Map-Reduce Framework.Total committed heap usage (bytes):12433031168,Map-Reduce Framework.Map input bytes:10468982784,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22270,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15163121664,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:44884729856,Map-Reduce Framework.Map output records:6285816" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985223478"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"83"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985223479"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:44,485 Stage-1 map = 84%,  reduce = 14%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2644156,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6793216,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:104244802,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:14931962199,FileSystemCounters.FILE_BYTES_WRITTEN:630015655,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:116043497,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:8094816,Map-Reduce Framework.Map output bytes:495490392,Map-Reduce Framework.CPU time spent (ms):731130,Map-Reduce Framework.Total committed heap usage (bytes):12609716224,Map-Reduce Framework.Map input bytes:10670309376,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22622,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15392681984,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:45585301504,Map-Reduce Framework.Map output records:6350595" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985224485"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"14","CNTR_NAME_Stage-1_MAP_PROGRESS":"84"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985224486"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:45,542 Stage-1 map = 85%,  reduce = 14%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2808885,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7183530,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:110226522,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:15569402912,FileSystemCounters.FILE_BYTES_WRITTEN:647535982,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:120929148,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:8289973,Map-Reduce Framework.Map output bytes:508916775,Map-Reduce Framework.CPU time spent (ms):760130,Map-Reduce Framework.Total committed heap usage (bytes):12960989184,Map-Reduce Framework.Map input bytes:11140071424,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23326,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15816486912,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:46891024384,Map-Reduce Framework.Map output records:6505075" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985225542"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"14","CNTR_NAME_Stage-1_MAP_PROGRESS":"85"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985225543"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:46,549 Stage-1 map = 88%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3057361,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7833766,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:120196076,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:16705839536,FileSystemCounters.FILE_BYTES_WRITTEN:676777817,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:129632986,Map-Reduce Framework.Reduce shuffle bytes:11287118,Map-Reduce Framework.Spilled Records:8615091,Map-Reduce Framework.Map output bytes:532790963,Map-Reduce Framework.CPU time spent (ms):815100,Map-Reduce Framework.Total committed heap usage (bytes):13665763328,Map-Reduce Framework.Map input bytes:11945377792,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24734,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16682123264,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:49404715008,Map-Reduce Framework.Map output records:6779714" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985226549"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"88"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985226550"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:47,562 Stage-1 map = 88%,  reduce = 17%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3057361,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7833766,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:120196076,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:16705839536,FileSystemCounters.FILE_BYTES_WRITTEN:676859347,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:129632986,Map-Reduce Framework.Reduce shuffle bytes:49187828,Map-Reduce Framework.Spilled Records:8615091,Map-Reduce Framework.Map output bytes:532790963,Map-Reduce Framework.CPU time spent (ms):816450,Map-Reduce Framework.Total committed heap usage (bytes):13786742784,Map-Reduce Framework.Map input bytes:11945377792,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24734,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16809869312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50048090112,Map-Reduce Framework.Map output records:6779714" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985227562"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"17","CNTR_NAME_Stage-1_MAP_PROGRESS":"88"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985227563"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:48,569 Stage-1 map = 90%,  reduce = 19%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3169408,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8092656,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:124185038,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:16961049011,FileSystemCounters.FILE_BYTES_WRITTEN:688457534,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:131590788,Map-Reduce Framework.Reduce shuffle bytes:96369689,Map-Reduce Framework.Spilled Records:8744536,Map-Reduce Framework.Map output bytes:538149614,Map-Reduce Framework.CPU time spent (ms):825160,Map-Reduce Framework.Total committed heap usage (bytes):13907722240,Map-Reduce Framework.Map input bytes:12146704384,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24734,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16944840704,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:50665078784,Map-Reduce Framework.Map output records:6841315" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985228569"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"19","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985228570"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:49,576 Stage-1 map = 92%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3393557,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8613716,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:132160257,FileSystemCounters.FILE_BYTES_READ:152312879,FileSystemCounters.HDFS_BYTES_READ:18230589254,FileSystemCounters.FILE_BYTES_WRITTEN:712039315,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:141321888,Map-Reduce Framework.Reduce shuffle bytes:132070341,Map-Reduce Framework.Spilled Records:9005066,Map-Reduce Framework.Map output bytes:564874016,Map-Reduce Framework.CPU time spent (ms):889610,Map-Reduce Framework.Total committed heap usage (bytes):14763229184,Map-Reduce Framework.Map input bytes:13153337344,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:26142,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17968726016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53827977216,Map-Reduce Framework.Map output records:7148770" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985229576"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"21","CNTR_NAME_Stage-1_MAP_PROGRESS":"92"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985229577"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:51,590 Stage-1 map = 93%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3517115,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8872146,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136149308,FileSystemCounters.FILE_BYTES_READ:155696175,FileSystemCounters.HDFS_BYTES_READ:19534757505,FileSystemCounters.FILE_BYTES_WRITTEN:870177960,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152524753,Map-Reduce Framework.Reduce shuffle bytes:176945001,Map-Reduce Framework.Spilled Records:11213901,Map-Reduce Framework.Map output bytes:737501072,Map-Reduce Framework.CPU time spent (ms):981140,Map-Reduce Framework.Total committed heap usage (bytes):15942287360,Map-Reduce Framework.Map input bytes:14159970304,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27972,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19479117824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58293858304,Map-Reduce Framework.Map output records:9654947" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985231590"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985231591"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:52,599 Stage-1 map = 94%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3574764,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9002096,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:138143625,FileSystemCounters.FILE_BYTES_READ:155696175,FileSystemCounters.HDFS_BYTES_READ:19567062657,FileSystemCounters.FILE_BYTES_WRITTEN:875958237,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152770972,Map-Reduce Framework.Reduce shuffle bytes:176945001,Map-Reduce Framework.Spilled Records:11278876,Map-Reduce Framework.Map output bytes:738172161,Map-Reduce Framework.CPU time spent (ms):982360,Map-Reduce Framework.Total committed heap usage (bytes):15942287360,Map-Reduce Framework.Map input bytes:14159970304,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27972,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19479216128,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58293858304,Map-Reduce Framework.Map output records:9662665" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985232600"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985232600"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:53,607 Stage-1 map = 94%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3822788,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9391150,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126524,FileSystemCounters.FILE_BYTES_READ:231855241,FileSystemCounters.HDFS_BYTES_READ:20215312900,FileSystemCounters.FILE_BYTES_WRITTEN:1045716145,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:158331351,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:13690189,Map-Reduce Framework.Map output bytes:824222893,Map-Reduce Framework.CPU time spent (ms):1029570,Map-Reduce Framework.Total committed heap usage (bytes):16593321984,Map-Reduce Framework.Map input bytes:14562623488,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28862,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20287778816,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60862394368,Map-Reduce Framework.Map output records:10911453" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985233607"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985233608"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:54,614 Stage-1 map = 94%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3847597,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9391150,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:144126524,FileSystemCounters.FILE_BYTES_READ:231855241,FileSystemCounters.HDFS_BYTES_READ:20215312900,FileSystemCounters.FILE_BYTES_WRITTEN:1045716145,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:158331351,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:13690189,Map-Reduce Framework.Map output bytes:824222893,Map-Reduce Framework.CPU time spent (ms):1029570,Map-Reduce Framework.Total committed heap usage (bytes):16593321984,Map-Reduce Framework.Map input bytes:14562623488,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28862,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20287778816,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60862394368,Map-Reduce Framework.Map output records:10911453" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985234615"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985234616"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:55,622 Stage-1 map = 95%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3929845,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9521132,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:146121117,FileSystemCounters.FILE_BYTES_READ:231855241,FileSystemCounters.HDFS_BYTES_READ:20443496967,FileSystemCounters.FILE_BYTES_WRITTEN:1051499223,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:160079014,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:13755180,Map-Reduce Framework.Map output bytes:829020103,Map-Reduce Framework.CPU time spent (ms):1039360,Map-Reduce Framework.Total committed heap usage (bytes):16593321984,Map-Reduce Framework.Map input bytes:14763950080,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28862,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20305010688,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60876959744,Map-Reduce Framework.Map output records:10966630" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985235622"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"26","CNTR_NAME_Stage-1_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985235623"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:56,629 Stage-1 map = 96%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:3990872,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9521132,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:146121117,FileSystemCounters.FILE_BYTES_READ:304646413,FileSystemCounters.HDFS_BYTES_READ:20528227248,FileSystemCounters.FILE_BYTES_WRITTEN:1203504575,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:161481039,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:16018256,Map-Reduce Framework.Map output bytes:922411975,Map-Reduce Framework.CPU time spent (ms):1063080,Map-Reduce Framework.Total committed heap usage (bytes):16944660480,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20750843904,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62135930880,Map-Reduce Framework.Map output records:12368653" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985236629"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"27","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985236630"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:57,640 Stage-1 map = 97%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4061889,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9650514,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148115445,FileSystemCounters.FILE_BYTES_READ:304646413,FileSystemCounters.HDFS_BYTES_READ:20582073264,FileSystemCounters.FILE_BYTES_WRITTEN:1209250253,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:161893939,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:16082947,Map-Reduce Framework.Map output bytes:923544864,Map-Reduce Framework.CPU time spent (ms):1065060,Map-Reduce Framework.Total committed heap usage (bytes):16944660480,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20750950400,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62135930880,Map-Reduce Framework.Map output records:12381685" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985237641"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"27","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985237642"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:33:59,654 Stage-1 map = 97%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4072544,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9650514,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148115445,FileSystemCounters.FILE_BYTES_READ:304646413,FileSystemCounters.HDFS_BYTES_READ:20582073264,FileSystemCounters.FILE_BYTES_WRITTEN:1209250253,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:161893939,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:16082947,Map-Reduce Framework.Map output bytes:923544864,Map-Reduce Framework.CPU time spent (ms):1065060,Map-Reduce Framework.Total committed heap usage (bytes):16944660480,Map-Reduce Framework.Map input bytes:14831058944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20750950400,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62135930880,Map-Reduce Framework.Map output records:12381685" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985239654"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985239655"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:01,668 Stage-1 map = 97%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4199584,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304646413,FileSystemCounters.HDFS_BYTES_READ:20662551473,FileSystemCounters.FILE_BYTES_WRITTEN:1215049479,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162510817,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:16148185,Map-Reduce Framework.Map output bytes:925251950,Map-Reduce Framework.CPU time spent (ms):1068600,Map-Reduce Framework.Total committed heap usage (bytes):16944660480,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20751097856,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62135930880,Map-Reduce Framework.Map output records:12401307" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985241668"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985241669"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:03,683 Stage-1 map = 98%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4256236,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:304646413,FileSystemCounters.HDFS_BYTES_READ:20662551473,FileSystemCounters.FILE_BYTES_WRITTEN:1215049479,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162510817,Map-Reduce Framework.Reduce shuffle bytes:218919499,Map-Reduce Framework.Spilled Records:16148185,Map-Reduce Framework.Map output bytes:925251950,Map-Reduce Framework.CPU time spent (ms):1068600,Map-Reduce Framework.Total committed heap usage (bytes):16944660480,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29284,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20751097856,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62135930880,Map-Reduce Framework.Map output records:12401307" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985243683"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985243684"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:08,778 Stage-1 map = 98%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4406839,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:456967613,FileSystemCounters.HDFS_BYTES_READ:20787139692,FileSystemCounters.FILE_BYTES_WRITTEN:1519575211,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:164567136,Map-Reduce Framework.Reduce shuffle bytes:373239303,Map-Reduce Framework.Spilled Records:20584487,Map-Reduce Framework.Map output bytes:1062160827,Map-Reduce Framework.CPU time spent (ms):1102950,Map-Reduce Framework.Total committed heap usage (bytes):17473142784,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21329891328,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64039489536,Map-Reduce Framework.Map output records:14457627" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985248778"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985248779"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:14,812 Stage-1 map = 98%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4503919,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20852831340,FileSystemCounters.FILE_BYTES_WRITTEN:1671710492,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:165650125,Map-Reduce Framework.Reduce shuffle bytes:373239303,Map-Reduce Framework.Spilled Records:22802009,Map-Reduce Framework.Map output bytes:1134289121,Map-Reduce Framework.CPU time spent (ms):1116480,Map-Reduce Framework.Total committed heap usage (bytes):17473142784,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21355753472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64053919744,Map-Reduce Framework.Map output records:15540617" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985254812"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985254813"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:17,829 Stage-1 map = 99%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4503919,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:533123026,FileSystemCounters.HDFS_BYTES_READ:20852831340,FileSystemCounters.FILE_BYTES_WRITTEN:1671710492,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:165650125,Map-Reduce Framework.Reduce shuffle bytes:373239303,Map-Reduce Framework.Spilled Records:22802009,Map-Reduce Framework.Map output bytes:1134289121,Map-Reduce Framework.CPU time spent (ms):1116480,Map-Reduce Framework.Total committed heap usage (bytes):17473142784,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21355753472,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64053919744,Map-Reduce Framework.Map output records:15540617" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985257829"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"99"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985257830"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:26,040 Stage-1 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4608532,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:673986541,FileSystemCounters.HDFS_BYTES_READ:20909524936,FileSystemCounters.FILE_BYTES_WRITTEN:1886499475,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:166587449,Map-Reduce Framework.Reduce shuffle bytes:373239303,Map-Reduce Framework.Spilled Records:25934840,Map-Reduce Framework.Map output bytes:1196681970,Map-Reduce Framework.CPU time spent (ms):1128420,Map-Reduce Framework.Total committed heap usage (bytes):17472421888,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21359128576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64053919744,Map-Reduce Framework.Map output records:16477942" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985266041"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985266041"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:36,097 Stage-1 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4803950,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:21070956489,FileSystemCounters.FILE_BYTES_WRITTEN:2568662676,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169250596,Map-Reduce Framework.Reduce shuffle bytes:596007468,Map-Reduce Framework.Spilled Records:33391687,Map-Reduce Framework.Map output bytes:1373983874,Map-Reduce Framework.CPU time spent (ms):1169210,Map-Reduce Framework.Total committed heap usage (bytes):17822449664,Map-Reduce Framework.Map input bytes:14965276672,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29470,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21754847232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65329115136,Map-Reduce Framework.Map output records:19141091" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985276098"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985276099"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:55,303 Stage-1 map = 100%,  reduce = 36%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4928043,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985295303"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"36","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985295304"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:58,321 Stage-1 map = 100%,  reduce = 48%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985298321"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"48","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985298322"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:34:59,329 Stage-1 map = 100%,  reduce = 51%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985299329"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"51","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985299330"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:00,336 Stage-1 map = 100%,  reduce = 54%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985300336"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"54","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985300337"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:01,343 Stage-1 map = 100%,  reduce = 64%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985301344"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"64","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985301344"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:02,353 Stage-1 map = 100%,  reduce = 68%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985302354"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"68","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985302354"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:03,360 Stage-1 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985303361"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"72","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985303362"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:04,367 Stage-1 map = 100%,  reduce = 76%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985304368"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"76","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985304369"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:05,374 Stage-1 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:14380,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3616572703,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1194002235,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1231610,Map-Reduce Framework.Total committed heap usage (bytes):18289000448,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22434557952,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985305374"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"77","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985305375"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:06,383 Stage-1 map = 100%,  reduce = 78%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:119303,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1505236996,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3863086282,FileSystemCounters.HDFS_BYTES_WRITTEN:35568285,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1308074119,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1255320,Map-Reduce Framework.Total committed heap usage (bytes):18304860160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3106896,Map-Reduce Framework.Reduce input groups:3106897,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22522478592,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985306383"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"78","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985306384"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:07,391 Stage-1 map = 100%,  reduce = 82%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:119303,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1505236996,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3863086282,FileSystemCounters.HDFS_BYTES_WRITTEN:35568285,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1308074119,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1255320,Map-Reduce Framework.Total committed heap usage (bytes):18304860160,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:3106896,Map-Reduce Framework.Reduce input groups:3106897,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22522478592,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985307391"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"82","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985307392"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:08,398 Stage-1 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:226244,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1788254344,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4109979849,FileSystemCounters.HDFS_BYTES_WRITTEN:80253955,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428737893,Map-Reduce Framework.Spilled Records:45592052,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1284710,Map-Reduce Framework.Total committed heap usage (bytes):18338742272,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:6995981,Map-Reduce Framework.Reduce input groups:6995956,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22640484352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985308398"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"83","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985308399"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:09,405 Stage-1 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:226244,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1788254344,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4109979849,FileSystemCounters.HDFS_BYTES_WRITTEN:80253955,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428737893,Map-Reduce Framework.Spilled Records:45592052,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1284710,Map-Reduce Framework.Total committed heap usage (bytes):18338742272,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:6995981,Map-Reduce Framework.Reduce input groups:6995956,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22640484352,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985309405"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"84","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985309406"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:10,412 Stage-1 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:443724,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1935473435,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4109979849,FileSystemCounters.HDFS_BYTES_WRITTEN:103549308,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428737893,Map-Reduce Framework.Spilled Records:50086605,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1292640,Map-Reduce Framework.Total committed heap usage (bytes):18322948096,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8990815,Map-Reduce Framework.Reduce input groups:8990815,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22622994432,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985310412"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"87","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985310413"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:11,419 Stage-1 map = 100%,  reduce = 88%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:443724,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1935473435,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4109979849,FileSystemCounters.HDFS_BYTES_WRITTEN:103549308,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1428737893,Map-Reduce Framework.Spilled Records:50086605,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1292640,Map-Reduce Framework.Total committed heap usage (bytes):18322948096,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:8990815,Map-Reduce Framework.Reduce input groups:8990815,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22622994432,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985311419"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"88","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985311420"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:12,426 Stage-1 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:5,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:553672,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2099397778,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4184861730,FileSystemCounters.HDFS_BYTES_WRITTEN:129407277,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1496013832,Map-Reduce Framework.Spilled Records:52331076,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1309160,Map-Reduce Framework.Total committed heap usage (bytes):18312069120,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:11235286,Map-Reduce Framework.Reduce input groups:11235286,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22686633984,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985312426"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"90","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985312427"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:13,448 Stage-1 map = 100%,  reduce = 91%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:668507,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2263486261,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4259880438,FileSystemCounters.HDFS_BYTES_WRITTEN:155280045,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549347375,Map-Reduce Framework.Spilled Records:54578723,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1325670,Map-Reduce Framework.Total committed heap usage (bytes):18324914176,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:13482933,Map-Reduce Framework.Reduce input groups:13482933,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22735736832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985313448"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"91","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985313449"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:15,461 Stage-1 map = 100%,  reduce = 92%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:668507,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2263486261,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4259880438,FileSystemCounters.HDFS_BYTES_WRITTEN:155280045,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1549347375,Map-Reduce Framework.Spilled Records:54578723,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1325670,Map-Reduce Framework.Total committed heap usage (bytes):18324914176,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:13482933,Map-Reduce Framework.Reduce input groups:13482933,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22735736832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985315462"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"92","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985315463"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:16,469 Stage-1 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:783149,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2427402109,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4342301496,FileSystemCounters.HDFS_BYTES_WRITTEN:181194858,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1572052312,Map-Reduce Framework.Spilled Records:56825012,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1340060,Map-Reduce Framework.Total committed heap usage (bytes):18351259648,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:15729222,Map-Reduce Framework.Reduce input groups:15729222,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22758404096,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985316469"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"94","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985316470"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:19,487 Stage-1 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:783149,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2427402109,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4342301496,FileSystemCounters.HDFS_BYTES_WRITTEN:181194858,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1572052312,Map-Reduce Framework.Spilled Records:56825012,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1340060,Map-Reduce Framework.Total committed heap usage (bytes):18351259648,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:15729222,Map-Reduce Framework.Reduce input groups:15729222,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22758404096,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985319487"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"95","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985319488"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:20,494 Stage-1 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:901477,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2591381578,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4417144258,FileSystemCounters.HDFS_BYTES_WRITTEN:207064241,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1594822346,Map-Reduce Framework.Spilled Records:59070602,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1357150,Map-Reduce Framework.Total committed heap usage (bytes):18361942016,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17974812,Map-Reduce Framework.Reduce input groups:17974812,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22803439616,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985320494"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"96","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985320495"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:22,506 Stage-1 map = 100%,  reduce = 97%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:901477,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2591381578,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4417144258,FileSystemCounters.HDFS_BYTES_WRITTEN:207064241,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1594822346,Map-Reduce Framework.Spilled Records:59070602,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1357150,Map-Reduce Framework.Total committed heap usage (bytes):18361942016,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17974812,Map-Reduce Framework.Reduce input groups:17974812,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22803439616,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985322506"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"97","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985322507"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:25,524 Stage-1 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:1033048,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2755376209,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4492117304,FileSystemCounters.HDFS_BYTES_WRITTEN:232902386,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617644364,Map-Reduce Framework.Spilled Records:61317289,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1374890,Map-Reduce Framework.Total committed heap usage (bytes):18340642816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20221499,Map-Reduce Framework.Reduce input groups:20221499,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22850822144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985325524"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"98","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985325525"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:31,558 Stage-1 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:1033048,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2755376209,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4492117304,FileSystemCounters.HDFS_BYTES_WRITTEN:232902386,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617644364,Map-Reduce Framework.Spilled Records:61317289,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1374890,Map-Reduce Framework.Total committed heap usage (bytes):18340642816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20221499,Map-Reduce Framework.Reduce input groups:20221499,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22850822144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985331558"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"99","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985331559"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:34,612 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:1039399,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2755376209,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4492117304,FileSystemCounters.HDFS_BYTES_WRITTEN:232902386,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617644364,Map-Reduce Framework.Spilled Records:61317289,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1374890,Map-Reduce Framework.Total committed heap usage (bytes):18340642816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20221499,Map-Reduce Framework.Reduce input groups:20221499,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22850822144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985334613"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985334614"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985338673"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985338725"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 22:35:34,612 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:4935509,Job Counters .Rack-local map tasks:70,Job Counters .Launched map tasks:134,Job Counters .Data-local map tasks:64,Job Counters .SLOTS_MILLIS_REDUCES:1039399,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2755376209,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4492117304,FileSystemCounters.HDFS_BYTES_WRITTEN:232902386,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1617644364,Map-Reduce Framework.Spilled Records:61317289,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1374890,Map-Reduce Framework.Total committed heap usage (bytes):18340642816,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:20221499,Map-Reduce Framework.Reduce input groups:20221499,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22850822144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65957462016,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0057" TIME="1337985338725"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985338725"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985338735"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:35:44,115 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985344115"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985344116"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:36:44,366 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985404366"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985404367"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:37:44,772 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985464772"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985464773"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:38:45,223 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985525224"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985525224"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:39:46,077 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985586077"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985586078"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:40:46,354 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985646354"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985646355"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:41:46,645 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985706645"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985706645"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:42:46,918 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985766918"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985766919"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:43:47,306 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:2407" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985827306"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985827307"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:18,448 Stage-2 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:8,Job Counters .Data-local map tasks:2,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.HDFS_BYTES_READ:1119003,FileSystemCounters.FILE_BYTES_WRITTEN:81591,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:23477,Map-Reduce Framework.Physical memory (bytes) snapshot:210522112,Map-Reduce Framework.Spilled Records:0,Map-Reduce Framework.Map output bytes:1094642,Map-Reduce Framework.CPU time spent (ms):2950,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:682352640,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:23476,Map-Reduce Framework.SPLIT_RAW_BYTES:244" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985858448"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"13","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985858449"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:21,462 Stage-2 map = 38%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:23667,Job Counters .Rack-local map tasks:7,Job Counters .Launched map tasks:9,Job Counters .Data-local map tasks:2,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:23755256,FileSystemCounters.HDFS_BYTES_READ:25912812,FileSystemCounters.FILE_BYTES_WRITTEN:47498827,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:487575,Map-Reduce Framework.Physical memory (bytes) snapshot:221417472,Map-Reduce Framework.Spilled Records:975150,Map-Reduce Framework.Map output bytes:22733254,Map-Reduce Framework.CPU time spent (ms):9980,Map-Reduce Framework.Total committed heap usage (bytes):174522368,Map-Reduce Framework.Virtual memory (bytes) snapshot:682352640,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:487575,Map-Reduce Framework.SPLIT_RAW_BYTES:244" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985861463"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"38","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985861463"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:25,482 Stage-2 map = 63%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:78912,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:71186317,FileSystemCounters.HDFS_BYTES_READ:77683969,FileSystemCounters.FILE_BYTES_WRITTEN:142396831,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1461705,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:2923410,Map-Reduce Framework.Map output bytes:68151975,Map-Reduce Framework.CPU time spent (ms):26800,Map-Reduce Framework.Total committed heap usage (bytes):527892480,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:732,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:642584576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1901121536,Map-Reduce Framework.Map output records:1461705" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985865482"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"63","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985865483"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:28,501 Stage-2 map = 75%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:109239,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:94861818,FileSystemCounters.HDFS_BYTES_READ:103522546,FileSystemCounters.FILE_BYTES_WRITTEN:189759845,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1947898,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:3895796,Map-Reduce Framework.Map output bytes:90820086,Map-Reduce Framework.CPU time spent (ms):37120,Map-Reduce Framework.Total committed heap usage (bytes):704577536,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:976,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:855871488,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:2525331456,Map-Reduce Framework.Map output records:1947898" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985868501"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985868502"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:31,516 Stage-2 map = 75%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:143152,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:118654163,FileSystemCounters.HDFS_BYTES_READ:129490012,FileSystemCounters.FILE_BYTES_WRITTEN:237358734,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2436504,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:4873008,Map-Reduce Framework.Map output bytes:113601308,Map-Reduce Framework.CPU time spent (ms):49820,Map-Reduce Framework.Total committed heap usage (bytes):881262592,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1220,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1070432256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3151409152,Map-Reduce Framework.Map output records:2436504" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985871516"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"2"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985871517"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:36,539 Stage-2 map = 88%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:179506,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:142351373,FileSystemCounters.HDFS_BYTES_READ:155363212,FileSystemCounters.FILE_BYTES_WRITTEN:284785050,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2923340,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:5846680,Map-Reduce Framework.Map output bytes:136299784,Map-Reduce Framework.CPU time spent (ms):62280,Map-Reduce Framework.Total committed heap usage (bytes):1057947648,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1288650752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3758014464,Map-Reduce Framework.Map output records:2923340" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985876540"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"88","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"2"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985876540"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:37,545 Stage-2 map = 92%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:179506,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:142351373,FileSystemCounters.HDFS_BYTES_READ:155363212,FileSystemCounters.FILE_BYTES_WRITTEN:284785050,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2923340,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:5846680,Map-Reduce Framework.Map output bytes:136299784,Map-Reduce Framework.CPU time spent (ms):62280,Map-Reduce Framework.Total committed heap usage (bytes):1057947648,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1288650752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3758014464,Map-Reduce Framework.Map output records:2923340" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985877546"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"2"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985877546"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:38,582 Stage-2 map = 92%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:186617,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:142351373,FileSystemCounters.HDFS_BYTES_READ:155363212,FileSystemCounters.FILE_BYTES_WRITTEN:284785050,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2923340,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:5846680,Map-Reduce Framework.Map output bytes:136299784,Map-Reduce Framework.CPU time spent (ms):62280,Map-Reduce Framework.Total committed heap usage (bytes):1057947648,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1288650752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3758014464,Map-Reduce Framework.Map output records:2923340" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985878583"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"5"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985878583"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:39,588 Stage-2 map = 92%,  reduce = 7%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:186617,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:142351373,FileSystemCounters.HDFS_BYTES_READ:155363212,FileSystemCounters.FILE_BYTES_WRITTEN:284785050,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2923340,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:5846680,Map-Reduce Framework.Map output bytes:136299784,Map-Reduce Framework.CPU time spent (ms):62280,Map-Reduce Framework.Total committed heap usage (bytes):1057947648,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1288650752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3758014464,Map-Reduce Framework.Map output records:2923340" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985879588"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"7"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985879589"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:40,594 Stage-2 map = 92%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985880594"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"10"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985880595"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:41,600 Stage-2 map = 92%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985881600"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"13"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985881601"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:42,606 Stage-2 map = 92%,  reduce = 16%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985882606"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"16"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985882607"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:43,612 Stage-2 map = 92%,  reduce = 19%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985883612"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"19"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985883613"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:44,618 Stage-2 map = 92%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985884618"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"23"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985884619"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:45,623 Stage-2 map = 92%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985885624"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"26"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985885624"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:46,629 Stage-2 map = 92%,  reduce = 27%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985886630"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"27"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985886630"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:47,635 Stage-2 map = 92%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:237266,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985887635"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"28"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985887636"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:50,649 Stage-2 map = 92%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:245253,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332184321,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):75840,Map-Reduce Framework.Total committed heap usage (bytes):1234632704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497686016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4379230208,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985890649"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"29"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985890650"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:44:55,673 Stage-2 map = 96%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:245253,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332591887,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:82992676,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):82780,Map-Reduce Framework.Total committed heap usage (bytes):1839529984,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2090078208,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7442587648,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985895673"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"96","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"29"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985895674"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:02,706 Stage-2 map = 100%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:245253,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:166045279,FileSystemCounters.HDFS_BYTES_READ:181221613,FileSystemCounters.FILE_BYTES_WRITTEN:332673401,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3409902,Map-Reduce Framework.Reduce shuffle bytes:99590522,Map-Reduce Framework.Spilled Records:6819804,Map-Reduce Framework.Map output bytes:158985285,Map-Reduce Framework.CPU time spent (ms):83960,Map-Reduce Framework.Total committed heap usage (bytes):1988296704,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1708,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2200195072,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8057061376,Map-Reduce Framework.Map output records:3409902" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985902706"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"29"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985902707"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:16,768 Stage-2 map = 100%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985916768"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"30"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985916769"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:18,780 Stage-2 map = 100%,  reduce = 41%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985918780"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"41"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985918781"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:19,786 Stage-2 map = 100%,  reduce = 45%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985919786"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"45"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985919788"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:20,793 Stage-2 map = 100%,  reduce = 48%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985920793"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"48"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985920794"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:21,799 Stage-2 map = 100%,  reduce = 60%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985921799"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"60"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985921800"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:22,806 Stage-2 map = 100%,  reduce = 68%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985922806"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"68"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985922807"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:24,816 Stage-2 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:2407,FileSystemCounters.FILE_BYTES_READ:237151989,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:474992691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:149239896,Map-Reduce Framework.Spilled Records:9739986,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):113510,Map-Reduce Framework.Total committed heap usage (bytes):2526674944,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2788237312,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10612211712,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985924816"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"71"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985924818"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:25,823 Stage-2 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:67587,FileSystemCounters.FILE_BYTES_READ:264100186,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:522414879,FileSystemCounters.HDFS_BYTES_WRITTEN:11245016,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:180009035,Map-Reduce Framework.Spilled Records:10226882,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):126570,Map-Reduce Framework.Total committed heap usage (bytes):2647654400,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:555157,Map-Reduce Framework.Reduce input groups:239247,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2919469056,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11357089792,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985925823"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"72"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985925824"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:26,829 Stage-2 map = 100%,  reduce = 73%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:67587,FileSystemCounters.FILE_BYTES_READ:264100186,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:522414879,FileSystemCounters.HDFS_BYTES_WRITTEN:11245016,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:180009035,Map-Reduce Framework.Spilled Records:10226882,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):126570,Map-Reduce Framework.Total committed heap usage (bytes):2647654400,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:555157,Map-Reduce Framework.Reduce input groups:239247,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2919469056,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11357089792,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985926829"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"73"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985926830"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:27,873 Stage-2 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:3,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:134632,FileSystemCounters.FILE_BYTES_READ:287739656,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:546054349,FileSystemCounters.HDFS_BYTES_WRITTEN:21120885,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:187104404,Map-Reduce Framework.Spilled Records:10713039,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):131510,Map-Reduce Framework.Total committed heap usage (bytes):2644705280,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:1041314,Map-Reduce Framework.Reduce input groups:448975,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2924974080,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11357089792,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985927874"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"77"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985927874"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:28,879 Stage-2 map = 100%,  reduce = 85%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:201703,FileSystemCounters.FILE_BYTES_READ:311468815,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:569783508,FileSystemCounters.HDFS_BYTES_WRITTEN:31013904,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:194216223,Map-Reduce Framework.Spilled Records:11201043,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):138140,Map-Reduce Framework.Total committed heap usage (bytes):2644705280,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:1529318,Map-Reduce Framework.Reduce input groups:659069,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2927562752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11357089792,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985928879"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"85"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985928880"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:29,885 Stage-2 map = 100%,  reduce = 90%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:14,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:337659,FileSystemCounters.FILE_BYTES_READ:358774472,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:617089165,FileSystemCounters.HDFS_BYTES_WRITTEN:50788857,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:208382560,Map-Reduce Framework.Spilled Records:12173920,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):151240,Map-Reduce Framework.Total committed heap usage (bytes):2644705280,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:2502195,Map-Reduce Framework.Reduce input groups:1079028,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2974027776,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11360563200,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985929885"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"90"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985929886"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:30,891 Stage-2 map = 100%,  reduce = 94%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:475770,FileSystemCounters.FILE_BYTES_READ:402832394,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:640754610,FileSystemCounters.HDFS_BYTES_WRITTEN:69177519,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:215484374,Map-Reduce Framework.Spilled Records:13147318,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):159400,Map-Reduce Framework.Total committed heap usage (bytes):2644705280,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:3407332,Map-Reduce Framework.Reduce input groups:1469104,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2988408832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11360563200,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985930891"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"94"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985930892"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:31,896 Stage-2 map = 100%,  reduce = 98%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:615530,FileSystemCounters.FILE_BYTES_READ:450290527,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:688212743,FileSystemCounters.HDFS_BYTES_WRITTEN:88960910,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:229720333,Map-Reduce Framework.Spilled Records:14123340,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):173260,Map-Reduce Framework.Total committed heap usage (bytes):2644705280,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:4383354,Map-Reduce Framework.Reduce input groups:1889245,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2998145024,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11365216256,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985931897"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"98"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985931897"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:32,904 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:688014,FileSystemCounters.FILE_BYTES_READ:473953383,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:711875599,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:236801814,Map-Reduce Framework.Spilled Records:14609979,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):180440,Map-Reduce Framework.Total committed heap usage (bytes):2640904192,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:4869993,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3002310656,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11365216256,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985932905"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985932905"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985938970"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985939065"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 22:45:32,904 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:15,Job Counters .SLOTS_MILLIS_MAPS:370344,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:12,Job Counters .Data-local map tasks:3,Job Counters .SLOTS_MILLIS_REDUCES:688014,FileSystemCounters.FILE_BYTES_READ:473953383,FileSystemCounters.HDFS_BYTES_READ:258818798,FileSystemCounters.FILE_BYTES_WRITTEN:711875599,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869993,Map-Reduce Framework.Reduce shuffle bytes:236801814,Map-Reduce Framework.Spilled Records:14609979,Map-Reduce Framework.Map output bytes:227061348,Map-Reduce Framework.CPU time spent (ms):180440,Map-Reduce Framework.Total committed heap usage (bytes):2640904192,Map-Reduce Framework.Map input bytes:51681364,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2152,Map-Reduce Framework.Reduce input records:4869993,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3002310656,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:11365216256,Map-Reduce Framework.Map output records:4869993" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0063" TIME="1337985939065"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985939065"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985939067"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:43,268 Stage-3 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2510,Job Counters .Rack-local map tasks:3,Job Counters .Launched map tasks:4,Job Counters .Data-local map tasks:1" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985943268"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985943269"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:49,294 Stage-3 map = 14%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:8088,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.HDFS_BYTES_READ:9876301,FileSystemCounters.FILE_BYTES_WRITTEN:10699233,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:209728,Map-Reduce Framework.Physical memory (bytes) snapshot:197328896,Map-Reduce Framework.Spilled Records:209728,Map-Reduce Framework.Map output bytes:10198149,Map-Reduce Framework.CPU time spent (ms):5190,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:616763392,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:209728,Map-Reduce Framework.SPLIT_RAW_BYTES:244" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985949294"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"14"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985949295"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:52,309 Stage-3 map = 64%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:8088,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.HDFS_BYTES_READ:9876301,FileSystemCounters.FILE_BYTES_WRITTEN:10699233,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:209728,Map-Reduce Framework.Physical memory (bytes) snapshot:197328896,Map-Reduce Framework.Spilled Records:209728,Map-Reduce Framework.Map output bytes:10198149,Map-Reduce Framework.CPU time spent (ms):5190,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:616763392,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:209728,Map-Reduce Framework.SPLIT_RAW_BYTES:244" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985952309"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"64"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985952310"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:56,329 Stage-3 map = 69%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:40018,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.HDFS_BYTES_READ:60597188,FileSystemCounters.FILE_BYTES_WRITTEN:42981098,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1310505,Map-Reduce Framework.Physical memory (bytes) snapshot:1214627840,Map-Reduce Framework.Spilled Records:839335,Map-Reduce Framework.Map output bytes:63985165,Map-Reduce Framework.CPU time spent (ms):39770,Map-Reduce Framework.Total committed heap usage (bytes):1060110336,Map-Reduce Framework.Virtual memory (bytes) snapshot:4013084672,Map-Reduce Framework.Map input bytes:9874589,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1315897,Map-Reduce Framework.SPLIT_RAW_BYTES:1764" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985956329"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"69"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985956330"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:45:59,343 Stage-3 map = 95%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:68354,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:21262915,FileSystemCounters.HDFS_BYTES_READ:78581055,FileSystemCounters.FILE_BYTES_WRITTEN:96224642,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1673882,Map-Reduce Framework.Physical memory (bytes) snapshot:1433980928,Map-Reduce Framework.Spilled Records:1889451,Map-Reduce Framework.Map output bytes:81654471,Map-Reduce Framework.CPU time spent (ms):51280,Map-Reduce Framework.Total committed heap usage (bytes):1234567168,Map-Reduce Framework.Virtual memory (bytes) snapshot:4697784320,Map-Reduce Framework.Map input bytes:9874589,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1679275,Map-Reduce Framework.SPLIT_RAW_BYTES:2008" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985959343"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985959344"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:01,354 Stage-3 map = 95%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:68354,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:21262915,FileSystemCounters.HDFS_BYTES_READ:78581055,FileSystemCounters.FILE_BYTES_WRITTEN:96224642,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1673882,Map-Reduce Framework.Physical memory (bytes) snapshot:1433980928,Map-Reduce Framework.Spilled Records:1889451,Map-Reduce Framework.Map output bytes:81654471,Map-Reduce Framework.CPU time spent (ms):51280,Map-Reduce Framework.Total committed heap usage (bytes):1234567168,Map-Reduce Framework.Virtual memory (bytes) snapshot:4697784320,Map-Reduce Framework.Map input bytes:9874589,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1679275,Map-Reduce Framework.SPLIT_RAW_BYTES:2008" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985961354"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"10","CNTR_NAME_Stage-3_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985961358"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:02,363 Stage-3 map = 100%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:53131404,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:159961640,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1443176448,Map-Reduce Framework.Spilled Records:3148471,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):57890,Map-Reduce Framework.Total committed heap usage (bytes):1232338944,Map-Reduce Framework.Virtual memory (bytes) snapshot:4697784320,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2008" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985962363"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"10","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985962364"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:04,376 Stage-3 map = 100%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:53131404,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:159961640,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1443176448,Map-Reduce Framework.Spilled Records:3148471,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):57890,Map-Reduce Framework.Total committed heap usage (bytes):1232338944,Map-Reduce Framework.Virtual memory (bytes) snapshot:4697784320,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2008" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985964376"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985964377"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:07,392 Stage-3 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:53131404,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:159961640,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1443176448,Map-Reduce Framework.Spilled Records:3148471,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):57890,Map-Reduce Framework.Total committed heap usage (bytes):1232338944,Map-Reduce Framework.Virtual memory (bytes) snapshot:4697784320,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2008" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985967392"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985967393"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:10,407 Stage-3 map = 100%,  reduce = 83%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:53131404,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:192149984,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258881,Map-Reduce Framework.Spilled Records:3148471,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):60420,Map-Reduce Framework.Total committed heap usage (bytes):1403846656,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2008,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1639317504,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5324566528,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985970408"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"83","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985970408"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:11,413 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:21774,FileSystemCounters.FILE_BYTES_READ:159390255,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:266302002,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258881,Map-Reduce Framework.Spilled Records:5247421,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):65510,Map-Reduce Framework.Total committed heap usage (bytes):1429340160,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2008,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1676943360,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5324566528,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985971414"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985971414"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985973427"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985973478"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 22:46:11,413 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:86286,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:21774,FileSystemCounters.FILE_BYTES_READ:159390255,FileSystemCounters.HDFS_BYTES_READ:98839387,FileSystemCounters.FILE_BYTES_WRITTEN:266302002,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258881,Map-Reduce Framework.Spilled Records:5247421,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):65510,Map-Reduce Framework.Total committed heap usage (bytes):1429340160,Map-Reduce Framework.Map input bytes:29632233,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2008,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1676943360,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5324566528,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0067" TIME="1337985973478"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985973478"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985973480"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:18,618 Stage-4 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:1731,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0069" TIME="1337985978618"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985978618"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 22:46:20,629 Stage-4 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4046,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:573,FileSystemCounters.FILE_BYTES_WRITTEN:81678,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:196390912,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1120,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:684638208,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:244" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0069" TIME="1337985980629"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985980630"
TaskProgress ROWS_INSERTED="rankings_uservisits_join~1" TASK_HADOOP_PROGRESS="2012-05-25 22:46:28,709 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4046,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8221,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:573,FileSystemCounters.FILE_BYTES_WRITTEN:163245,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2090,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:244,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:289898496,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1357307904,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0069" TIME="1337985988710"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985988710"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985990724"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985990775"
TaskEnd ROWS_INSERTED="rankings_uservisits_join~1" TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 22:46:28,709 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:4046,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8221,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:573,FileSystemCounters.FILE_BYTES_WRITTEN:163245,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2090,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:244,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:289898496,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1357307904,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TASK_HADOOP_ID="job_201205252023_0069" TIME="1337985990776"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985990776"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985990776"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337985990965"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985990965"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985990965"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"}" TIME="1337985990966"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"}" TIME="1337985991338"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" TIME="1337985991338"
QueryEnd ROWS_INSERTED="rankings_uservisits_join~1" QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83" QUERY_RET_CODE="0" QUERY_NUM_TASKS="4" TIME="1337985991338"
Counters plan="{"queryId":"ubuntu_20120525223131_e48762c6-a7e6-4dd7-bdce-efe8575e3e83","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"}" TIME="1337985991339"
