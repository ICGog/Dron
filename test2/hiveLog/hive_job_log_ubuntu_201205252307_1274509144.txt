SessionStart SESSION_ID="ubuntu_201205252307" TIME="1337987255826"
QueryStart QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337987269437"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987269456"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337987269459"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987269502"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:08:13,456 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987293456"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987293458"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:09:13,741 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987353742"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987353743"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:10:13,828 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987413828"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987413830"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:11:14,447 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987474448"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987474449"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:12:14,824 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987534825"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987534826"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:13:15,182 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987595183"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987595184"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:14:15,623 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987655623"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987655625"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:15:15,875 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987715875"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987715876"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:16,241 Stage-1 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_REDUCES:13124" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987776241"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987776242"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:41,368 Stage-1 map = 2%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:8233,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:18,Job Counters .Data-local map tasks:13,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:32864,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:498022,FileSystemCounters.HDFS_BYTES_READ:67113151,FileSystemCounters.FILE_BYTES_WRITTEN:1539619,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:514454,Map-Reduce Framework.Physical memory (bytes) snapshot:209264640,Map-Reduce Framework.Spilled Records:16432,Map-Reduce Framework.Map output bytes:1424833,Map-Reduce Framework.CPU time spent (ms):6330,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:680542208,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:16432,Map-Reduce Framework.SPLIT_RAW_BYTES:190" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987801370"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"2"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987801371"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:42,376 Stage-1 map = 3%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:8233,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:18,Job Counters .Data-local map tasks:13,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:32864,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:498022,FileSystemCounters.HDFS_BYTES_READ:67113151,FileSystemCounters.FILE_BYTES_WRITTEN:1539619,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:514454,Map-Reduce Framework.Physical memory (bytes) snapshot:209264640,Map-Reduce Framework.Spilled Records:16432,Map-Reduce Framework.Map output bytes:1424833,Map-Reduce Framework.CPU time spent (ms):6330,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:680542208,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:16432,Map-Reduce Framework.SPLIT_RAW_BYTES:190" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987802380"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"3"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987802381"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:43,386 Stage-1 map = 4%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:8233,Job Counters .Rack-local map tasks:5,Job Counters .Launched map tasks:18,Job Counters .Data-local map tasks:13,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:32864,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:498022,FileSystemCounters.HDFS_BYTES_READ:67113151,FileSystemCounters.FILE_BYTES_WRITTEN:1539619,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:514454,Map-Reduce Framework.Physical memory (bytes) snapshot:209264640,Map-Reduce Framework.Spilled Records:16432,Map-Reduce Framework.Map output bytes:1424833,Map-Reduce Framework.CPU time spent (ms):6330,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:680542208,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:16432,Map-Reduce Framework.SPLIT_RAW_BYTES:190" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987803386"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"4"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987803388"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:45,397 Stage-1 map = 6%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:44451,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:20,Job Counters .Data-local map tasks:14,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:422750,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:6480384,FileSystemCounters.HDFS_BYTES_READ:872469739,FileSystemCounters.FILE_BYTES_WRITTEN:19114231,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:6691759,Map-Reduce Framework.Physical memory (bytes) snapshot:822878208,Map-Reduce Framework.Spilled Records:211375,Map-Reduce Framework.Map output bytes:18363791,Map-Reduce Framework.CPU time spent (ms):38430,Map-Reduce Framework.Total committed heap usage (bytes):706740224,Map-Reduce Framework.Virtual memory (bytes) snapshot:2738393088,Map-Reduce Framework.Map input bytes:603979776,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:211375,Map-Reduce Framework.SPLIT_RAW_BYTES:1246" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987805397"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"6"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987805399"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:46,408 Stage-1 map = 9%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:63954,Job Counters .Rack-local map tasks:8,Job Counters .Launched map tasks:24,Job Counters .Data-local map tasks:16,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:585186,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:8973215,FileSystemCounters.HDFS_BYTES_READ:1208035086,FileSystemCounters.FILE_BYTES_WRITTEN:26493320,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:9265808,Map-Reduce Framework.Physical memory (bytes) snapshot:1251364864,Map-Reduce Framework.Spilled Records:292593,Map-Reduce Framework.Map output bytes:25416601,Map-Reduce Framework.CPU time spent (ms):55230,Map-Reduce Framework.Total committed heap usage (bytes):1060110336,Map-Reduce Framework.Virtual memory (bytes) snapshot:4060966912,Map-Reduce Framework.Map input bytes:805306368,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:292593,Map-Reduce Framework.SPLIT_RAW_BYTES:1788" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987806408"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"9"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987806409"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:49,429 Stage-1 map = 10%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:101161,Job Counters .Rack-local map tasks:9,Job Counters .Launched map tasks:30,Job Counters .Data-local map tasks:21,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:844352,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:12962213,FileSystemCounters.HDFS_BYTES_READ:1744939477,FileSystemCounters.FILE_BYTES_WRITTEN:38177841,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:13384389,Map-Reduce Framework.Physical memory (bytes) snapshot:1670455296,Map-Reduce Framework.Spilled Records:422176,Map-Reduce Framework.Map output bytes:36678111,Map-Reduce Framework.CPU time spent (ms):77660,Map-Reduce Framework.Total committed heap usage (bytes):1441267712,Map-Reduce Framework.Virtual memory (bytes) snapshot:5382242304,Map-Reduce Framework.Map input bytes:1207959552,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:422176,Map-Reduce Framework.SPLIT_RAW_BYTES:2492" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987809429"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"10"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987809430"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:52,444 Stage-1 map = 11%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:121335,Job Counters .Rack-local map tasks:10,Job Counters .Launched map tasks:34,Job Counters .Data-local map tasks:24,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:974262,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:14956145,FileSystemCounters.HDFS_BYTES_READ:2013391673,FileSystemCounters.FILE_BYTES_WRITTEN:44023428,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:15443276,Map-Reduce Framework.Physical memory (bytes) snapshot:1884962816,Map-Reduce Framework.Spilled Records:487131,Map-Reduce Framework.Map output bytes:42311866,Map-Reduce Framework.CPU time spent (ms):88440,Map-Reduce Framework.Total committed heap usage (bytes):1645740032,Map-Reduce Framework.Virtual memory (bytes) snapshot:6012596224,Map-Reduce Framework.Map input bytes:1409286144,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:487131,Map-Reduce Framework.SPLIT_RAW_BYTES:2844" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987812444"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"11"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987812446"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:53,450 Stage-1 map = 13%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:156408,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:37,Job Counters .Data-local map tasks:26,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1136968,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:17448408,FileSystemCounters.HDFS_BYTES_READ:2348957020,FileSystemCounters.FILE_BYTES_WRITTEN:51412668,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:18016892,Map-Reduce Framework.Physical memory (bytes) snapshot:2317246464,Map-Reduce Framework.Spilled Records:568484,Map-Reduce Framework.Map output bytes:49374555,Map-Reduce Framework.CPU time spent (ms):102950,Map-Reduce Framework.Total committed heap usage (bytes):2026897408,Map-Reduce Framework.Virtual memory (bytes) snapshot:7327105024,Map-Reduce Framework.Map input bytes:1610612736,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:568484,Map-Reduce Framework.SPLIT_RAW_BYTES:3386" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987813451"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-1_MAP_PROGRESS":"13"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987813452"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:54,457 Stage-1 map = 13%,  reduce = 1%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:156408,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:38,Job Counters .Data-local map tasks:27,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1136968,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:17448408,FileSystemCounters.HDFS_BYTES_READ:2348957020,FileSystemCounters.FILE_BYTES_WRITTEN:51412668,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:18016892,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:568484,Map-Reduce Framework.Map output bytes:49374555,Map-Reduce Framework.CPU time spent (ms):102950,Map-Reduce Framework.Total committed heap usage (bytes):2026897408,Map-Reduce Framework.Map input bytes:1610612736,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:3386,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2317246464,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7327105024,Map-Reduce Framework.Map output records:568484" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987814458"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"1","CNTR_NAME_Stage-1_MAP_PROGRESS":"13"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987814459"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:55,480 Stage-1 map = 14%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:156408,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:38,Job Counters .Data-local map tasks:27,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1136968,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:17448408,FileSystemCounters.HDFS_BYTES_READ:2394116479,FileSystemCounters.FILE_BYTES_WRITTEN:51657507,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:18379799,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:568484,Map-Reduce Framework.Map output bytes:50372472,Map-Reduce Framework.CPU time spent (ms):112390,Map-Reduce Framework.Total committed heap usage (bytes):2556952576,Map-Reduce Framework.Map input bytes:1610612736,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:4442,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2950488064,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9217314816,Map-Reduce Framework.Map output records:579907" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987815480"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"14"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987815482"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:56,489 Stage-1 map = 15%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:156408,Job Counters .Rack-local map tasks:11,Job Counters .Launched map tasks:38,Job Counters .Data-local map tasks:27,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1136968,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:17448408,FileSystemCounters.HDFS_BYTES_READ:2525086433,FileSystemCounters.FILE_BYTES_WRITTEN:51739122,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:19384795,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:568484,Map-Reduce Framework.Map output bytes:53124751,Map-Reduce Framework.CPU time spent (ms):119530,Map-Reduce Framework.Total committed heap usage (bytes):2731540480,Map-Reduce Framework.Map input bytes:1677721600,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:4794,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3162492928,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9904156672,Map-Reduce Framework.Map output records:611663" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987816489"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"15"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987816491"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:57,496 Stage-1 map = 16%,  reduce = 2%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:184991,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:40,Job Counters .Data-local map tasks:28,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1397342,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:21436013,FileSystemCounters.HDFS_BYTES_READ:2931020871,FileSystemCounters.FILE_BYTES_WRITTEN:63399083,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:22497591,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:698671,Map-Reduce Framework.Map output bytes:61689830,Map-Reduce Framework.CPU time spent (ms):135160,Map-Reduce Framework.Total committed heap usage (bytes):2908225536,Map-Reduce Framework.Map input bytes:2013265920,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:5146,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:3378339840,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10518470656,Map-Reduce Framework.Map output records:710094" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987817496"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"2","CNTR_NAME_Stage-1_MAP_PROGRESS":"16"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987817527"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:58,532 Stage-1 map = 17%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:184991,Job Counters .Rack-local map tasks:12,Job Counters .Launched map tasks:40,Job Counters .Data-local map tasks:28,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1397342,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:21436013,FileSystemCounters.HDFS_BYTES_READ:3095181418,FileSystemCounters.FILE_BYTES_WRITTEN:63806994,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:23765972,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:698671,Map-Reduce Framework.Map output bytes:65182450,Map-Reduce Framework.CPU time spent (ms):155240,Map-Reduce Framework.Total committed heap usage (bytes):3708026880,Map-Reduce Framework.Map input bytes:2013265920,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:6202,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:4194566144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:13850587136,Map-Reduce Framework.Map output records:750215" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987818532"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"17"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987818533"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:16:59,538 Stage-1 map = 18%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:197887,Job Counters .Rack-local map tasks:13,Job Counters .Launched map tasks:41,Job Counters .Data-local map tasks:28,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1527196,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:23429957,FileSystemCounters.HDFS_BYTES_READ:3363633614,FileSystemCounters.FILE_BYTES_WRITTEN:69650405,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:25824843,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:763598,Map-Reduce Framework.Map output bytes:70814085,Map-Reduce Framework.CPU time spent (ms):166550,Map-Reduce Framework.Total committed heap usage (bytes):3882614784,Map-Reduce Framework.Map input bytes:2214592512,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:6554,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:4414173184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:14537273344,Map-Reduce Framework.Map output records:815142" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987819538"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"18"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987819539"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:00,545 Stage-1 map = 20%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:208311,Job Counters .Rack-local map tasks:14,Job Counters .Launched map tasks:43,Job Counters .Data-local map tasks:29,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1625360,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:24924684,FileSystemCounters.HDFS_BYTES_READ:3564972795,FileSystemCounters.FILE_BYTES_WRITTEN:74105152,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:27368652,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:812680,Map-Reduce Framework.Map output bytes:75088746,Map-Reduce Framework.CPU time spent (ms):174640,Map-Reduce Framework.Total committed heap usage (bytes):4059299840,Map-Reduce Framework.Map input bytes:2348810240,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:6852,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:4624224256,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:15222177792,Map-Reduce Framework.Map output records:864224" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987820545"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"20"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987820546"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:01,613 Stage-1 map = 21%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:223047,Job Counters .Rack-local map tasks:15,Job Counters .Launched map tasks:45,Job Counters .Data-local map tasks:30,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1755608,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:26918433,FileSystemCounters.HDFS_BYTES_READ:3903290817,FileSystemCounters.FILE_BYTES_WRITTEN:80055185,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:29963689,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:877804,Map-Reduce Framework.Map output bytes:82231687,Map-Reduce Framework.CPU time spent (ms):190670,Map-Reduce Framework.Total committed heap usage (bytes):4408541184,Map-Reduce Framework.Map input bytes:2617245696,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:7556,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5037096960,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:16588713984,Map-Reduce Framework.Map output records:946376" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987821613"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"21"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987821614"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:02,619 Stage-1 map = 23%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:238689,Job Counters .Rack-local map tasks:15,Job Counters .Launched map tasks:46,Job Counters .Data-local map tasks:31,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:1885512,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:28912576,FileSystemCounters.HDFS_BYTES_READ:4171743013,FileSystemCounters.FILE_BYTES_WRITTEN:85905576,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:32022784,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:942756,Map-Reduce Framework.Map output bytes:87870251,Map-Reduce Framework.CPU time spent (ms):199760,Map-Reduce Framework.Total committed heap usage (bytes):4585226240,Map-Reduce Framework.Map input bytes:2818572288,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:7908,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5244473344,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:17273208832,Map-Reduce Framework.Map output records:1011328" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987822620"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"23"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987822621"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:03,626 Stage-1 map = 24%,  reduce = 3%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:264344,Job Counters .Rack-local map tasks:16,Job Counters .Launched map tasks:47,Job Counters .Data-local map tasks:31,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2015540,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:30906431,FileSystemCounters.HDFS_BYTES_READ:4440195209,FileSystemCounters.FILE_BYTES_WRITTEN:91756988,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:34081653,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:1007770,Map-Reduce Framework.Map output bytes:93509714,Map-Reduce Framework.CPU time spent (ms):212440,Map-Reduce Framework.Total committed heap usage (bytes):4761911296,Map-Reduce Framework.Map input bytes:3019898880,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:8260,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5458436096,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:17966833664,Map-Reduce Framework.Map output records:1076342" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987823626"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"3","CNTR_NAME_Stage-1_MAP_PROGRESS":"24"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987823627"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:04,633 Stage-1 map = 25%,  reduce = 4%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:281012,Job Counters .Rack-local map tasks:16,Job Counters .Launched map tasks:48,Job Counters .Data-local map tasks:32,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2145688,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:32900625,FileSystemCounters.HDFS_BYTES_READ:4739326798,FileSystemCounters.FILE_BYTES_WRITTEN:97790398,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:36389915,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:1072844,Map-Reduce Framework.Map output bytes:99843905,Map-Reduce Framework.CPU time spent (ms):227850,Map-Reduce Framework.Total committed heap usage (bytes):5236260864,Map-Reduce Framework.Map input bytes:3221225472,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:8964,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:5978120192,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:19898580992,Map-Reduce Framework.Map output records:1149173" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987824633"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"4","CNTR_NAME_Stage-1_MAP_PROGRESS":"25"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987824634"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:05,639 Stage-1 map = 26%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:297605,Job Counters .Rack-local map tasks:17,Job Counters .Launched map tasks:49,Job Counters .Data-local map tasks:32,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2274854,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:34894752,FileSystemCounters.HDFS_BYTES_READ:5007778994,FileSystemCounters.FILE_BYTES_WRITTEN:103611837,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:38448625,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:1137427,Map-Reduce Framework.Map output bytes:105454257,Map-Reduce Framework.CPU time spent (ms):237890,Map-Reduce Framework.Total committed heap usage (bytes):5412945920,Map-Reduce Framework.Map input bytes:3422552064,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9316,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6189260800,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:20581007360,Map-Reduce Framework.Map output records:1213756" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987825639"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"26"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987825640"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:06,650 Stage-1 map = 27%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:297605,Job Counters .Rack-local map tasks:17,Job Counters .Launched map tasks:49,Job Counters .Data-local map tasks:32,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2274854,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:34894752,FileSystemCounters.HDFS_BYTES_READ:5007778994,FileSystemCounters.FILE_BYTES_WRITTEN:103611837,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:38448625,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:1137427,Map-Reduce Framework.Map output bytes:105454257,Map-Reduce Framework.CPU time spent (ms):237890,Map-Reduce Framework.Total committed heap usage (bytes):5412945920,Map-Reduce Framework.Map input bytes:3422552064,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9316,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6189260800,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:20581007360,Map-Reduce Framework.Map output records:1213756" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987826650"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"27"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987826651"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:07,656 Stage-1 map = 28%,  reduce = 5%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:316164,Job Counters .Rack-local map tasks:17,Job Counters .Launched map tasks:51,Job Counters .Data-local map tasks:34,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2405384,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:36888553,FileSystemCounters.HDFS_BYTES_READ:5244302517,FileSystemCounters.FILE_BYTES_WRITTEN:109415323,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:40256767,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:1202692,Map-Reduce Framework.Map output bytes:110429368,Map-Reduce Framework.CPU time spent (ms):245450,Map-Reduce Framework.Total committed heap usage (bytes):5412945920,Map-Reduce Framework.Map input bytes:3623878656,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9316,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6207270912,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:20581007360,Map-Reduce Framework.Map output records:1271036" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987827657"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"5","CNTR_NAME_Stage-1_MAP_PROGRESS":"28"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987827658"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:08,663 Stage-1 map = 30%,  reduce = 6%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:332033,Job Counters .Rack-local map tasks:18,Job Counters .Launched map tasks:52,Job Counters .Data-local map tasks:34,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2405384,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:36888553,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:5311415664,FileSystemCounters.FILE_BYTES_WRITTEN:261640972,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:41366102,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:3421362,Map-Reduce Framework.Map output bytes:184282411,Map-Reduce Framework.CPU time spent (ms):257710,Map-Reduce Framework.Total committed heap usage (bytes):5589630976,Map-Reduce Framework.Map input bytes:3623878656,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:9502,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:6419316736,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:21211742208,Map-Reduce Framework.Map output records:2380371" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987828663"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"6","CNTR_NAME_Stage-1_MAP_PROGRESS":"30"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987828664"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:09,669 Stage-1 map = 32%,  reduce = 6%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:412122,Job Counters .Rack-local map tasks:20,Job Counters .Launched map tasks:56,Job Counters .Data-local map tasks:36,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2924112,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:44865315,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6378842527,FileSystemCounters.FILE_BYTES_WRITTEN:284943792,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:49546695,Map-Reduce Framework.Reduce shuffle bytes:10125381,Map-Reduce Framework.Spilled Records:3680726,Map-Reduce Framework.Map output bytes:206664553,Map-Reduce Framework.CPU time spent (ms):300090,Map-Reduce Framework.Total committed heap usage (bytes):6117588992,Map-Reduce Framework.Map input bytes:4429185024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10558,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7070175232,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:23157571584,Map-Reduce Framework.Map output records:2637948" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987829669"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"6","CNTR_NAME_Stage-1_MAP_PROGRESS":"32"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987829670"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:10,675 Stage-1 map = 34%,  reduce = 7%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:419814,Job Counters .Rack-local map tasks:21,Job Counters .Launched map tasks:57,Job Counters .Data-local map tasks:36,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:2956472,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:45364074,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6445955678,FileSystemCounters.FILE_BYTES_WRITTEN:286538205,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:50061634,Map-Reduce Framework.Reduce shuffle bytes:17922986,Map-Reduce Framework.Spilled Records:3696906,Map-Reduce Framework.Map output bytes:208063149,Map-Reduce Framework.CPU time spent (ms):306220,Map-Reduce Framework.Total committed heap usage (bytes):6415253504,Map-Reduce Framework.Map input bytes:4429185024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10748,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7391600640,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:24414089216,Map-Reduce Framework.Map output records:2654128" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987830675"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"7","CNTR_NAME_Stage-1_MAP_PROGRESS":"34"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987830676"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:11,685 Stage-1 map = 35%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:452848,Job Counters .Rack-local map tasks:22,Job Counters .Launched map tasks:59,Job Counters .Data-local map tasks:37,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3086312,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:47357942,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6692293217,FileSystemCounters.FILE_BYTES_WRITTEN:292311162,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:51945522,Map-Reduce Framework.Reduce shuffle bytes:17922986,Map-Reduce Framework.Spilled Records:3761826,Map-Reduce Framework.Map output bytes:213224030,Map-Reduce Framework.CPU time spent (ms):313000,Map-Reduce Framework.Total committed heap usage (bytes):6413221888,Map-Reduce Framework.Map input bytes:4630511616,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10748,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7392399360,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:24414089216,Map-Reduce Framework.Map output records:2713542" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987831685"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"35"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987831686"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:12,691 Stage-1 map = 36%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:452848,Job Counters .Rack-local map tasks:22,Job Counters .Launched map tasks:60,Job Counters .Data-local map tasks:38,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3086312,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:47357942,FileSystemCounters.FILE_BYTES_READ:76158185,FileSystemCounters.HDFS_BYTES_READ:6692293217,FileSystemCounters.FILE_BYTES_WRITTEN:292311162,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:51945522,Map-Reduce Framework.Reduce shuffle bytes:17922986,Map-Reduce Framework.Spilled Records:3761826,Map-Reduce Framework.Map output bytes:213224030,Map-Reduce Framework.CPU time spent (ms):313000,Map-Reduce Framework.Total committed heap usage (bytes):6413221888,Map-Reduce Framework.Map input bytes:4630511616,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:10748,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7392399360,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:24414089216,Map-Reduce Framework.Map output records:2713542" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987832691"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"36"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987832692"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:13,729 Stage-1 map = 37%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:489658,Job Counters .Rack-local map tasks:24,Job Counters .Launched map tasks:62,Job Counters .Data-local map tasks:38,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3216730,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:49352041,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7027858560,FileSystemCounters.FILE_BYTES_WRITTEN:450501949,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:55114359,Map-Reduce Framework.Reduce shuffle bytes:27427701,Map-Reduce Framework.Spilled Records:6046093,Map-Reduce Framework.Map output bytes:292745954,Map-Reduce Framework.CPU time spent (ms):342500,Map-Reduce Framework.Total committed heap usage (bytes):6915358720,Map-Reduce Framework.Map input bytes:4831838208,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:11286,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:7933050880,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:26430099456,Map-Reduce Framework.Map output records:3888280" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987833729"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"37"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987833730"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:14,735 Stage-1 map = 38%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:496958,Job Counters .Rack-local map tasks:25,Job Counters .Launched map tasks:63,Job Counters .Data-local map tasks:38,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3220382,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:49408088,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7035407700,FileSystemCounters.FILE_BYTES_WRITTEN:450745351,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:55172232,Map-Reduce Framework.Reduce shuffle bytes:27427701,Map-Reduce Framework.Spilled Records:6047919,Map-Reduce Framework.Map output bytes:292903782,Map-Reduce Framework.CPU time spent (ms):346190,Map-Reduce Framework.Total committed heap usage (bytes):7092043776,Map-Reduce Framework.Map input bytes:4831838208,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:11476,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8137719808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:27068850176,Map-Reduce Framework.Map output records:3890106" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987834736"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"38"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987834737"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:15,742 Stage-1 map = 39%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:531450,Job Counters .Rack-local map tasks:25,Job Counters .Launched map tasks:64,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3349994,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:51402233,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7348977337,FileSystemCounters.FILE_BYTES_WRITTEN:456661933,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:57573820,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6112725,Map-Reduce Framework.Map output bytes:299451623,Map-Reduce Framework.CPU time spent (ms):357580,Map-Reduce Framework.Total committed heap usage (bytes):7417495552,Map-Reduce Framework.Map input bytes:5100273664,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:11828,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8478961664,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:28393148416,Map-Reduce Framework.Map output records:3965520" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987835742"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"39"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987835743"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:16,748 Stage-1 map = 40%,  reduce = 8%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:531450,Job Counters .Rack-local map tasks:25,Job Counters .Launched map tasks:64,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3349994,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:51402233,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7348977337,FileSystemCounters.FILE_BYTES_WRITTEN:456661933,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:57573820,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6112725,Map-Reduce Framework.Map output bytes:299451623,Map-Reduce Framework.CPU time spent (ms):357580,Map-Reduce Framework.Total committed heap usage (bytes):7417495552,Map-Reduce Framework.Map input bytes:5100273664,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:11828,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8478961664,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:28393148416,Map-Reduce Framework.Map output records:3965520" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987836748"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"8","CNTR_NAME_Stage-1_MAP_PROGRESS":"40"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987836749"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:17,755 Stage-1 map = 41%,  reduce = 9%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:549008,Job Counters .Rack-local map tasks:26,Job Counters .Launched map tasks:65,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3479250,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:53396668,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7617429533,FileSystemCounters.FILE_BYTES_WRITTEN:462493058,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:59632883,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6177353,Map-Reduce Framework.Map output bytes:305071570,Map-Reduce Framework.CPU time spent (ms):368990,Map-Reduce Framework.Total committed heap usage (bytes):7594180608,Map-Reduce Framework.Map input bytes:5301600256,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12180,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8693239808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29065678848,Map-Reduce Framework.Map output records:4030148" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987837755"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"9","CNTR_NAME_Stage-1_MAP_PROGRESS":"41"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987837756"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:18,792 Stage-1 map = 42%,  reduce = 9%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:549008,Job Counters .Rack-local map tasks:26,Job Counters .Launched map tasks:65,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3479250,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:53396668,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7617429533,FileSystemCounters.FILE_BYTES_WRITTEN:462493058,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:59632883,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6177353,Map-Reduce Framework.Map output bytes:305071570,Map-Reduce Framework.CPU time spent (ms):368990,Map-Reduce Framework.Total committed heap usage (bytes):7594180608,Map-Reduce Framework.Map input bytes:5301600256,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12180,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8693239808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29065678848,Map-Reduce Framework.Map output records:4030148" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987838792"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"9","CNTR_NAME_Stage-1_MAP_PROGRESS":"42"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987838793"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:19,798 Stage-1 map = 42%,  reduce = 10%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:549008,Job Counters .Rack-local map tasks:26,Job Counters .Launched map tasks:65,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3479250,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:53396668,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7768424832,FileSystemCounters.FILE_BYTES_WRITTEN:462574673,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:60794763,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6177353,Map-Reduce Framework.Map output bytes:308301636,Map-Reduce Framework.CPU time spent (ms):376610,Map-Reduce Framework.Total committed heap usage (bytes):7770865664,Map-Reduce Framework.Map input bytes:5435817984,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12532,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8891174912,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29748383744,Map-Reduce Framework.Map output records:4067347" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987839798"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"10","CNTR_NAME_Stage-1_MAP_PROGRESS":"42"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987839799"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:20,805 Stage-1 map = 44%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:549008,Job Counters .Rack-local map tasks:26,Job Counters .Launched map tasks:65,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3479250,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:53396668,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:7768424832,FileSystemCounters.FILE_BYTES_WRITTEN:462574673,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:60794763,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6177353,Map-Reduce Framework.Map output bytes:308301636,Map-Reduce Framework.CPU time spent (ms):376610,Map-Reduce Framework.Total committed heap usage (bytes):7770865664,Map-Reduce Framework.Map input bytes:5435817984,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12532,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8891174912,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29748383744,Map-Reduce Framework.Map output records:4067347" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987840805"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"44"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987840806"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:21,811 Stage-1 map = 45%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:594126,Job Counters .Rack-local map tasks:27,Job Counters .Launched map tasks:66,Job Counters .Data-local map tasks:39,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3609124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:55390736,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:8020214147,FileSystemCounters.FILE_BYTES_WRITTEN:468351577,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:62721294,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6242290,Map-Reduce Framework.Map output bytes:313588245,Map-Reduce Framework.CPU time spent (ms):383940,Map-Reduce Framework.Total committed heap usage (bytes):7770865664,Map-Reduce Framework.Map input bytes:5637144576,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12532,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:8897196032,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:29748383744,Map-Reduce Framework.Map output records:4128154" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987841812"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"45"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987841813"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:22,818 Stage-1 map = 47%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:642080,Job Counters .Rack-local map tasks:27,Job Counters .Launched map tasks:68,Job Counters .Data-local map tasks:41,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:3868852,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:59378658,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:8526439146,FileSystemCounters.FILE_BYTES_WRITTEN:479991862,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:66590086,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6372154,Map-Reduce Framework.Map output bytes:324210571,Map-Reduce Framework.CPU time spent (ms):401270,Map-Reduce Framework.Total committed heap usage (bytes):7947550720,Map-Reduce Framework.Map input bytes:6039797760,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:12884,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9119059968,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:30430130176,Map-Reduce Framework.Map output records:4250261" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987842818"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"47"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987842819"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:23,824 Stage-1 map = 49%,  reduce = 11%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:691124,Job Counters .Rack-local map tasks:28,Job Counters .Launched map tasks:71,Job Counters .Data-local map tasks:43,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4128402,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:63366943,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:9063343538,FileSystemCounters.FILE_BYTES_WRITTEN:491697151,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:70708146,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6501929,Map-Reduce Framework.Map output bytes:335492466,Map-Reduce Framework.CPU time spent (ms):423070,Map-Reduce Framework.Total committed heap usage (bytes):8328708096,Map-Reduce Framework.Map input bytes:6442450944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:13588,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9553227776,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:31739494400,Map-Reduce Framework.Map output records:4380036" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987843825"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"11","CNTR_NAME_Stage-1_MAP_PROGRESS":"49"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987843826"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:24,831 Stage-1 map = 51%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:691124,Job Counters .Rack-local map tasks:28,Job Counters .Launched map tasks:71,Job Counters .Data-local map tasks:43,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4128402,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:63366943,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:9063343538,FileSystemCounters.FILE_BYTES_WRITTEN:491697151,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:70708146,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6501929,Map-Reduce Framework.Map output bytes:335492466,Map-Reduce Framework.CPU time spent (ms):423070,Map-Reduce Framework.Total committed heap usage (bytes):8328708096,Map-Reduce Framework.Map input bytes:6442450944,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:13588,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9553227776,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:31739494400,Map-Reduce Framework.Map output records:4380036" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987844832"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"12","CNTR_NAME_Stage-1_MAP_PROGRESS":"51"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987844832"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:25,838 Stage-1 map = 53%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:789230,Job Counters .Rack-local map tasks:29,Job Counters .Launched map tasks:74,Job Counters .Data-local map tasks:45,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4519802,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:69348505,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:9650591514,FileSystemCounters.FILE_BYTES_WRITTEN:509181100,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:75208699,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6697629,Map-Reduce Framework.Map output bytes:347857473,Map-Reduce Framework.CPU time spent (ms):441880,Map-Reduce Framework.Total committed heap usage (bytes):8533180416,Map-Reduce Framework.Map input bytes:6912212992,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:13940,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9776627712,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:32375992320,Map-Reduce Framework.Map output records:4522282" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987845838"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"12","CNTR_NAME_Stage-1_MAP_PROGRESS":"53"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987845839"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:26,844 Stage-1 map = 54%,  reduce = 12%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:831054,Job Counters .Rack-local map tasks:31,Job Counters .Launched map tasks:76,Job Counters .Data-local map tasks:45,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:4779998,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:73335288,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:10077259904,FileSystemCounters.FILE_BYTES_WRITTEN:520843498,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:78480315,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6827727,Map-Reduce Framework.Map output bytes:356872974,Map-Reduce Framework.CPU time spent (ms):455520,Map-Reduce Framework.Total committed heap usage (bytes):8709865472,Map-Reduce Framework.Map input bytes:7247757312,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:14292,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:9992110080,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:33065275392,Map-Reduce Framework.Map output records:4625891" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987846845"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"12","CNTR_NAME_Stage-1_MAP_PROGRESS":"54"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987846846"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:27,857 Stage-1 map = 56%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:884161,Job Counters .Rack-local map tasks:33,Job Counters .Launched map tasks:79,Job Counters .Data-local map tasks:46,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5039638,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:77323672,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:10614164296,FileSystemCounters.FILE_BYTES_WRITTEN:532551375,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:82598519,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:6957547,Map-Reduce Framework.Map output bytes:368157367,Map-Reduce Framework.CPU time spent (ms):478730,Map-Reduce Framework.Total committed heap usage (bytes):9091022848,Map-Reduce Framework.Map input bytes:7650410496,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:14996,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:10423738368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:34331475968,Map-Reduce Framework.Map output records:4755711" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987847857"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"56"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987847869"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:28,875 Stage-1 map = 59%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:955743,Job Counters .Rack-local map tasks:35,Job Counters .Launched map tasks:82,Job Counters .Data-local map tasks:47,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5428946,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:83305843,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:11419516788,FileSystemCounters.FILE_BYTES_WRITTEN:550099535,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:88775344,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:7152201,Map-Reduce Framework.Map output bytes:385070452,Map-Reduce Framework.CPU time spent (ms):510340,Map-Reduce Framework.Total committed heap usage (bytes):9618915328,Map-Reduce Framework.Map input bytes:8254390272,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:16052,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11062956032,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:36270919680,Map-Reduce Framework.Map output records:4950365" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987848876"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"59"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987848877"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:30,887 Stage-1 map = 61%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:985073,Job Counters .Rack-local map tasks:37,Job Counters .Launched map tasks:84,Job Counters .Data-local map tasks:47,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5688630,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:87294027,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:11956421180,FileSystemCounters.FILE_BYTES_WRITTEN:561800923,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:92893370,Map-Reduce Framework.Reduce shuffle bytes:46858166,Map-Reduce Framework.Spilled Records:7282043,Map-Reduce Framework.Map output bytes:396348312,Map-Reduce Framework.CPU time spent (ms):531540,Map-Reduce Framework.Total committed heap usage (bytes):9972285440,Map-Reduce Framework.Map input bytes:8657043456,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:16756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:11482611712,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:37653266432,Map-Reduce Framework.Map output records:5080207" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987850887"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"61"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987850888"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:31,893 Stage-1 map = 62%,  reduce = 13%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1030674,Job Counters .Rack-local map tasks:39,Job Counters .Launched map tasks:86,Job Counters .Data-local map tasks:47,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:5883708,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:90284672,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:12623660538,FileSystemCounters.FILE_BYTES_WRITTEN:570801013,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:98020787,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7379582,Map-Reduce Framework.Map output bytes:410449092,Map-Reduce Framework.CPU time spent (ms):566400,Map-Reduce Framework.Total committed heap usage (bytes):10623320064,Map-Reduce Framework.Map input bytes:9126805504,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17704,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12263915520,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:40279023616,Map-Reduce Framework.Map output records:5242360" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987851894"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"13","CNTR_NAME_Stage-1_MAP_PROGRESS":"62"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987851895"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:32,902 Stage-1 map = 63%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1059686,Job Counters .Rack-local map tasks:40,Job Counters .Launched map tasks:87,Job Counters .Data-local map tasks:47,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6014196,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:92278273,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:12627551738,FileSystemCounters.FILE_BYTES_WRITTEN:576610296,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:98040399,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7444826,Map-Reduce Framework.Map output bytes:410504819,Map-Reduce Framework.CPU time spent (ms):567150,Map-Reduce Framework.Total committed heap usage (bytes):10623320064,Map-Reduce Framework.Map input bytes:9126805504,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:17704,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12264022016,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:40279023616,Map-Reduce Framework.Map output records:5242990" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987852902"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"63"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987852903"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:33,908 Stage-1 map = 64%,  reduce = 15%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1143561,Job Counters .Rack-local map tasks:43,Job Counters .Launched map tasks:90,Job Counters .Data-local map tasks:47,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6404562,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:98260685,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:13432908326,FileSystemCounters.FILE_BYTES_WRITTEN:594211116,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:104217994,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7640009,Map-Reduce Framework.Map output bytes:427469507,Map-Reduce Framework.CPU time spent (ms):599500,Map-Reduce Framework.Total committed heap usage (bytes):11151409152,Map-Reduce Framework.Map input bytes:9730785280,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:18760,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:12907048960,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42235867136,Map-Reduce Framework.Map output records:5438173" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987853908"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"15","CNTR_NAME_Stage-1_MAP_PROGRESS":"64"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987853909"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:34,914 Stage-1 map = 65%,  reduce = 16%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1156084,Job Counters .Rack-local map tasks:43,Job Counters .Launched map tasks:91,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6534618,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:100254534,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:13701360522,FileSystemCounters.FILE_BYTES_WRITTEN:600077610,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:106276871,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7705037,Map-Reduce Framework.Map output bytes:433124022,Map-Reduce Framework.CPU time spent (ms):610330,Map-Reduce Framework.Total committed heap usage (bytes):11328094208,Map-Reduce Framework.Map input bytes:9932111872,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19112,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13120638976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:42933030912,Map-Reduce Framework.Map output records:5503201" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987854914"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"16","CNTR_NAME_Stage-1_MAP_PROGRESS":"65"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987854915"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:35,925 Stage-1 map = 66%,  reduce = 17%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1182507,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:92,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6664426,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:102248358,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:13969812718,FileSystemCounters.FILE_BYTES_WRITTEN:605925479,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:108335599,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7769941,Map-Reduce Framework.Map output bytes:438760160,Map-Reduce Framework.CPU time spent (ms):620110,Map-Reduce Framework.Total committed heap usage (bytes):11504779264,Map-Reduce Framework.Map input bytes:10133438464,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13337726976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:43610980352,Map-Reduce Framework.Map output records:5568105" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987855925"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"17","CNTR_NAME_Stage-1_MAP_PROGRESS":"66"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987855926"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:36,931 Stage-1 map = 66%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1182507,Job Counters .Rack-local map tasks:44,Job Counters .Launched map tasks:92,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6664426,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:102248358,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:13969812718,FileSystemCounters.FILE_BYTES_WRITTEN:605925479,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:108335599,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7769941,Map-Reduce Framework.Map output bytes:438760160,Map-Reduce Framework.CPU time spent (ms):620110,Map-Reduce Framework.Total committed heap usage (bytes):11504779264,Map-Reduce Framework.Map input bytes:10133438464,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19464,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13337726976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:43610980352,Map-Reduce Framework.Map output records:5568105" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987856931"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"66"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987856932"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:37,938 Stage-1 map = 68%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1193681,Job Counters .Rack-local map tasks:46,Job Counters .Launched map tasks:94,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6793972,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:104241828,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:14238264914,FileSystemCounters.FILE_BYTES_WRITTEN:611766429,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:110393842,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7834714,Map-Reduce Framework.Map output bytes:444389643,Map-Reduce Framework.CPU time spent (ms):629570,Map-Reduce Framework.Total committed heap usage (bytes):11681464320,Map-Reduce Framework.Map input bytes:10334765056,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:19816,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13546549248,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:44223090688,Map-Reduce Framework.Map output records:5632878" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987857939"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"68"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987857940"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:38,945 Stage-1 map = 69%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1220560,Job Counters .Rack-local map tasks:47,Job Counters .Launched map tasks:95,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6923140,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:106236307,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:14506717110,FileSystemCounters.FILE_BYTES_WRITTEN:617598230,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:112452905,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7899298,Map-Reduce Framework.Map output bytes:450010354,Map-Reduce Framework.CPU time spent (ms):639890,Map-Reduce Framework.Total committed heap usage (bytes):11858149376,Map-Reduce Framework.Map input bytes:10536091648,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20168,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13748678656,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:44906450944,Map-Reduce Framework.Map output records:5697462" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987858945"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"18","CNTR_NAME_Stage-1_MAP_PROGRESS":"69"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987858946"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:40,956 Stage-1 map = 72%,  reduce = 19%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1232520,Job Counters .Rack-local map tasks:48,Job Counters .Launched map tasks:96,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:6987882,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:107233364,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:14640943276,FileSystemCounters.FILE_BYTES_WRITTEN:620556153,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:113482333,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7931669,Map-Reduce Framework.Map output bytes:452821612,Map-Reduce Framework.CPU time spent (ms):646810,Map-Reduce Framework.Total committed heap usage (bytes):12034834432,Map-Reduce Framework.Map input bytes:10603200512,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20412,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:13963542528,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:45541998592,Map-Reduce Framework.Map output records:5729833" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987860956"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"19","CNTR_NAME_Stage-1_MAP_PROGRESS":"72"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987860957"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:41,963 Stage-1 map = 74%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1250247,Job Counters .Rack-local map tasks:49,Job Counters .Launched map tasks:97,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7085664,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:108728565,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:14842282457,FileSystemCounters.FILE_BYTES_WRITTEN:624979407,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:115026425,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:7980560,Map-Reduce Framework.Map output bytes:457065162,Map-Reduce Framework.CPU time spent (ms):657560,Map-Reduce Framework.Total committed heap usage (bytes):12211519488,Map-Reduce Framework.Map input bytes:10737418240,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:20710,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14180241408,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:46177001472,Map-Reduce Framework.Map output records:5778724" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987861963"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"20","CNTR_NAME_Stage-1_MAP_PROGRESS":"74"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987861964"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:42,970 Stage-1 map = 75%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1304738,Job Counters .Rack-local map tasks:52,Job Counters .Launched map tasks:100,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7410654,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:113714527,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:15513413015,FileSystemCounters.FILE_BYTES_WRITTEN:639672939,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:120174882,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:8143055,Map-Reduce Framework.Map output bytes:471187937,Map-Reduce Framework.CPU time spent (ms):685990,Map-Reduce Framework.Total committed heap usage (bytes):12741574656,Map-Reduce Framework.Map input bytes:11207180288,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:21658,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:14819938304,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:48234778624,Map-Reduce Framework.Map output records:5941219" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987862971"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"21","CNTR_NAME_Stage-1_MAP_PROGRESS":"75"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987862972"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:43,977 Stage-1 map = 77%,  reduce = 21%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1318192,Job Counters .Rack-local map tasks:53,Job Counters .Launched map tasks:101,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7540664,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:115708253,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:15781865211,FileSystemCounters.FILE_BYTES_WRITTEN:645548732,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:122233613,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:8208060,Map-Reduce Framework.Map output bytes:476851798,Map-Reduce Framework.CPU time spent (ms):696960,Map-Reduce Framework.Total committed heap usage (bytes):12918259712,Map-Reduce Framework.Map input bytes:11408506880,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22010,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15034048512,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:48918630400,Map-Reduce Framework.Map output records:6006224" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987863977"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"21","CNTR_NAME_Stage-1_MAP_PROGRESS":"77"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987863978"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:45,989 Stage-1 map = 77%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1318192,Job Counters .Rack-local map tasks:53,Job Counters .Launched map tasks:101,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7540664,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:115708253,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:15781865211,FileSystemCounters.FILE_BYTES_WRITTEN:645548732,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:122233613,Map-Reduce Framework.Reduce shuffle bytes:80466042,Map-Reduce Framework.Spilled Records:8208060,Map-Reduce Framework.Map output bytes:476851798,Map-Reduce Framework.CPU time spent (ms):696960,Map-Reduce Framework.Total committed heap usage (bytes):12918259712,Map-Reduce Framework.Map input bytes:11408506880,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:22010,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15034048512,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:48918630400,Map-Reduce Framework.Map output records:6006224" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987865990"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"77"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987865991"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:46,996 Stage-1 map = 78%,  reduce = 22%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1318192,Job Counters .Rack-local map tasks:53,Job Counters .Launched map tasks:101,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7540664,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:115708253,FileSystemCounters.FILE_BYTES_READ:152318459,FileSystemCounters.HDFS_BYTES_READ:15954074400,FileSystemCounters.FILE_BYTES_WRITTEN:645875108,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:123598306,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:8208060,Map-Reduce Framework.Map output bytes:480559931,Map-Reduce Framework.CPU time spent (ms):718470,Map-Reduce Framework.Total committed heap usage (bytes):13569294336,Map-Reduce Framework.Map input bytes:11542724608,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23066,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:15784984576,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:51441786880,Map-Reduce Framework.Map output records:6048997" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987866996"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"22","CNTR_NAME_Stage-1_MAP_PROGRESS":"78"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987866997"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:48,007 Stage-1 map = 80%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1364486,Job Counters .Rack-local map tasks:54,Job Counters .Launched map tasks:102,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7540664,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:115708253,FileSystemCounters.FILE_BYTES_READ:304627477,FileSystemCounters.HDFS_BYTES_READ:16088300558,FileSystemCounters.FILE_BYTES_WRITTEN:950234582,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:125816301,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:12644050,Map-Reduce Framework.Map output bytes:628262447,Map-Reduce Framework.CPU time spent (ms):746910,Map-Reduce Framework.Total committed heap usage (bytes):13773766656,Map-Reduce Framework.Map input bytes:11609833472,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:23302,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16035020800,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:52066381824,Map-Reduce Framework.Map output records:8266992" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987868008"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"80"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987868009"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:49,014 Stage-1 map = 82%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1423843,Job Counters .Rack-local map tasks:57,Job Counters .Launched map tasks:105,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:7930216,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:121691179,FileSystemCounters.FILE_BYTES_READ:304627477,FileSystemCounters.HDFS_BYTES_READ:16893657146,FileSystemCounters.FILE_BYTES_WRITTEN:967799949,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:131994003,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:12838826,Map-Reduce Framework.Map output bytes:645192496,Map-Reduce Framework.CPU time spent (ms):781420,Map-Reduce Framework.Total committed heap usage (bytes):14301790208,Map-Reduce Framework.Map input bytes:12213813248,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:24358,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:16672374784,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:53994094592,Map-Reduce Framework.Map output records:8461768" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987869014"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"82"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987869015"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:50,022 Stage-1 map = 87%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1527962,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8254560,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:126677524,FileSystemCounters.FILE_BYTES_READ:533118284,FileSystemCounters.HDFS_BYTES_READ:17629766854,FileSystemCounters.FILE_BYTES_WRITTEN:1439033742,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:139422869,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:19654930,Map-Reduce Framework.Map output bytes:877987129,Map-Reduce Framework.CPU time spent (ms):844360,Map-Reduce Framework.Total committed heap usage (bytes):15183183872,Map-Reduce Framework.Map input bytes:12549357568,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25512,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:17752776704,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:57301741568,Map-Reduce Framework.Map output records:11918117" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987870023"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"87"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987870024"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:51,030 Stage-1 map = 89%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1568644,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8352910,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:128172540,FileSystemCounters.FILE_BYTES_READ:609277350,FileSystemCounters.HDFS_BYTES_READ:17898215086,FileSystemCounters.FILE_BYTES_WRITTEN:1595708443,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:142075453,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:21920891,Map-Reduce Framework.Map output bytes:956118118,Map-Reduce Framework.CPU time spent (ms):872720,Map-Reduce Framework.Total committed heap usage (bytes):15536553984,Map-Reduce Framework.Map input bytes:12683575296,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25996,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18184900608,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58565238784,Map-Reduce Framework.Map output records:13075685" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987871030"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"23","CNTR_NAME_Stage-1_MAP_PROGRESS":"89"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987871031"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:52,037 Stage-1 map = 89%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1568644,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8352910,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:128172540,FileSystemCounters.FILE_BYTES_READ:609277350,FileSystemCounters.HDFS_BYTES_READ:17898215086,FileSystemCounters.FILE_BYTES_WRITTEN:1595708443,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:142075453,Map-Reduce Framework.Reduce shuffle bytes:126708728,Map-Reduce Framework.Spilled Records:21920891,Map-Reduce Framework.Map output bytes:956118118,Map-Reduce Framework.CPU time spent (ms):872720,Map-Reduce Framework.Total committed heap usage (bytes):15536553984,Map-Reduce Framework.Map input bytes:12683575296,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:25996,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18184900608,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:58565238784,Map-Reduce Framework.Map output records:13075685" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987872037"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"89"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987872038"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:54,052 Stage-1 map = 90%,  reduce = 24%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1593196,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8352910,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:128172540,FileSystemCounters.FILE_BYTES_READ:685432044,FileSystemCounters.HDFS_BYTES_READ:18016053450,FileSystemCounters.FILE_BYTES_WRITTEN:1748087223,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:143580011,Map-Reduce Framework.Reduce shuffle bytes:175438865,Map-Reduce Framework.Spilled Records:24138285,Map-Reduce Framework.Map output bytes:1031048545,Map-Reduce Framework.CPU time spent (ms):891970,Map-Reduce Framework.Total committed heap usage (bytes):16008740864,Map-Reduce Framework.Map input bytes:12683575296,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:26534,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:18762416128,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:60494692352,Map-Reduce Framework.Map output records:14196836" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987874052"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"24","CNTR_NAME_Stage-1_MAP_PROGRESS":"90"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987874053"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:55,059 Stage-1 map = 91%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1593196,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8352910,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:128172540,FileSystemCounters.FILE_BYTES_READ:685432044,FileSystemCounters.HDFS_BYTES_READ:18161027982,FileSystemCounters.FILE_BYTES_WRITTEN:1748250451,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:144691885,Map-Reduce Framework.Reduce shuffle bytes:175438865,Map-Reduce Framework.Spilled Records:24138285,Map-Reduce Framework.Map output bytes:1034070753,Map-Reduce Framework.CPU time spent (ms):901160,Map-Reduce Framework.Total committed heap usage (bytes):16362110976,Map-Reduce Framework.Map input bytes:12817793024,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27238,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19180523520,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:61762244608,Map-Reduce Framework.Map output records:14231643" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987875059"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"91"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987875060"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:56,065 Stage-1 map = 92%,  reduce = 25%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1651578,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8482662,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:130167037,FileSystemCounters.FILE_BYTES_READ:826295559,FileSystemCounters.HDFS_BYTES_READ:18553626940,FileSystemCounters.FILE_BYTES_WRITTEN:2035619608,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:148802692,Map-Reduce Framework.Reduce shuffle bytes:175438865,Map-Reduce Framework.Spilled Records:28306029,Map-Reduce Framework.Map output bytes:1176326011,Map-Reduce Framework.CPU time spent (ms):940240,Map-Reduce Framework.Total committed heap usage (bytes):16743268352,Map-Reduce Framework.Map input bytes:13086228480,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27826,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19635335168,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:63006781440,Map-Reduce Framework.Map output records:16347953" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987876066"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"25","CNTR_NAME_Stage-1_MAP_PROGRESS":"92"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987876067"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:57,072 Stage-1 map = 94%,  reduce = 26%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1651578,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8482662,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:130167037,FileSystemCounters.FILE_BYTES_READ:826295559,FileSystemCounters.HDFS_BYTES_READ:18723832126,FileSystemCounters.FILE_BYTES_WRITTEN:2035619607,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:150108165,Map-Reduce Framework.Reduce shuffle bytes:175438865,Map-Reduce Framework.Spilled Records:28306029,Map-Reduce Framework.Map output bytes:1179920266,Map-Reduce Framework.CPU time spent (ms):944810,Map-Reduce Framework.Total committed heap usage (bytes):16745299968,Map-Reduce Framework.Map input bytes:13220446208,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:27826,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19631575040,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:62950510592,Map-Reduce Framework.Map output records:16389326" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987877073"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"26","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987877074"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:17:58,087 Stage-1 map = 94%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1676524,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8482662,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:130167037,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:18858058284,FileSystemCounters.FILE_BYTES_WRITTEN:2339982553,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:152326412,Map-Reduce Framework.Reduce shuffle bytes:252807816,Map-Reduce Framework.Spilled Records:32742523,Map-Reduce Framework.Map output bytes:1327624014,Map-Reduce Framework.CPU time spent (ms):971900,Map-Reduce Framework.Total committed heap usage (bytes):16976445440,Map-Reduce Framework.Map input bytes:13287555072,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28062,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:19930161152,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:63634354176,Map-Reduce Framework.Map output records:18607573" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987878087"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"94"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987878088"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:00,141 Stage-1 map = 95%,  reduce = 28%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1742083,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8872892,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136149926,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:19372618643,FileSystemCounters.FILE_BYTES_WRITTEN:2475089837,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:156266918,Map-Reduce Framework.Reduce shuffle bytes:443806249,Map-Reduce Framework.Spilled Records:32937638,Map-Reduce Framework.Map output bytes:1338424698,Map-Reduce Framework.CPU time spent (ms):997660,Map-Reduce Framework.Total committed heap usage (bytes):17379360768,Map-Reduce Framework.Map input bytes:13690208256,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28414,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20455800832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64938123264,Map-Reduce Framework.Map output records:18731833" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987880141"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"28","CNTR_NAME_Stage-1_MAP_PROGRESS":"95"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987880142"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:01,147 Stage-1 map = 96%,  reduce = 29%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1744417,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:8872892,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:136149926,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:19372618643,FileSystemCounters.FILE_BYTES_WRITTEN:2475089837,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:156266918,Map-Reduce Framework.Reduce shuffle bytes:443806249,Map-Reduce Framework.Spilled Records:32937638,Map-Reduce Framework.Map output bytes:1338424698,Map-Reduce Framework.CPU time spent (ms):997660,Map-Reduce Framework.Total committed heap usage (bytes):17379360768,Map-Reduce Framework.Map input bytes:13690208256,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28414,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20455800832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:64938123264,Map-Reduce Framework.Map output records:18731833" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987881148"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"29","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987881149"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:04,165 Stage-1 map = 96%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1817923,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9263168,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142132122,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:20142122237,FileSystemCounters.FILE_BYTES_WRITTEN:2492522851,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162126176,Map-Reduce Framework.Reduce shuffle bytes:443806249,Map-Reduce Framework.Spilled Records:33132776,Map-Reduce Framework.Map output bytes:1354519231,Map-Reduce Framework.CPU time spent (ms):1022580,Map-Reduce Framework.Total committed heap usage (bytes):17554014208,Map-Reduce Framework.Map input bytes:14294188032,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:28766,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:20697010176,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:65539014656,Map-Reduce Framework.Map output records:18916987" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987884165"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"96"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987884166"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:06,182 Stage-1 map = 97%,  reduce = 30%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1827909,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9263168,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142132122,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:20240070239,FileSystemCounters.FILE_BYTES_WRITTEN:2582904426,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162882461,Map-Reduce Framework.Reduce shuffle bytes:567970554,Map-Reduce Framework.Spilled Records:33132776,Map-Reduce Framework.Map output bytes:1356572110,Map-Reduce Framework.CPU time spent (ms):1035910,Map-Reduce Framework.Total committed heap usage (bytes):17794596864,Map-Reduce Framework.Map input bytes:14361296896,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29118,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21050654720,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66167304192,Map-Reduce Framework.Map output records:18940631" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987886182"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"30","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987886183"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:07,188 Stage-1 map = 97%,  reduce = 31%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1827909,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9263168,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142132122,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:20240070239,FileSystemCounters.FILE_BYTES_WRITTEN:2582904426,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162882461,Map-Reduce Framework.Reduce shuffle bytes:567970554,Map-Reduce Framework.Spilled Records:33132776,Map-Reduce Framework.Map output bytes:1356572110,Map-Reduce Framework.CPU time spent (ms):1035910,Map-Reduce Framework.Total committed heap usage (bytes):17794596864,Map-Reduce Framework.Map input bytes:14361296896,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29118,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21050654720,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66167304192,Map-Reduce Framework.Map output records:18940631" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987887188"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"31","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987887189"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:18:14,241 Stage-1 map = 97%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1851042,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9263168,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142132122,FileSystemCounters.FILE_BYTES_READ:978610448,FileSystemCounters.HDFS_BYTES_READ:20240070239,FileSystemCounters.FILE_BYTES_WRITTEN:2770842081,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:162882461,Map-Reduce Framework.Reduce shuffle bytes:828388784,Map-Reduce Framework.Spilled Records:33132776,Map-Reduce Framework.Map output bytes:1356572110,Map-Reduce Framework.CPU time spent (ms):1044600,Map-Reduce Framework.Total committed heap usage (bytes):17914527744,Map-Reduce Framework.Map input bytes:14361296896,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29118,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:21332987904,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:66167304192,Map-Reduce Framework.Map output records:18940631" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987894241"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"97"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987894242"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:01,519 Stage-1 map = 98%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:1910503,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9263168,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:142132122,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:20642068705,FileSystemCounters.FILE_BYTES_WRITTEN:3876565307,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:167749402,Map-Reduce Framework.Reduce shuffle bytes:1511532161,Map-Reduce Framework.Spilled Records:40836879,Map-Reduce Framework.Map output bytes:1582345483,Map-Reduce Framework.CPU time spent (ms):1122810,Map-Reduce Framework.Total committed heap usage (bytes):18477809664,Map-Reduce Framework.Map input bytes:14562623488,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22372356096,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22316865" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987941519"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"98"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987941520"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:04,535 Stage-1 map = 99%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2093205,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9521424,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:146121773,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:20887292132,FileSystemCounters.FILE_BYTES_WRITTEN:3888036199,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:169625972,Map-Reduce Framework.Reduce shuffle bytes:1511532161,Map-Reduce Framework.Spilled Records:40966007,Map-Reduce Framework.Map output bytes:1587459909,Map-Reduce Framework.CPU time spent (ms):1130470,Map-Reduce Framework.Total committed heap usage (bytes):18475122688,Map-Reduce Framework.Map input bytes:14763950080,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22374330368,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22375735" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987944535"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"99"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987944536"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:13,589 Stage-1 map = 100%,  reduce = 32%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2195517,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9651238,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148115767,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21052979430,FileSystemCounters.FILE_BYTES_WRITTEN:3893812309,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:170896586,Map-Reduce Framework.Reduce shuffle bytes:1596922659,Map-Reduce Framework.Spilled Records:41030914,Map-Reduce Framework.Map output bytes:1590945356,Map-Reduce Framework.CPU time spent (ms):1138640,Map-Reduce Framework.Total committed heap usage (bytes):18469027840,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22397288448,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22415817" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987953589"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"32","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987953590"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:14,629 Stage-1 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2195517,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9651238,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:148115767,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21052979430,FileSystemCounters.FILE_BYTES_WRITTEN:3893812309,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:170896586,Map-Reduce Framework.Reduce shuffle bytes:1596922659,Map-Reduce Framework.Spilled Records:41030914,Map-Reduce Framework.Map output bytes:1590945356,Map-Reduce Framework.CPU time spent (ms):1138640,Map-Reduce Framework.Total committed heap usage (bytes):18469027840,Map-Reduce Framework.Map input bytes:14898167808,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22397288448,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22415817" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987954629"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987954630"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:18,672 Stage-1 map = 100%,  reduce = 36%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2295605,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987958672"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"36","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987958673"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:20,684 Stage-1 map = 100%,  reduce = 39%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2295605,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987960684"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"39","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987960685"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:21,694 Stage-1 map = 100%,  reduce = 40%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2295605,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987961694"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"40","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987961695"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:23,706 Stage-1 map = 100%,  reduce = 47%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987963706"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"47","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987963707"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:24,712 Stage-1 map = 100%,  reduce = 54%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987964712"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"54","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987964713"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:25,718 Stage-1 map = 100%,  reduce = 57%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987965719"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"57","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987965719"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:26,725 Stage-1 map = 100%,  reduce = 64%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987966725"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"64","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987966726"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:27,731 Stage-1 map = 100%,  reduce = 68%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987967732"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"68","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987967732"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:30,785 Stage-1 map = 100%,  reduce = 69%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1278982530,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:3986541780,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1620931383,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1145860,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22398996480,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67545108480,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987970785"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"69","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987970786"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:32,796 Stage-1 map = 100%,  reduce = 70%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987972796"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"70","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987972797"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:33,802 Stage-1 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987973803"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"71","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987973803"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:34,810 Stage-1 map = 100%,  reduce = 72%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987974810"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"72","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987974811"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:36,821 Stage-1 map = 100%,  reduce = 73%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987976822"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"73","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987976822"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:37,829 Stage-1 map = 100%,  reduce = 74%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987977829"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"74","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987977830"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:38,835 Stage-1 map = 100%,  reduce = 75%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987978835"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"75","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987978836"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:39,841 Stage-1 map = 100%,  reduce = 77%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:13124,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1297099138,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4052747314,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1623227866,Map-Reduce Framework.Spilled Records:41095790,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1152430,Map-Reduce Framework.Total committed heap usage (bytes):18473418752,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:252204,Map-Reduce Framework.Reduce input groups:252204,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22415540224,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987979842"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"77","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987979843"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:40,850 Stage-1 map = 100%,  reduce = 79%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:187211,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1461254154,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4055066323,FileSystemCounters.HDFS_BYTES_WRITTEN:25855166,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1625546893,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1165860,Map-Reduce Framework.Total committed heap usage (bytes):18407030784,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2499505,Map-Reduce Framework.Reduce input groups:2499505,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22359629824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987980851"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"79","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987980851"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:41,857 Stage-1 map = 100%,  reduce = 81%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:187211,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1461254154,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4055066323,FileSystemCounters.HDFS_BYTES_WRITTEN:25855166,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1625546893,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1165860,Map-Reduce Framework.Total committed heap usage (bytes):18407030784,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2499505,Map-Reduce Framework.Reduce input groups:2499505,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22359629824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987981857"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"81","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987981858"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:42,863 Stage-1 map = 100%,  reduce = 84%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:187211,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1461254154,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4055066323,FileSystemCounters.HDFS_BYTES_WRITTEN:25855166,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1625546893,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1165860,Map-Reduce Framework.Total committed heap usage (bytes):18407030784,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2499505,Map-Reduce Framework.Reduce input groups:2499505,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22359629824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987982863"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"84","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987982867"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:43,872 Stage-1 map = 100%,  reduce = 86%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:187211,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1461254154,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4055066323,FileSystemCounters.HDFS_BYTES_WRITTEN:25855166,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1625546893,Map-Reduce Framework.Spilled Records:43343091,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1165860,Map-Reduce Framework.Total committed heap usage (bytes):18407030784,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:2499505,Map-Reduce Framework.Reduce input groups:2499505,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22359629824,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987983872"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"86","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987983873"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:44,878 Stage-1 map = 100%,  reduce = 87%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:365477,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1625178497,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4129084879,FileSystemCounters.HDFS_BYTES_WRITTEN:51713155,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1626708275,Map-Reduce Framework.Spilled Records:45587562,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1179770,Map-Reduce Framework.Total committed heap usage (bytes):18389598208,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:4743976,Map-Reduce Framework.Reduce input groups:4743976,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22340734976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987984879"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"87","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987984879"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:45,885 Stage-1 map = 100%,  reduce = 92%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:2,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:365477,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:1625178497,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4129084879,FileSystemCounters.HDFS_BYTES_WRITTEN:51713155,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1626708275,Map-Reduce Framework.Spilled Records:45587562,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1179770,Map-Reduce Framework.Total committed heap usage (bytes):18389598208,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:4743976,Map-Reduce Framework.Reduce input groups:4743976,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22340734976,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987985885"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"92","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987985886"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:46,891 Stage-1 map = 100%,  reduce = 95%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:906126,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2226510868,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4345159990,FileSystemCounters.HDFS_BYTES_WRITTEN:146515016,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1633600426,Map-Reduce Framework.Spilled Records:52325679,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1239220,Map-Reduce Framework.Total committed heap usage (bytes):18315739136,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:12982992,Map-Reduce Framework.Reduce input groups:12982955,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22259036160,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987986891"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"95","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987986892"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:47,897 Stage-1 map = 100%,  reduce = 96%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:7,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:1086255,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2390505499,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4418854660,FileSystemCounters.HDFS_BYTES_WRITTEN:172353161,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1635912101,Map-Reduce Framework.Spilled Records:54572366,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1256430,Map-Reduce Framework.Total committed heap usage (bytes):18326683648,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:15229679,Map-Reduce Framework.Reduce input groups:15229642,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22264582144,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987987897"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"96","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987987898"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:48,904 Stage-1 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:8,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:1270881,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2554421347,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4485256927,FileSystemCounters.HDFS_BYTES_WRITTEN:198268026,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1638194887,Map-Reduce Framework.Spilled Records:56818655,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1274570,Map-Reduce Framework.Total committed heap usage (bytes):18330681344,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:17475968,Map-Reduce Framework.Reduce input groups:17475931,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22275571712,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987988904"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"99","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987988905"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:49,910 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:1821828,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2919462822,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989272,FileSystemCounters.HDFS_BYTES_WRITTEN:258814878,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:63564646,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1307230,Map-Reduce Framework.Total committed heap usage (bytes):18338349056,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:22468856,Map-Reduce Framework.Reduce input groups:22468856,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22267613184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987989911"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987989911"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987992931"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987992983"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:19:49,910 Stage-1 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:13,Job Counters .SLOTS_MILLIS_MAPS:2301799,Job Counters .Rack-local map tasks:62,Job Counters .Launched map tasks:110,Job Counters .Data-local map tasks:48,Job Counters .SLOTS_MILLIS_REDUCES:1821828,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.PASSED:9780990,org.apache.hadoop.hive.ql.exec.FilterOperator$Counter.FILTERED:150109505,FileSystemCounters.FILE_BYTES_READ:2919462822,FileSystemCounters.HDFS_BYTES_READ:21272295657,FileSystemCounters.FILE_BYTES_WRITTEN:4566989272,FileSystemCounters.HDFS_BYTES_WRITTEN:258814878,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:172578361,Map-Reduce Framework.Reduce shuffle bytes:1640485740,Map-Reduce Framework.Spilled Records:63564646,Map-Reduce Framework.Map output bytes:1595542448,Map-Reduce Framework.CPU time spent (ms):1307230,Map-Reduce Framework.Total committed heap usage (bytes):18338349056,Map-Reduce Framework.Map input bytes:15099494400,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:29756,Map-Reduce Framework.Reduce input records:22468856,Map-Reduce Framework.Reduce input groups:22468856,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:22267613184,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:67555557376,Map-Reduce Framework.Map output records:22468856,org.apache.hadoop.hive.ql.exec.JoinOperator$SkewkeyTableCounter.SKEWJOINFOLLOWUPJOBS:0" TASK_ID="Stage-1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0090" TIME="1337987992983"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337987992983"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987992985"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:19:56,865 Stage-2 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2305,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337987996865"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"0","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337987996866"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:04,900 Stage-2 map = 8%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2305,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Map-Reduce Framework.Spilled Records:0" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988004900"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"8","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988004901"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:07,915 Stage-2 map = 33%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:12971,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:23748409,FileSystemCounters.HDFS_BYTES_READ:25915298,FileSystemCounters.FILE_BYTES_WRITTEN:47503384,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:487627,Map-Reduce Framework.Physical memory (bytes) snapshot:203587584,Map-Reduce Framework.Spilled Records:975254,Map-Reduce Framework.Map output bytes:22735427,Map-Reduce Framework.CPU time spent (ms):11590,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:673878016,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:487627,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988007915"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"33","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988007916"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:08,920 Stage-2 map = 75%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:24112,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:47540754,FileSystemCounters.HDFS_BYTES_READ:51882785,FileSystemCounters.FILE_BYTES_WRITTEN:95102275,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:976233,Map-Reduce Framework.Physical memory (bytes) snapshot:411217920,Map-Reduce Framework.Spilled Records:1952466,Map-Reduce Framework.Map output bytes:45516649,Map-Reduce Framework.CPU time spent (ms):24560,Map-Reduce Framework.Total committed heap usage (bytes):381157376,Map-Reduce Framework.Virtual memory (bytes) snapshot:1355894784,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:976233,Map-Reduce Framework.SPLIT_RAW_BYTES:490" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988008921"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"75","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988008921"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:11,935 Stage-2 map = 92%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:36416,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:94946507,FileSystemCounters.HDFS_BYTES_READ:103610879,FileSystemCounters.FILE_BYTES_WRITTEN:189839802,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1949560,Map-Reduce Framework.Physical memory (bytes) snapshot:622915584,Map-Reduce Framework.Spilled Records:3899120,Map-Reduce Framework.Map output bytes:90897687,Map-Reduce Framework.CPU time spent (ms):38840,Map-Reduce Framework.Total committed heap usage (bytes):555548672,Map-Reduce Framework.Virtual memory (bytes) snapshot:2036113408,Map-Reduce Framework.Map input bytes:25869383,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1949560,Map-Reduce Framework.SPLIT_RAW_BYTES:836" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988011935"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"92","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988011936"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:14,951 Stage-2 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:68598,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:189754000,FileSystemCounters.HDFS_BYTES_READ:207067365,FileSystemCounters.FILE_BYTES_WRITTEN:379315434,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:3896226,Map-Reduce Framework.Physical memory (bytes) snapshot:1047130112,Map-Reduce Framework.Spilled Records:7792452,Map-Reduce Framework.Map output bytes:181660029,Map-Reduce Framework.CPU time spent (ms):75690,Map-Reduce Framework.Total committed heap usage (bytes):908918784,Map-Reduce Framework.Virtual memory (bytes) snapshot:3333926912,Map-Reduce Framework.Map input bytes:77596491,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:3896226,Map-Reduce Framework.SPLIT_RAW_BYTES:1528" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988014951"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"0"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988014952"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:15,957 Stage-2 map = 100%,  reduce = 6%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:68598,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:189754000,FileSystemCounters.HDFS_BYTES_READ:207067365,FileSystemCounters.FILE_BYTES_WRITTEN:379315434,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:3896226,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:7792452,Map-Reduce Framework.Map output bytes:181660029,Map-Reduce Framework.CPU time spent (ms):75690,Map-Reduce Framework.Total committed heap usage (bytes):908918784,Map-Reduce Framework.Map input bytes:77596491,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1528,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1047130112,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:3333926912,Map-Reduce Framework.Map output records:3896226" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988015957"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"6"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988015960"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:16,965 Stage-2 map = 100%,  reduce = 18%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:474095379,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):95690,Map-Reduce Framework.Total committed heap usage (bytes):1083375616,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1261404160,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4023570432,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988016966"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"18"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988016966"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:17,973 Stage-2 map = 100%,  reduce = 20%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:474095379,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):95690,Map-Reduce Framework.Total committed heap usage (bytes):1083375616,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1261404160,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4023570432,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988017973"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"20"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988017974"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:18,979 Stage-2 map = 100%,  reduce = 23%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:474095379,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):95690,Map-Reduce Framework.Total committed heap usage (bytes):1083375616,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1261404160,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4023570432,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988018979"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"23"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988018980"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:19,985 Stage-2 map = 100%,  reduce = 35%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:474095379,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:0,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):95690,Map-Reduce Framework.Total committed heap usage (bytes):1083375616,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1261404160,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4023570432,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988019985"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"35"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988019986"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:20,991 Stage-2 map = 100%,  reduce = 40%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,FileSystemCounters.FILE_BYTES_READ:237180661,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:474176894,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:18917747,Map-Reduce Framework.Spilled Records:9739988,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):96620,Map-Reduce Framework.Total committed heap usage (bytes):1204355072,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:0,Map-Reduce Framework.Reduce input groups:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1379016704,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:4639694848,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988020991"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"40"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988020992"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:21,997 Stage-2 map = 100%,  reduce = 43%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:13253,FileSystemCounters.FILE_BYTES_READ:260846154,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:497923903,FileSystemCounters.HDFS_BYTES_WRITTEN:9877115,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:42583270,Map-Reduce Framework.Spilled Records:10226697,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):102010,Map-Reduce Framework.Total committed heap usage (bytes):1322254336,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:486709,Map-Reduce Framework.Reduce input groups:209760,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1497874432,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5261426688,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988021997"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"43"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988022001"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:23,044 Stage-2 map = 100%,  reduce = 59%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:54925,FileSystemCounters.FILE_BYTES_READ:331975048,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:569297345,FileSystemCounters.HDFS_BYTES_WRITTEN:39531925,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:113712254,Map-Reduce Framework.Spilled Records:11689508,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):121340,Map-Reduce Framework.Total committed heap usage (bytes):1682178048,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:1949520,Map-Reduce Framework.Reduce input groups:839534,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1862332416,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7254417408,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988023044"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"59"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988023045"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:24,050 Stage-2 map = 100%,  reduce = 61%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:4,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:54925,FileSystemCounters.FILE_BYTES_READ:331975048,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:569297345,FileSystemCounters.HDFS_BYTES_WRITTEN:39531925,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:113712254,Map-Reduce Framework.Spilled Records:11689508,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):121340,Map-Reduce Framework.Total committed heap usage (bytes):1682178048,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:1949520,Map-Reduce Framework.Reduce input groups:839534,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1862332416,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:7254417408,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988024051"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"61"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988024051"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:25,058 Stage-2 map = 100%,  reduce = 71%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:6,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:87971,FileSystemCounters.FILE_BYTES_READ:379237151,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:616722479,FileSystemCounters.HDFS_BYTES_WRITTEN:59292229,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:160974417,Map-Reduce Framework.Spilled Records:12661486,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):133950,Map-Reduce Framework.Total committed heap usage (bytes):1921056768,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:2921498,Map-Reduce Framework.Reduce input groups:1259177,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2094968832,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:8616153088,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988025061"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"71"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988025062"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:26,068 Stage-2 map = 100%,  reduce = 99%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:9,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:140570,FileSystemCounters.FILE_BYTES_READ:450248212,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:687896571,FileSystemCounters.HDFS_BYTES_WRITTEN:88932637,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:213067821,Map-Reduce Framework.Spilled Records:14121871,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):153020,Map-Reduce Framework.Total committed heap usage (bytes):2160001024,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:4381883,Map-Reduce Framework.Reduce input groups:1888644,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2325495808,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:9976692736,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988026068"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"99"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988026069"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:27,075 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:158581,FileSystemCounters.FILE_BYTES_READ:473982103,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:711711977,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:236801742,Map-Reduce Framework.Spilled Records:14609982,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):160340,Map-Reduce Framework.Total committed heap usage (bytes):2280980480,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:4869994,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2453450752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10597822464,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988027075"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988027076"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988029088"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988029140"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:20:27,075 Stage-2 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:10,Job Counters .Launched reduce tasks:10,Job Counters .SLOTS_MILLIS_MAPS:87746,Job Counters .Rack-local map tasks:2,Job Counters .Launched map tasks:6,Job Counters .Data-local map tasks:4,Job Counters .SLOTS_MILLIS_REDUCES:158581,FileSystemCounters.FILE_BYTES_READ:473982103,FileSystemCounters.HDFS_BYTES_READ:258818632,FileSystemCounters.FILE_BYTES_WRITTEN:711711977,FileSystemCounters.HDFS_BYTES_WRITTEN:98835499,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:4869994,Map-Reduce Framework.Reduce shuffle bytes:236801742,Map-Reduce Framework.Spilled Records:14609982,Map-Reduce Framework.Map output bytes:227061394,Map-Reduce Framework.CPU time spent (ms):160340,Map-Reduce Framework.Total committed heap usage (bytes):2280980480,Map-Reduce Framework.Map input bytes:103434636,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:1874,Map-Reduce Framework.Reduce input records:4869994,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:2453450752,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:10597822464,Map-Reduce Framework.Map output records:4869994" TASK_ID="Stage-2" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0097" TIME="1337988029141"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988029141"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988029143"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:34,634 Stage-3 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2489,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988034635"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988034635"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:40,667 Stage-3 map = 14%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:7650,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.HDFS_BYTES_READ:9893452,FileSystemCounters.FILE_BYTES_WRITTEN:10717691,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:210094,Map-Reduce Framework.Physical memory (bytes) snapshot:200359936,Map-Reduce Framework.Spilled Records:210094,Map-Reduce Framework.Map output bytes:10215871,Map-Reduce Framework.CPU time spent (ms):5200,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:675880960,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:210094,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988040667"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"14"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988040668"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:41,674 Stage-3 map = 43%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:21862,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:21245830,FileSystemCounters.HDFS_BYTES_READ:39530746,FileSystemCounters.FILE_BYTES_WRITTEN:63988857,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:839474,Map-Reduce Framework.Physical memory (bytes) snapshot:609513472,Map-Reduce Framework.Spilled Records:1259149,Map-Reduce Framework.Map output bytes:40819182,Map-Reduce Framework.CPU time spent (ms):19620,Map-Reduce Framework.Total committed heap usage (bytes):530055168,Map-Reduce Framework.Virtual memory (bytes) snapshot:1974558720,Map-Reduce Framework.Map input bytes:9877115,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:839474,Map-Reduce Framework.SPLIT_RAW_BYTES:836" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988041674"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"43"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988041676"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:42,683 Stage-3 map = 86%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:36690,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:21245830,FileSystemCounters.HDFS_BYTES_READ:59302659,FileSystemCounters.FILE_BYTES_WRITTEN:85408152,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1259353,Map-Reduce Framework.Physical memory (bytes) snapshot:998309888,Map-Reduce Framework.Spilled Records:1679028,Map-Reduce Framework.Map output bytes:61235455,Map-Reduce Framework.CPU time spent (ms):35900,Map-Reduce Framework.Total committed heap usage (bytes):883425280,Map-Reduce Framework.Virtual memory (bytes) snapshot:3323551744,Map-Reduce Framework.Map input bytes:9877115,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1259353,Map-Reduce Framework.SPLIT_RAW_BYTES:1326" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988042683"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"86"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988042684"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:43,688 Stage-3 map = 93%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:45339,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:42510097,FileSystemCounters.HDFS_BYTES_READ:79082112,FileSystemCounters.FILE_BYTES_WRITTEN:128018306,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1679387,Map-Reduce Framework.Physical memory (bytes) snapshot:1207300096,Map-Reduce Framework.Spilled Records:2519096,Map-Reduce Framework.Map output bytes:81659642,Map-Reduce Framework.CPU time spent (ms):45410,Map-Reduce Framework.Total committed heap usage (bytes):1057882112,Map-Reduce Framework.Virtual memory (bytes) snapshot:3988115456,Map-Reduce Framework.Map input bytes:19752984,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1679387,Map-Reduce Framework.SPLIT_RAW_BYTES:1672" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988043689"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"93"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988043689"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:44,694 Stage-3 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:54623,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:63750532,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:170580796,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1417121792,Map-Reduce Framework.Spilled Records:3358222,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):55430,Map-Reduce Framework.Total committed heap usage (bytes):1234567168,Map-Reduce Framework.Virtual memory (bytes) snapshot:4665679872,Map-Reduce Framework.Map input bytes:29628285,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988044695"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988044695"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:47,710 Stage-3 map = 100%,  reduce = 33%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:54623,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:63750532,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:170580796,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1417121792,Map-Reduce Framework.Spilled Records:3358222,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):55430,Map-Reduce Framework.Total committed heap usage (bytes):1234567168,Map-Reduce Framework.Virtual memory (bytes) snapshot:4665679872,Map-Reduce Framework.Map input bytes:29628285,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988047711"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"33","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988047711"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:50,738 Stage-3 map = 100%,  reduce = 74%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:54623,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,FileSystemCounters.FILE_BYTES_READ:63750532,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:170580796,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Physical memory (bytes) snapshot:1417121792,Map-Reduce Framework.Spilled Records:3358222,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):55430,Map-Reduce Framework.Total committed heap usage (bytes):1234567168,Map-Reduce Framework.Virtual memory (bytes) snapshot:4665679872,Map-Reduce Framework.Map input bytes:29628285,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:2098950,Map-Reduce Framework.SPLIT_RAW_BYTES:2018" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988050738"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"74","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988050739"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:52,748 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:54623,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:12647,FileSystemCounters.FILE_BYTES_READ:170009383,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:276921162,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258881,Map-Reduce Framework.Spilled Records:5457172,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):63140,Map-Reduce Framework.Total committed heap usage (bytes):1441857536,Map-Reduce Framework.Map input bytes:29628285,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2018,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1625538560,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5337853952,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988052748"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988052749"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988054766"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988054815"
TaskEnd TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:20:52,748 Stage-3 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:54623,Job Counters .Rack-local map tasks:6,Job Counters .Launched map tasks:7,Job Counters .Data-local map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:12647,FileSystemCounters.FILE_BYTES_READ:170009383,FileSystemCounters.HDFS_BYTES_READ:98839397,FileSystemCounters.FILE_BYTES_WRITTEN:276921162,FileSystemCounters.HDFS_BYTES_WRITTEN:141,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:2098950,Map-Reduce Framework.Reduce shuffle bytes:106258881,Map-Reduce Framework.Spilled Records:5457172,Map-Reduce Framework.Map output bytes:102060939,Map-Reduce Framework.CPU time spent (ms):63140,Map-Reduce Framework.Total committed heap usage (bytes):1441857536,Map-Reduce Framework.Map input bytes:29628285,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:2018,Map-Reduce Framework.Reduce input records:2098950,Map-Reduce Framework.Reduce input groups:2098950,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:1625538560,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:5337853952,Map-Reduce Framework.Map output records:2098950" TASK_ID="Stage-3" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0098" TIME="1337988054815"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988054815"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988054817"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:20:59,684 Stage-4 map = 0%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .SLOTS_MILLIS_MAPS:2277,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0099" TIME="1337988059684"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"0"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988059685"
TaskProgress TASK_HADOOP_PROGRESS="2012-05-25 23:21:03,704 Stage-4 map = 100%,  reduce = 0%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:0,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5518,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:81681,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Physical memory (bytes) snapshot:189898752,Map-Reduce Framework.Spilled Records:1,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):1200,Map-Reduce Framework.Total committed heap usage (bytes):176685056,Map-Reduce Framework.Virtual memory (bytes) snapshot:608956416,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.Map output records:1,Map-Reduce Framework.SPLIT_RAW_BYTES:245" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0099" TIME="1337988063704"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"0","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"false","started":"false"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988063705"
TaskProgress ROWS_INSERTED="rankings_uservisits_join~1" TASK_HADOOP_PROGRESS="2012-05-25 23:21:11,747 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5518,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8834,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163251,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2390,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:287518720,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1304969216,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0099" TIME="1337988071747"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988071748"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988074772"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988074824"
TaskEnd ROWS_INSERTED="rankings_uservisits_join~1" TASK_RET_CODE="0" TASK_HADOOP_PROGRESS="2012-05-25 23:21:11,747 Stage-4 map = 100%,  reduce = 100%" TASK_NAME="org.apache.hadoop.hive.ql.exec.MapRedTask" TASK_COUNTERS="org.apache.hadoop.hive.ql.exec.Operator$ProgressCounter.CREATED_FILES:1,Job Counters .Launched reduce tasks:1,Job Counters .SLOTS_MILLIS_MAPS:5518,Job Counters .Rack-local map tasks:1,Job Counters .Launched map tasks:1,Job Counters .SLOTS_MILLIS_REDUCES:8834,FileSystemCounters.FILE_BYTES_READ:55,FileSystemCounters.HDFS_BYTES_READ:574,FileSystemCounters.FILE_BYTES_WRITTEN:163251,FileSystemCounters.HDFS_BYTES_WRITTEN:49,org.apache.hadoop.hive.ql.exec.FileSinkOperator$TableIdEnum.TABLE_ID_1_ROWCOUNT:1,org.apache.hadoop.hive.ql.exec.MapOperator$Counter.DESERIALIZE_ERRORS:0,Map-Reduce Framework.Map input records:1,Map-Reduce Framework.Reduce shuffle bytes:55,Map-Reduce Framework.Spilled Records:2,Map-Reduce Framework.Map output bytes:47,Map-Reduce Framework.CPU time spent (ms):2390,Map-Reduce Framework.Total committed heap usage (bytes):297664512,Map-Reduce Framework.Map input bytes:0,Map-Reduce Framework.Combine input records:0,Map-Reduce Framework.SPLIT_RAW_BYTES:245,Map-Reduce Framework.Reduce input records:1,Map-Reduce Framework.Reduce input groups:1,Map-Reduce Framework.Combine output records:0,Map-Reduce Framework.Physical memory (bytes) snapshot:287518720,Map-Reduce Framework.Reduce output records:0,Map-Reduce Framework.Virtual memory (bytes) snapshot:1304969216,Map-Reduce Framework.Map output records:1" TASK_ID="Stage-4" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TASK_HADOOP_ID="job_201205252023_0099" TIME="1337988074824"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988074824"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988074828"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"false"}],"done":"false","started":"false"}],"done":"false","started":"true"}" TIME="1337988075072"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.MoveTask" TASK_ID="Stage-0" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988075072"
TaskStart TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988075072"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"false","started":"true"}],"done":"false","started":"true"}],"done":"false","started":"true"}" TIME="1337988075073"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"false","started":"true"}" TIME="1337988075493"
TaskEnd TASK_RET_CODE="0" TASK_NAME="org.apache.hadoop.hive.ql.exec.StatsTask" TASK_ID="Stage-5" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" TIME="1337988075493"
QueryEnd ROWS_INSERTED="rankings_uservisits_join~1" QUERY_STRING=" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1" QUERY_ID="ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0" QUERY_RET_CODE="0" QUERY_NUM_TASKS="4" TIME="1337988075493"
Counters plan="{"queryId":"ubuntu_20120525230707_4b7a7611-33c8-4457-95ba-fd4651c6efa0","queryType":null,"queryAttributes":{"queryString":" INSERT OVERWRITE TABLE rankings_uservisits_join SELECT sourceIP, avg(pageRank), sum(adRevenue) as totalRevenue FROM rankings R JOIN (SELECT sourceIP, destURL, adRevenue FROM uservisits UV WHERE UV.visitDate > '1999-01-01' AND UV.visitDate < '2000-01-01') NUV ON (R.pageURL = NUV.destURL) GROUP BY sourceIP ORDER BY totalRevenue DESC LIMIT 1"},"queryCounters":"null","stageGraph":{"nodeType":"STAGE","roots":"null","adjacencyList":[{"node":"Stage-1","children":["Stage-2"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-2","children":["Stage-3"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-3","children":["Stage-4"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-4","children":["Stage-0"],"adjacencyType":"CONJUNCTIVE"},{"node":"Stage-0","children":["Stage-5"],"adjacencyType":"CONJUNCTIVE"}]},"stageList":[{"stageId":"Stage-1","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-1_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-1_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-1_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_3","children":["RS_4"],"adjacencyType":"CONJUNCTIVE"},{"node":"TS_0","children":["FIL_19"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_19","children":["FIL_1"],"adjacencyType":"CONJUNCTIVE"},{"node":"FIL_1","children":["SEL_2"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_2","children":["RS_5"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_3","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"TS_0","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_4","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_19","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FIL_1","operatorType":"FILTER","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"SEL_2","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"RS_5","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-1_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"JOIN_6","children":["SEL_7"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_7","children":["GBY_8"],"adjacencyType":"CONJUNCTIVE"},{"node":"GBY_8","children":["FS_20"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"JOIN_6","operatorType":"JOIN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_7","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"GBY_8","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_20","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-2","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-2_MAP_PROGRESS":"100","CNTR_NAME_Stage-2_REDUCE_PROGRESS":"100"},"taskList":[{"taskId":"Stage-2_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_21","children":["RS_9"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_21","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_9","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-2_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"GBY_10","children":["SEL_11"],"adjacencyType":"CONJUNCTIVE"},{"node":"SEL_11","children":["FS_22"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"GBY_10","operatorType":"GROUPBY","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"SEL_11","operatorType":"SELECT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_22","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-3","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-3_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-3_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-3_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_23","children":["RS_12"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_23","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_12","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-3_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_13","children":["LIM_14"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_14","children":["FS_24"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_13","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_14","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_24","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-4","stageType":"MAPRED","stageAttributes":"null","stageCounters":{"CNTR_NAME_Stage-4_REDUCE_PROGRESS":"100","CNTR_NAME_Stage-4_MAP_PROGRESS":"100"},"taskList":[{"taskId":"Stage-4_MAP","taskType":"MAP","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"TS_25","children":["RS_15"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"TS_25","operatorType":"TABLESCAN","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"RS_15","operatorType":"REDUCESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"},{"taskId":"Stage-4_REDUCE","taskType":"REDUCE","taskAttributes":"null","taskCounters":"null","operatorGraph":{"nodeType":"OPERATOR","roots":"null","adjacencyList":[{"node":"OP_16","children":["LIM_17"],"adjacencyType":"CONJUNCTIVE"},{"node":"LIM_17","children":["FS_18"],"adjacencyType":"CONJUNCTIVE"}]},"operatorList":[{"operatorId":"OP_16","operatorType":"EXTRACT","operatorAttributes":"null","operatorCounters":"}","done":"true","started":"true"},{"operatorId":"LIM_17","operatorType":"LIMIT","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"},{"operatorId":"FS_18","operatorType":"FILESINK","operatorAttributes":"null","operatorCounters":"null","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-0","stageType":"MOVE","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-0_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"},{"stageId":"Stage-5","stageType":"STATS","stageAttributes":"null","stageCounters":"}","taskList":[{"taskId":"Stage-5_OTHER","taskType":"OTHER","taskAttributes":"null","taskCounters":"null","operatorGraph":"null","operatorList":"]","done":"true","started":"true"}],"done":"true","started":"true"}],"done":"true","started":"true"}" TIME="1337988075494"
